{"flow":{"onboarding":{"$contentActions":[{"input":{"bypass":false,"$cardContent":{"document":{"id":"2e836327-3498-4459-a8fe-aea2e5df1fc1","type":"text/plain","content":"Entrada do usuário"},"editable":false,"deletable":false,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNTd662-4d1f-4081-9ea2-d951ebf7b5ab","stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","conditions":[{"source":"input","comparison":"startsWith","values":["#debug","#goto"]}],"$invalid":false},{"stateId":"e2a65f54-49fa-472c-954c-6b554f0c4504","typeOfStateId":"state","$connId":"con_3","$id":"215452ad-7ff3-4ed0-a28e-276d77660924","conditions":[{"source":"context","comparison":"equals","values":["5575998122806‬","5575998122806@wa.gw.msging.net"],"variable":"tunnel.originator"}],"$invalid":false},{"stateId":"54149689-d7a5-4f04-b281-3d06976e2c8f","typeOfStateId":"state","$connId":"con_8","$id":"da705a44-1082-4717-b137-6ec3f76b4a1e","conditions":[{"source":"input","comparison":"equals","values":["#teste"]}],"$invalid":false},{"stateId":"welcome","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"10559f3c-61bc-4033-a6ed-439241ec7a63","$connId":"con_13","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"DWNTd5ab-b792-4d05-8a57-fe9d0bd1486b","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Atualiza SDK (main)","settings":{"function":"run","source":"function run(DWNT, contact_identity, tunnel_originator, random_guid) {\n    try {\n        DWNT = JSON.parse(DWNT|| \"{}\");\n\n        DWNT.journey = random_guid;\n\n        if (DWNT.contact === undefined) DWNT.contact = {};\n        if (DWNT.contact.source === undefined) DWNT.contact.source = contact__source(contact_identity);\n        if (DWNT.contact.phone === undefined) DWNT.contact.phone = contact__phone(contact_identity);\n        if (DWNT.contact.DDD === undefined) DWNT.contact.DDD = contact__DDD(contact_identity);\n        if (DWNT.contact.id === undefined) DWNT.contact.id = tunnel_originator ? tunnel_originator : contact_identity;\n        DWNT.contact.new = DWNT.contact.new === undefined;\n\n\t\tDWNT.error = null;\n        DWNT.checkpoints = [];\n\n    } catch(err) {}\n    return JSON.stringify(DWNT);\n}\n\nfunction contact__source(contactIdentity) {\n    contactIdentity = String(contactIdentity);\n    if (contactIdentity.includes(\"wa.gw.msging.net\")) {\n        return \"WHATSAPP\";\n    } else if (contactIdentity.includes(\"messenger\")) {\n        return \"FACEBOOK\";\n    } else if (contactIdentity.includes(\"instagram\")) {\n        return \"INSTAGRAM\";\n    } else if (contactIdentity.includes(\"businessmessages\")) {\n        return \"GOOGLE_BUSINESS_MESSAGE\";\n    } else if (contactIdentity.includes(\"mailgun\")) {\n        return \"E_MAIL\";\n    } else if (contactIdentity.includes(\"0mn\") || contactIdentity.includes(\"blip\")) {\n        return \"BLIP_CHAT\";\n    } else {\n        return \"OUTRO\";\n    }\n}\n\nfunction contact__phone(contactIdentity) {\n    contactIdentity = String(contactIdentity);\n    try {\n        if (!contact__source(contactIdentity) !== \"WHATSAPP\") {\n            throw new Error(\"Not a whatsapp contact\");\n        }\n        return String(contactIdentity).split(\"@\")[0];\n    } catch(err) {\n        return \"Indefinido\";\n    }  \n}\n\nfunction contact__DDD(contactIdentity) {\n    contactIdentity = String(contactIdentity);\n    try {\n        if (!contact__source(contactIdentity) !== \"WHATSAPP\") {\n            throw new Error(\"Not a whatsapp contact\");\n        }\n        return String(contactIdentity).split(\"@\")[0].substring(2, 4);\n    } catch(err) {\n        return \"Indefinido\";\n    }  \n}\n","inputVariables":["DWNT","contact.identity","tunnel.originator","random.guid"],"outputVariable":"DWNT","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false},{"$id":"DWNTc420-3536-4fc5-a06e-0082ac11b4e6","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] Define source","settings":{"variable":"source","value":"{{DWNT@contact.source}}"},"conditions":[],"$invalid":false},{"$id":"4d6439fa-4710-4451-a899-2b3a3c9da7ff","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"default"}},"conditions":[]},{"$id":"617e7939-9ced-4ffe-abc0-9e6ace2ea8ab","$typeOfContent":"","type":"MergeContact","$title":"Set contact - state","$invalid":false,"settings":{"extras":{"state":"SP"}},"conditions":[]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#1060FD","label":"Main Bot","id":"DWNT9c38-c025-4181-9bbd-966ff8ff9bb0","canChangeBackground":false}],"id":"onboarding","root":true,"$title":"Start","$position":{"top":"1629.33px","left":"1018.67px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fallback":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"c66bd48f-fb57-4f25-adac-16472c04822a","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT94d2-cff0-46cc-ae50-491089fc7b88","stateId":"DWNT2ed1-aada-425e-a805-2558a70a1dbf","typeOfStateId":"state","conditions":[{"source":"input","comparison":"startsWith","values":["#debug"]}],"$connId":"con_18","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_23","$id":"f9d7bc40-ecf5-4860-b9d1-93382d861ba6","conditions":[{"source":"context","comparison":"greaterThanOrEquals","values":["2"],"variable":"error@recurrence.state"}],"$invalid":false},{"$id":"DWNT36e7-2ee6-4a4d-a26a-36f537de8619","stateId":"regular-error","typeOfStateId":"state","conditions":[{"source":"context","comparison":"exists","variable":"error","values":[]}],"$connId":"con_28","$invalid":false},{"stateId":"error","conditions":[{"source":"input","comparison":"matches","values":[".*"]}],"$id":"444e7ebf-4663-41ab-9f5e-16ef64899d1b","$connId":"con_33","$invalid":false}],"$enteringCustomActions":[{"$id":"DWNT9690-d4f6-4cc5-a103-abb28f0cb1bb","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Cria error","settings":{"function":"run","source":"\nfunction run(DWNT, errorType, errorMessage, stateId, stateName, inputContent) {\n\tlet error = {};\n\ttry {\n\t\tDWNT = JSON.parse(DWNT || \"\");\n\t\tlet errorDescription = \"Not defined\";\n\t\tif (String(errorType).startsWith(\"SCRIPT_ERROR\")) {\n\t\t\terrorDescription = errorType.replace(\"SCRIPT_ERROR \", \"\");\n\t\t\terrorType = \"SCRIPT_ERROR\";\n\t\t}\n\t\terror[\"type\"] = errorType || \"UNEXPECTED_INPUT\";\n\t\terror[\"message\"] = errorMessage || null;\n\t\terror[\"description\"] = errorDescription;\n\t\terror[\"state\"] = {\n\t\t\t\"id\": stateId, \n\t\t\t\"name\": stateName, \n\t\t\t\"bot\": DWNT.application[\"bot\"],\n\t\t\t\"service\": DWNT.application[\"service\"]\n\t\t};\n\t\terror[\"input\"] = DWNT.input;\n\t\terror[\"return\"] = {\"state\": stateId, \"bot\": null, \"service\": DWNT.application[\"service\"]};\n\t\tconst recurrence = {\"state\": 1, \"type\": 1};\n\t\tif (DWNT.error && DWNT.error[\"state\"] && DWNT.error[\"type\"]) {\n\t\t\tif (DWNT.error[\"state\"][\"id\"] == error[\"state\"][\"id\"]) {\n\t\t\t\trecurrence[\"state\"] = DWNT.error[\"recurrence\"][\"state\"] + 1;\n\t\t\t}\n\t\t\tif (DWNT.error[\"type\"] == error[\"type\"]) {\n\t\t\t\trecurrence[\"type\"] = DWNT.error[\"recurrence\"][\"type\"] + 1;\n\t\t\t}\n\t\t}\n\t\terror[\"recurrence\"] = recurrence;\n\n\t\t// Checkpoints\n\t\tif (error[\"type\"] == \"GO_BACK\") {\n\t\t\terror[\"return\"] = get_last_checkpoint(DWNT, error);\n\t\t\tif (DWNT[\"application\"][\"bot\"] == error[\"return\"][\"bot\"]) {\n\t\t\t\terror[\"return\"][\"bot\"] = null;\n\t\t\t}\n\t\t\terror[\"message\"] = null;\n\t\t}\n\n\t\tif (inputContent.startsWith(\"#goto\")) {\n\t\t\tconst id = inputContent.replace(\"#goto \", \"\");\n\t\t\terror[\"type\"] = \"GO_TO\";\n\t\t\terror[\"message\"] = null;\n\t\t\terror[\"return\"][\"state\"] = id;\n\t\t}\n\t\t\n\t} catch(err) {\n\t\terror = {\n\t\t\t\"type\": \"UNEXPECTED_INPUT\",\n\t\t\t\"message\": null,\n\t\t\t\"return\": {\"state\": stateId, \"bot\": null},\n\t\t\t\"err\": String(err)\n\t\t};\n\t}\n\treturn JSON.stringify(error);\n}\n\n\nfunction get_last_checkpoint(DWNT, error) {\n\tlet return_info = error[\"return\"];\n\tif (Array.isArray(DWNT.checkpoints) && DWNT.checkpoints.length > 0) {\n\t\treturn_info = DWNT.checkpoints[0];\n\t}\n\treturn return_info;\n}\n","inputVariables":["DWNT","errorType","errorMessage","state.previous.id","state.previous.name","input.content"],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false},{"$id":"DWNT1209-129c-4c9e-98f6-f8a69315dc84","$typeOfContent":"","type":"TrackEvent","$title":"[DWNT] Registra Error","settings":{"extras":{"type":"{{error@type}}","bot":"{{error@state.bot}}","stateName":"{{error@state.name}}","stateId":"{{error@state.id}}","journey":"{{DWNT@journey}}"},"category":"DWNT-ERROR","action":"{{DWNT@datetime}} | {{contact.identity}} | {{error@type}} | {{error@state.bot}} | {{error@state.name}} | {{input.content}}"},"conditions":[],"$invalid":false},{"$id":"DWNT4400-3f6c-4147-97f7-af7e0d5f415b","$typeOfContent":"","type":"TrackEvent","$title":"[DWNT] Registra Script-Error","settings":{"extras":{"error":"{{error@description}}","bot":"{{error@state.bot}}","stateName":"{{error@state.name}}","stateId":"{{error@state.id}}","journey":"{{DWNT@journey}}"},"category":"DWNT-SCRIPT-ERROR","action":"{{DWNT@datetime}} | {{contact.identity}} | {{error@description}} | {{error@state.bot}} | {{error@state.name}}"},"conditions":[{"values":["SCRIPT_ERROR"],"source":"context","comparison":"equals","variable":"error@type"}],"$invalid":false},{"$id":"DWNT54dd-5acd-4825-bf2c-4eecf680f28d","$typeOfContent":"","type":"ProcessCommand","$title":"[DWNT] Deleta 'ErrorType'","settings":{"to":"postmaster@msging.net","method":"delete","uri":"/contexts/{{contact.identity}}/errorType","variable":"deleteErrorTypeCmdResp"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"errorType"}],"$invalid":false},{"$id":"DWNTfc8a-dfd0-4df0-8ce9-c6225f4054ba","$typeOfContent":"","type":"ProcessCommand","$title":"[DWNT] Deleta 'ErrorMessage'","settings":{"to":"postmaster@msging.net","method":"delete","uri":"/contexts/{{contact.identity}}/errorMessage","variable":"deleteErrorMessageCmdResp"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"errorMessage"}],"$invalid":false},{"$id":"DWNTba8a-3d8e-49b9-a997-c8e4d3a0175f","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] Seta fromError","settings":{"variable":"fromError","value":"true"},"conditions":[],"$invalid":false},{"$id":"DWNTc3a6-77e7-4681-b3a6-3e8d97c4c6f3","$typeOfContent":"","type":"ExecuteScript","$title":"<ALTERAR> [DWNT] Processa error","settings":{"function":"run","source":"/**\n * Decodifica o erro registrado em informações de:\n * - Mensagem que será mostrada\n * - Necessidade de parada do fluxo\n * - Id de retorno caso em caso de reentrada\n * \n * @param {{type: string, message: string, input: {content: string, type: string, group: string}, state: {id: string, name: string}, recurrence: {state: number, type: number}, return: {state: string, bot: string}}} error Error pré-preenchido.\n * \n * @returns {{type: string, message: string, input: {content: string, type: string, group: string}, state: {id: string, name: string}, recurrence: {state: number, type: number}, return: {state: string, bot: string}}} Erro final\n */\nfunction process_error(error) {\n\n\tif (error.message == null) {\n\t\terror[\"message\"] = get_content_message(error.input.group);\n\t}\n\n\tswitch(error.type) {\n\t\tcase \"GO_BACK\":\n\t\tcase \"GO_TO\":\n\t\t\terror[\"message\"] = null;\n\t\t\tbreak;\n\t\tcase \"INACTIVITY\":\n\t\t\terror[\"message\"] = \"Você está há alguns minutos sem enviar mensagens, então vou encerrar a conversa. Assim que puder voltar a conversar, é só me chamar 😉!\";\n\t\t\terror[\"return\"][\"state\"] = null;\n\t\t\tbreak;\n\t\tcase \"CLOSE\":\n\t\t\terror[\"message\"] = \"Obrigado por nos contatar! 😊 Se precisar de mais ajuda, não hesite em nos procurar novamente.\";\n\t\t\terror[\"return\"][\"state\"] = null;\n\t\t\tbreak;\n\t\tcase \"API\":\n\t\t\terror[\"message\"] = \"Desculpe, houve um erro no sistema. 🙁 Estamos resolvendo! Por favor, tente novamente em alguns minutos.\";\n\t\t\terror[\"return\"][\"state\"] = null;\n\t\t\tbreak;\n\t\tcase \"SCRIPT_ERROR\":\n\t\t\terror[\"message\"] = \"Desculpe, algo inesperado aconteceu. 🙁 Estamos resolvendo! Por favor, tente novamente em alguns minutos.\";\n\t\t\terror[\"return\"][\"state\"] = null;\n\t\t\tbreak;\n\t}\n\treturn error;\n}\n\nfunction get_content_message(group) {\n\tlet message;\n\tif (group == \"audio\") {\n\t\tmessage = \"Não consigo receber áudio ainda! Por favor, responda apenas com texto ou toque em uma das opções do menu.\"\n\t} else if (group == \"image\") {\n\t\tmessage = \"Não consigo receber imagens ainda! Por favor, responda apenas com texto ou toque em uma das opções do menu.\"\n\t} else if (group == \"video\") {\n\t\tmessage = \"Não consigo receber vídeo ainda! Por favor, responda apenas com texto ou toque em uma das opções do menu.\"\n\t} else if (group == \"document\") {\n\t\tmessage = \"Não consigo receber documentos ainda! Por favor, responda apenas com texto ou toque em uma das opções do menu.\"\n\t} else if (group == \"location\") {\n\t\tmessage = \"Não consigo receber localização ainda! Por favor, responda apenas com texto ou toque em uma das opções do menu.\"\n\t} else {\n\t\tmessage = \"Desculpe, não consegui compreender. Tente novamente.\"\n\t}\n\treturn message;\n}\n\nfunction run(error, stateId) {\n\ttry {\n\t\terror = JSON.parse(error || '');\n\t\terror = process_error(error);\n\t} catch(err) {\n\t\terror = {\n\t\t\t\"type\": \"UNEXPECTED_INPUT\",\n\t\t\t\"message\": \"Desculpe, não consegui compreender.\",\n\t\t\t\"return\": {\"state\": stateId, \"bot\": null},\n\t\t\t\"description\": String(err)\n\t\t};\n\t}\n\treturn JSON.stringify(error);\n}\n","inputVariables":["error","state.previous.id"],"outputVariable":"error","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false},{"$id":"DWNTc07c-b96a-498b-8b8e-a419de261dea","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Atualiza SDK (fallback)","settings":{"function":"run","source":"\nfunction run(DWNT, error) {\n\ttry {\n\t\tDWNT = JSON.parse(DWNT);\n\t\terror = JSON.parse(error);\n\t\tDWNT.error = error;\n\t\tDWNT.fromError = true;\n\t\t// checkpoint\n\t\tif (error[\"type\"] == \"GO_BACK\") {\n\t\t\tDWNT.checkpoints.shift();\n\t\t\tDWNT.hasCheckpoints = DWNT.checkpoints.length > 0 || undefined;\n\t\t}\n\t} catch(err) {\n\t\tDWNT = {err: String(err)};\n\t}\n\treturn JSON.stringify(DWNT);\n}\n\n","inputVariables":["DWNT","error"],"outputVariable":"DWNT","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"fallback","$title":"Exceptions","$position":{"top":"4400px","left":"1097px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"welcome":{"$contentActions":[{"action":{"$id":"c78f1745-800d-4fa4-9cd5-854f629ab4d0","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000000","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left","editing":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"a81a4c5b-b763-4ac6-9fbb-1c5eb772506c","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"<b>Bem-vindo ao mundo Astoria!</b> ☕✨\n\nAssim como a arte meticulosa de preparar um espresso perfeito, cada detalhe do nosso serviço é pensado para criar uma experiência inesquecível. Estamos em sintonia para proporcionar um atendimento tão envolvente quanto o aroma de um café recém-moído.\n\n<b>Sua satisfação é a nossa inspiração, e estamos harmonizando cada aspecto para que sua jornada conosco seja excepcional.</b> 🇮🇹🎶\n","metadata":{}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000001","type":"text/plain","content":"<b>Bem-vindo ao mundo Astoria!</b> ☕✨\n\nAssim como a arte meticulosa de preparar um espresso perfeito, cada detalhe do nosso serviço é pensado para criar uma experiência inesquecível. Estamos em sintonia para proporcionar um atendimento tão envolvente quanto o aroma de um café recém-moído.\n\n<b>Sua satisfação é a nossa inspiração, e estamos harmonizando cada aspecto para que sua jornada conosco seja excepcional.</b> 🇮🇹🎶\n"},"editable":true,"deletable":true,"position":"left","editing":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"b446a174-60e2-4fbb-b08c-20cd43b23d3f","type":"text/plain","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f756708b-f3a1-4af0-be4c-e0a5af3b8dd3","typeOfStateId":"state","$connId":"con_38","$id":"35ee851f-bc12-46fc-8b05-5cbee5165954","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"12a9ceb8-8db8-4cd9-b160-b008eff48e7e","$typeOfContent":"","type":"ExecuteScript","$title":"Obtem telefone","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactIdentity) {\n    var phone = String(contactIdentity).split('@')[0].substring(2);\n\n    return String(phone);\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Obtem telefone] \"+String(err);}}","inputVariables":["contact.identity"],"outputVariable":"phone","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"source":"context","comparison":"exists","values":[],"variable":"contact.identity"},{"comparison":"contains","source":"context","variable":"contact.identity","values":["@"]}],"continueOnError":true},{"$id":"DWNT-USRSCPT8-4cd9-b160-b008eff48e7e","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{phone}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"phone"}],"$invalid":false},{"$id":"88700ab6-9ceb-421c-87bf-735fbc10ec72","$typeOfContent":"","type":"MergeContact","$title":"Definir fone","$invalid":false,"settings":{"extras":{},"phoneNumber":"{{phone}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"source":"context","comparison":"exists","values":[],"variable":"phone"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"welcome","$title":"Saudação","$position":{"top":"1717px","left":"2180px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"error":{"$contentActions":[{"action":{"$id":"6b657a6e-e8aa-4336-be7f-f566c896911a","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000002","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false},{"action":{"$id":"b9a4dda6-f638-428e-bdf7-d04cf352298f","$typeOfContent":"","type":"SendMessage","settings":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"Desculpe, não consegui entender!"},"$cardContent":{"document":{"id":"00000000-0000-0000-0000-000000000003","type":"text/plain","content":"Desculpe, não consegui entender!"},"editable":true,"deletable":true,"position":"left","editing":false}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"25309776-25c1-44c3-b397-d2ea4487feef","type":"text/plain","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00"},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"error","$title":"Default error","$position":{"top":"5266px","left":"1380px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8525e3b6-273a-4b91-9a50-65288cc23284":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"78addc96-19a5-474c-ac48-82699cbe1ca8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:2251"}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:2273"}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false,"$$hashKey":"object:2253"},{"stateId":"494598cb-a5ac-4a3b-9ac8-870c9b175782","typeOfStateId":"state","$connId":"con_43","$id":"9179fcc5-796f-48ce-b05b-0b9a05e2d30e","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"responseDataVerifyJs","$$hashKey":"object:2289"},{"values":["200"],"source":"context","comparison":"equals","variable":"statusGetAccountByPhone","$$hashKey":"object:2290"}],"$invalid":false,"$$hashKey":"object:2254"},{"stateId":"f756708b-f3a1-4af0-be4c-e0a5af3b8dd3","typeOfStateId":"state","$connId":"con_48","$id":"4ecc77b4-2535-4d6b-861d-0a11692c8e03","conditions":[{"source":"context","comparison":"equals","values":["200"],"variable":"statusGetAccountByPhone","$$hashKey":"object:2316"},{"values":["false"],"source":"context","comparison":"equals","variable":"responseDataVerifyJs","$$hashKey":"object:2317"}],"$invalid":false,"$$hashKey":"object:2255"}],"$enteringCustomActions":[{"$id":"a60a31a8-36c8-4553-9cec-99cd64ffcda9","$typeOfContent":"","type":"ExecuteScript","$title":"Obtem telefone","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactIdentity) {\n    var phone = String(contactIdentity).split('@')[0].substring(4).replace(/\\D/g, '');\n\n    return String(phone);\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Obtem telefone] \"+String(err);}}","inputVariables":["contact.identity"],"outputVariable":"phone","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"source":"context","comparison":"exists","values":[],"variable":"contact.identity"},{"comparison":"contains","source":"context","variable":"contact.identity","values":["@"]}],"continueOnError":true},{"$id":"c7aee101-7fad-49fd-86c9-d4a7ad006571","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - query","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"SELECT id, name, CA_CPFCNPJ__c, CA_CodigoERP__c FROM ACCOUNT where phone = \"\n}","inputVariables":[],"outputVariable":"query","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"3a3a8b7a-3796-4571-bb55-9311804d625a","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - formatedPhone","$invalid":false,"settings":{"function":"run","source":"function run(numero) {\n    try {\n        let numeroLimpo = numero.replace(/\\D/g, '');\n\n        if (numeroLimpo.length > 10) {\n            numeroLimpo = numeroLimpo.slice(4);\n        }\n\n        return numeroLimpo;\n    } catch (error) {\n        return error.message;\n    }\n}","inputVariables":["phone"],"outputVariable":"formatedPhone","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"adf1f674-3aba-4899-bb1d-5aea37dd8357","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - get account","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Authorization":"Bearer {{getAccessToken}}"},"method":"GET","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q={{query}}'{{formatedPhone}}'","responseStatusVariable":"statusGetAccountByPhone","responseBodyVariable":"responseGetAccountByPhone"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-HTTPSTSa-4899-bb1d-5aea37dd8357","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' API","settings":{"variable":"errorType","value":"API"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["1","3","4","5"],"source":"context","comparison":"startsWith","variable":"statusContactVerify"}],"$invalid":false},{"$id":"17c1f23d-ca77-4f24-a88e-862f6322c653","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - responseDataVerifyJs","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize === 0) {\n            return false;\n        }\n        return true;\n    } catch (error) {\n        return false;\n    }\n}\n\n","inputVariables":["responseGetAccountByPhone"],"outputVariable":"responseDataVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"6103e4fa-7091-4dfd-a21a-afa5509d8888","$typeOfContent":"","type":"SetVariable","$title":"Set variable - getAccountByPhone","$invalid":false,"settings":{"value":"{{responseDataVerifyJs}}","variable":"getAccountByPhone"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false}],"id":"8525e3b6-273a-4b91-9a50-65288cc23284","root":false,"$title":"API - Get account by phoneNumber","$position":{"top":"929px","left":"985px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f756708b-f3a1-4af0-be4c-e0a5af3b8dd3":{"$contentActions":[{"action":{"$id":"38819474-993a-4433-aa30-c40cd594dc0d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ec0f73fc-ac2c-4eb3-b964-7c843a7b6d44","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ec0f73fc-ac2c-4eb3-b964-7c843a7b6d44","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f59023d2-b3a3-4104-8307-126c8e55a0cb","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ab41e1bc-f355-4e7a-b898-f92264240f6b","type":"text/plain","content":"Para começarmos, poderia me informar seu <b>Nome Completo</b>, por favor?","metadata":{}},"$cardContent":{"document":{"id":"ab41e1bc-f355-4e7a-b898-f92264240f6b","type":"text/plain","content":"Para começarmos, poderia me informar seu <b>Nome Completo</b>, por favor?"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"2fd5a153-78ac-4847-aa54-dcd5bc463160","type":"text/plain","textContent":"User input","content":"clientName"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"clientName","expiration":"1:0","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"9c1d9a1f-54e9-476c-b476-bd5e4e747a8a","typeOfStateId":"state","$connId":"con_53","$id":"14da03eb-0644-4878-aa11-3068fb223fee","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["false"],"source":"context","variable":"validateClientNameJs","comparison":"notEquals"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"29a207eb-744f-40da-8c01-3e6a5a81208f","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validateClientNameJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(userInput) {\n    try {\n        const inputProcessed = userInput\n            .replace(/\\d/g, \"\")\n            .replace(/\\s+/g, ' ')\n            .trim();\n\n        const inputSplitted = inputProcessed.split(\" \");\n\n        if (inputSplitted.length < 2 || inputSplitted[0].length < 2) {\n            return false;\n        }\n\n        return true;\n    } catch (error) {\n        return \"error\";\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validateClientNameJs] \"+String(err);}}","inputVariables":["clientName"],"outputVariable":"validateClientNameJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTf-40da-8c01-3e6a5a81208f","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validateClientNameJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validateClientNameJs"}],"$invalid":false},{"$id":"8723fa24-f001-4f5c-803c-db7cb24bae8c","$typeOfContent":"","type":"MergeContact","$title":"Set contact - nome completo","$invalid":false,"settings":{"extras":{"fullName":"{{clientName}}"},"name":"{{clientName}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"f756708b-f3a1-4af0-be4c-e0a5af3b8dd3","root":false,"$title":"Coletar nome completo","$position":{"top":"1328px","left":"1185px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"57db813e-b2e8-4445-bbdd-ef71fa7e178a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"71676ef5-123f-49d6-97e2-9d1c9acd417b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false}],"$enteringCustomActions":[{"$id":"2203d81e-4718-49bf-9c4b-62e23d294469","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - query","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q=SELECT id, name FROM ACCOUNT where phone='981346105'\";\n}","inputVariables":[],"outputVariable":"query","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f5bc08b0-ce20-42bf-b3cf-1356330e03a7","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - get phones","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Authorization":"Bearer {{getAccessToken}}"},"method":"GET","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q={{query}}","responseStatusVariable":"statusGetPhones","responseBodyVariable":"responseGetPhones"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false}],"id":"57db813e-b2e8-4445-bbdd-ef71fa7e178a","root":false,"$title":"Api - Consultar contas atreladas","$position":{"top":"1122.5px","left":"477.5px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"08a96ad7-8082-49c4-95a0-823e0a43c422":{"$contentActions":[{"action":{"$id":"9c6931c4-fd04-4061-b467-544f9e85460f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f50a2a13-9e2b-4738-aa2a-8240408b7a4b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f50a2a13-9e2b-4738-aa2a-8240408b7a4b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"e67de692-59f3-4cbb-b74e-139ec9086830","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"185f5fd9-0363-486f-a842-7dd362dd68d6","type":"application/vnd.lime.select+json","content":{"text":"\"Encontramos mais de um estabelecimento atrelado ao seu nome. Sobre qual quer falar?\"","scope":"immediate","options":[{"text":"Conta buscada","previewText":"Conta buscada","value":null,"index":0,"type":null},{"text":"Outros","previewText":"Outros","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"185f5fd9-0363-486f-a842-7dd362dd68d6","type":"application/vnd.lime.select+json","content":{"text":"\"Encontramos mais de um estabelecimento atrelado ao seu nome. Sobre qual quer falar?\"","scope":"immediate","options":[{"text":"Conta buscada","previewText":"Conta buscada","value":null,"index":0,"type":null},{"text":"Outros","previewText":"Outros","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"d7d07abd-70df-4504-8e2d-6d2f0a03961e","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_58","$contentId":"e67de692-59f3-4cbb-b74e-139ec9086830","$id":"7ad3ba3e-5c6f-48b9-beda-3693c5923f7d","conditions":[{"source":"input","comparison":"equals","values":["Outros"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Conta buscada","Outros"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"08a96ad7-8082-49c4-95a0-823e0a43c422","root":false,"$title":"Perguntar o estabelecimento","$position":{"top":"1313px","left":"2598px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"89d0d98f-ec83-4311-83e8-9213d89bb652":{"$contentActions":[{"action":{"$id":"05e45dc6-b86f-43aa-b600-332a04637bed","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"46aa2902-3f56-4dac-8908-44f2df25b35a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"46aa2902-3f56-4dac-8908-44f2df25b35a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:13075"},{"action":{"$id":"c9f0a55a-947c-429f-aaaf-ce4cfd655efd","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b8eb2cf2-3ce9-480c-8cd8-33218b25f6cb","type":"text/plain","content":"Para continuarmos, você poderia informar o <b>CPF ou CNPJ</b> associado à sua conta? 📄\n\nEssa informação é importante para garantir a segurança e a precisão no atendimento de suas solicitações.\n\nPor favor, digite seu <b>CPF ou CNPJ</b> abaixo:","metadata":{}},"$cardContent":{"document":{"id":"b8eb2cf2-3ce9-480c-8cd8-33218b25f6cb","type":"text/plain","content":"Para continuarmos, você poderia informar o <b>CPF ou CNPJ</b> associado à sua conta? 📄\n\nEssa informação é importante para garantir a segurança e a precisão no atendimento de suas solicitações.\n\nPor favor, digite seu <b>CPF ou CNPJ</b> abaixo:"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:13076"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"f9a8c828-27e4-4ef7-93ee-563e6a17670f","type":"text/plain","textContent":"User input","content":"clientCpfOrCnpj"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"clientCpfOrCnpj","expiration":"1:0","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:13077"}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:13102"}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false,"$$hashKey":"object:13084"},{"stateId":"e92dcad5-ec72-4f5d-86fc-1ce12e9eb8ec","typeOfStateId":"state","$connId":"con_63","$id":"e238665c-06cd-44dc-be9f-2a965ef7df30","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:13116"},{"values":["false"],"source":"context","comparison":"notEquals","variable":"cpfOrCnpjFormattedJs","$$hashKey":"object:13117"}],"$invalid":false,"$$hashKey":"object:13085"}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"8f605938-b3bc-48f3-aaf4-4fd04632dfab","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validCpfOrCnpjJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(clientCpfCnpj) {\n    try {\n        const cpfOrCnpj = clientCpfCnpj.replace(/[^\\d]+/g, '');\n\n        if (cpfOrCnpj.length === 11) {\n            return validarCPF(cpfOrCnpj);\n        } else if (cpfOrCnpj.length === 14) {\n            return validarCNPJ(cpfOrCnpj);\n        } else {\n            return false;\n        }\n        function validarCPF(cpf) {\n            if (cpf.length !== 11) return false;\n            if (/^(\\d)\\1+$/.test(cpf)) return false;\n\n            return \"CPF\";\n        }\n\n        function validarCNPJ(cnpj) {\n            if (cnpj.length !== 14) return false;\n            if (/^(\\d)\\1+$/.test(cnpj)) return false;\n\n            return \"CNPJ\";\n        }\n    } catch (e) {\n        return false\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validCpfOrCnpjJs] \"+String(err);}}","inputVariables":["clientCpfOrCnpj"],"outputVariable":"validCpfOrCnpjJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTc-48f3-aaf4-4fd04632dfab","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validCpfOrCnpjJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validCpfOrCnpjJs"}],"$invalid":false},{"$id":"9b326efc-0515-4a4a-a4da-2bfcb64324e3","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - cpfOrCnpjFormattedJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(clientCpfCnpj) {\n    try {\n        const sanitizedInput = clientCpfCnpj.replace(/[^\\d]+/g, '');\n\n        function isValidCPF(cpf) {\n            if (cpf.length !== 11) {\n                return false;\n            }\n            if (/^(\\d)\\1+$/.test(cpf)) {\n                return false;\n            }\n\n            return true;\n        }\n\n        function isValidCNPJ(cnpj) {\n            if (cnpj.length !== 14) {\n                return false;\n            }\n            if (/^(\\d)\\1+$/.test(cnpj)) {\n                return false;\n            }\n\n            return true;\n        }\n\n        if (sanitizedInput.length === 11) {\n            return isValidCPF(sanitizedInput) ? sanitizedInput : false;\n        } else if (sanitizedInput.length === 14) {\n            return isValidCNPJ(sanitizedInput) ? sanitizedInput : false;\n        } else {\n            return false;\n        }\n    } catch (e) {\n        return e.message;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - cpfOrCnpjFormattedJs] \"+String(err);}}","inputVariables":["clientCpfOrCnpj"],"outputVariable":"cpfOrCnpjFormattedJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT5-4a4a-a4da-2bfcb64324e3","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{cpfOrCnpjFormattedJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"cpfOrCnpjFormattedJs"}],"$invalid":false},{"$id":"a7a04973-f963-484b-bea7-280979fe8ca0","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - printCpfOrCnpjJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(clientCpfCnpj) {\n    try {\n        const cpfOrCnpj = clientCpfCnpj.replace(/[^\\d]+/g, '');\n\n        if (cpfOrCnpj.length === 11) {\n            return validarCPF(cpfOrCnpj);\n        } else if (cpfOrCnpj.length === 14) {\n            return validarCNPJ(cpfOrCnpj);\n        } else {\n            return \"CPF ou CNPJ\";\n        }\n        function validarCPF(cpf) {\n            if (cpf.length !== 11) return \"CPF ou CNPJ\";\n            if (/^(\\d)\\1+$/.test(cpf)) return \"CPF ou CNPJ\";\n\n            return \"CPF\";\n        }\n\n        function validarCNPJ(cnpj) {\n            if (cnpj.length !== 14) return \"CPF ou CNPJ\";\n            if (/^(\\d)\\1+$/.test(cnpj)) return \"CPF ou CNPJ\";\n\n            return \"CNPJ\";\n        }\n    } catch (e) {\n        return \"CPF ou CNPJ\"\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - printCpfOrCnpjJs] \"+String(err);}}","inputVariables":["clientCpfOrCnpj"],"outputVariable":"printCpfOrCnpjJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT3-484b-bea7-280979fe8ca0","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{printCpfOrCnpjJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"printCpfOrCnpjJs"}],"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"89d0d98f-ec83-4311-83e8-9213d89bb652","root":false,"$title":"Coletar CPF ou CNPJ","$position":{"top":"1514px","left":"3004px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a2a65e61-eb8c-48f9-a7cc-bad98deef6d6":{"$contentActions":[{"action":{"$id":"a4804e74-31d5-4737-b282-c2f442e1c578","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3bbe8ef1-0a27-4f08-bad5-ff6c89576a4d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3bbe8ef1-0a27-4f08-bad5-ff6c89576a4d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"2a83fda0-1ab8-499b-979d-65979499b0fd","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"609bdc7e-b7d8-45d0-888d-2c1edf2d76f3","type":"application/vnd.lime.select+json","content":{"text":"Você gostaria de falar sobre a conta {{accountName}}?","scope":"immediate","options":[{"index":-1,"text":"Sim","previewText":"Sim","type":null,"value":null},{"index":-1,"text":"Não","previewText":"Não","type":null,"value":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"609bdc7e-b7d8-45d0-888d-2c1edf2d76f3","type":"application/vnd.lime.select+json","content":{"text":"Você gostaria de falar sobre a conta {{accountName}}?","scope":"immediate","options":[{"index":-1,"text":"Sim","previewText":"Sim","type":null,"value":null},{"index":-1,"text":"Não","previewText":"Não","type":null,"value":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"ecca0b81-5de9-4483-a9b5-3dfc0c7f0030","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","typeOfStateId":"state","$connId":"con_68","$id":"a761a726-7d62-4379-ba8d-ec9b93dd0105","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_73","$id":"53db790e-31b9-4d0a-a8bf-abafd3063ac2","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d5adac2e-7277-4dd4-964f-13836919740e","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - accountName","$invalid":false,"settings":{"function":"run","source":"function run(responseGetAccountByPhone, responseGetAccountByName) {\n    try {\n        const parsedPhoneResponse = JSON.parse(responseGetAccountByPhone);\n        const parsedNameResponse = JSON.parse(responseGetAccountByName);\n\n        const nameFromPhone = parsedPhoneResponse.records && parsedPhoneResponse.records.length > 0\n            ? parsedPhoneResponse.records[0].Name : \"\";\n\n        const nameFromName = parsedNameResponse.records && parsedNameResponse.records.length > 0 ? parsedNameResponse.records[0].Name : \"\";\n\n        return nameFromPhone || nameFromName || \"Nome não encontrado\";\n    } catch (error) {\n        return error.message;\n    }\n}\n","inputVariables":["responseGetAccountByPhone","responseGetAccountByName"],"LocalTimeZoneEnabled":false,"outputVariable":"accountName"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"a2a65e61-eb8c-48f9-a7cc-bad98deef6d6","root":false,"$title":"Confirmar conta","$position":{"top":"1488px","left":"2581px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3576589e-820d-48f2-ac6a-8874940c42ed":{"$contentActions":[{"action":{"$id":"d51d6dc9-ad1b-482f-b890-954a3cb0e654","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"568dd443-a9dc-42bb-97fb-40c27be93542","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"568dd443-a9dc-42bb-97fb-40c27be93542","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"8da6b96b-5053-4ac1-a095-f5ae5096cfeb","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"1e5dc3ff-01ff-4291-bc13-7e630092726d","type":"application/vnd.lime.select+json","content":{"text":"<b>Qual o motivo do seu contato hoje?</b> ☕🔍\nNos informe brevemente para que possamos direcionar sua solicitação ao especialista certo.","scope":"immediate","options":[{"text":"Explorar serviços","previewText":"Explorar serviços","value":null,"index":0,"type":null},{"text":"Junte-se à Astoria!","previewText":"Junte-se à Astoria!","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"1e5dc3ff-01ff-4291-bc13-7e630092726d","type":"application/vnd.lime.select+json","content":{"text":"<b>Qual o motivo do seu contato hoje?</b> ☕🔍\nNos informe brevemente para que possamos direcionar sua solicitação ao especialista certo.","scope":"immediate","options":[{"text":"Explorar serviços","previewText":"Explorar serviços","value":null,"index":0,"type":null},{"text":"Junte-se à Astoria!","previewText":"Junte-se à Astoria!","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"e5fb2847-0f01-4c25-b86d-ad7b23c4cfb1","type":"text/plain","textContent":"User input","content":"inputMenuQualMotivo"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputMenuQualMotivo"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"54149689-d7a5-4f04-b281-3d06976e2c8f","typeOfStateId":"state","$connId":"con_78","$contentId":"8da6b96b-5053-4ac1-a095-f5ae5096cfeb","$id":"78f644bd-0beb-4228-aa3a-bfebaa0fa9ad","conditions":[{"source":"input","comparison":"equals","values":["Explorar serviços"]}],"$invalid":false},{"stateId":"18b94675-8e98-4b3d-930a-c0db7909364f","typeOfStateId":"state","$connId":"con_83","$contentId":"8da6b96b-5053-4ac1-a095-f5ae5096cfeb","$id":"82cfe00f-dbb0-487f-b507-c97a5ddf6df8","conditions":[{"source":"input","comparison":"equals","values":["Junte-se à Astoria!"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"982f54f6-1ee7-4d29-8906-87dacd3b52a0","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu qual o motivo do contato?","action":"{{inputMenuQualMotivo}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuQualMotivo"}]}],"$inputSuggestions":["Explorar serviços","Junte-se à Astoria!"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"3576589e-820d-48f2-ac6a-8874940c42ed","root":false,"$title":"Menu - qual o motivo do contato?","$position":{"top":"1118px","left":"2959px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e92dcad5-ec72-4f5d-86fc-1ce12e9eb8ec":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"78addc96-19a5-474c-ac48-82699cbe1ca8","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:9472"}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:9494"}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false,"$$hashKey":"object:9474"},{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","typeOfStateId":"state","$connId":"con_88","$id":"97f04a93-f292-4bcf-b22e-1c0fd00e729a","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"responseDataVerifyJs","$$hashKey":"object:9510"},{"values":["200"],"source":"context","variable":"statusGetAccountByCpfCnpj","comparison":"equals","$$hashKey":"object:9511"}],"$invalid":false,"$$hashKey":"object:9475"},{"stateId":"f45a14d5-35f1-4de8-b35a-5e3aa82703e0","typeOfStateId":"state","$connId":"con_93","$id":"e5dc1a96-e389-4ee3-a262-3949c06a56b7","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"responseDataVerifyJs","$$hashKey":"object:9537"}],"$invalid":false,"$$hashKey":"object:9476"}],"$enteringCustomActions":[{"$id":"dcac2d5f-ae0c-47a8-8a90-389d5bf47b7b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - query","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"SELECT id, name, CA_CPFCNPJ__c FROM ACCOUNT where CA_cpfcnpjlimpo__c = \"\n}","inputVariables":[],"outputVariable":"query","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"b377d1da-5e06-41fb-8324-1347f79c6f5b","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - get account","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Authorization":"Bearer {{getAccessToken}}"},"method":"GET","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q={{query}}'{{cpfOrCnpjFormattedJs}}'","responseStatusVariable":"statusGetAccountByCpfCnpj","responseBodyVariable":"responseGetAccountByCpfCnpj"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:9718"}]},{"$id":"420c10f0-9229-4a4a-a40b-a60f93dca37f","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - responseDataVerifyJs","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize === 0) {\n            return false;\n        }\n        return true;\n    } catch (error) {\n        return false;\n    }\n}\n\n","inputVariables":["responseGetAccountByCpfCnpj"],"outputVariable":"responseDataVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"928410c8-d517-4799-9005-0a108a573546","$typeOfContent":"","type":"SetVariable","$title":"Set variable - getAccountByCpfCnpj","$invalid":false,"settings":{"value":"{{responseDataVerifyJs}}","variable":"getAccountByCpfCnpj"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false}],"id":"e92dcad5-ec72-4f5d-86fc-1ce12e9eb8ec","root":false,"$title":"API - consultar cliente por CPF ou CNPJ","$position":{"top":"876px","left":"3116px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f45a14d5-35f1-4de8-b35a-5e3aa82703e0":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"5d969730-e241-495d-963f-fbf827ab0185","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","typeOfStateId":"state","$connId":"con_98","$id":"e91e3146-c58a-4c3c-b0e5-b3659d9ea55d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"f45a14d5-35f1-4de8-b35a-5e3aa82703e0","root":false,"$title":"API - atualizar cadastro de conta e contato","$position":{"top":"783px","left":"3401px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"61b6d544-ffa7-4378-a605-77135fde248e":{"$contentActions":[{"action":{"$id":"49e32298-93f6-4e05-9058-92d619cb7748","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"e7fbcd5a-5826-4a33-9cab-d2fe269704e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"e7fbcd5a-5826-4a33-9cab-d2fe269704e0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:12636"},{"action":{"$id":"280893d9-adda-44fe-aacf-0917807bb118","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"900ae62c-f890-45c8-a2bf-104532d55afa","type":"application/vnd.lime.select+json","content":{"text":"<b>Já é um cliente Astoria?</b> ☕👤\nAdoraríamos saber para personalizar sua experiência.","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"900ae62c-f890-45c8-a2bf-104532d55afa","type":"application/vnd.lime.select+json","content":{"text":"<b>Já é um cliente Astoria?</b> ☕👤\nAdoraríamos saber para personalizar sua experiência.","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:12637"},{"input":{"bypass":false,"$cardContent":{"document":{"id":"2ee28f6f-d11e-48ab-99cb-da88a5dbe2c1","type":"text/plain","textContent":"User input","content":"inputJaECliente"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputJaECliente"},"$invalid":false,"$$hashKey":"object:12638"}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:12665"}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false,"$$hashKey":"object:12645"},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_103","$contentId":"280893d9-adda-44fe-aacf-0917807bb118","$id":"17678841-296e-47d9-832e-450b6e473dab","conditions":[{"source":"input","comparison":"equals","values":["Sim"],"$$hashKey":"object:12681"}],"$invalid":false,"$$hashKey":"object:12646"},{"stateId":"35fd6df6-cbcd-4ef1-b94e-a8e342047520","typeOfStateId":"state","$connId":"con_108","$contentId":"280893d9-adda-44fe-aacf-0917807bb118","$id":"2df16a30-7f6f-4bdf-89ea-3a45e9bf0c6b","conditions":[{"source":"input","comparison":"equals","values":["Não"],"$$hashKey":"object:12695"}],"$invalid":false,"$$hashKey":"object:12647"}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"49789840-1aa2-4ca0-8049-8cd5f269259d","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu já é cliente?","action":"{{inputJaECliente}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputJaECliente"}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"61b6d544-ffa7-4378-a605-77135fde248e","root":false,"$title":"Já é cliente?","$position":{"top":"1391px","left":"3529px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"35fd6df6-cbcd-4ef1-b94e-a8e342047520":{"$contentActions":[{"action":{"$id":"9a8eb57d-a949-4d96-9180-9b444b5e5057","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"16cda0c5-0601-4ad5-a5ee-a26887699332","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"16cda0c5-0601-4ad5-a5ee-a26887699332","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"14187d42-5ae8-419c-95a0-f23bf3c55529","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f08663bb-d013-4515-8b61-9df1a52180d9","type":"text/plain","content":"Para prosseguirmos, poderia nos fornecer algumas informações?📝","metadata":{}},"$cardContent":{"document":{"id":"f08663bb-d013-4515-8b61-9df1a52180d9","type":"text/plain","content":"Para prosseguirmos, poderia nos fornecer algumas informações?📝"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"4c5a6d7c-f25f-4c39-bf4f-d49785b6e152","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1acfb087-45bf-46fc-9143-e8787acb4992","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1acfb087-45bf-46fc-9143-e8787acb4992","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"a9d41490-d7d5-4659-bcbd-6c7fbbb901ba","$typeOfContent":"text","type":"SendMessage","settings":{"id":"02c5effc-413b-4339-bdd2-769f03061ea8","type":"text/plain","content":"- <b>CEP:</b> Para entendermos melhor sua localização.\n","metadata":{}},"$cardContent":{"document":{"id":"02c5effc-413b-4339-bdd2-769f03061ea8","type":"text/plain","content":"- <b>CEP:</b> Para entendermos melhor sua localização.\n"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"191a1e5a-79cf-4988-8fa4-5f91e6b5356f","type":"text/plain","textContent":"User input","content":"clientCep"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"clientCep","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"9e80cff9-7dc5-4d80-b5bf-456c2276ad41","typeOfStateId":"state","$connId":"con_113","$id":"2a908158-1c99-464c-8b31-71e21f1f1520","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["true"],"source":"context","comparison":"equals","variable":"validateCepJs"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"30a8ed4f-8611-4069-964b-5907386fdb13","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validateCepJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(cep) {\n    try {\n      const cepRegex = /^\\d{5}-?\\d{3}$/;\n      return cepRegex.test(cep);\n    } catch (error) {\n      console.error('Erro ao validar CEP:', error);\n      return false;\n    }\n  }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validateCepJs] \"+String(err);}}","inputVariables":["clientCep"],"outputVariable":"validateCepJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT1-4069-964b-5907386fdb13","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validateCepJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validateCepJs"}],"$invalid":false},{"$id":"2b7def96-b9d0-4ebe-bb42-4e283e2bc6da","$typeOfContent":"","type":"MergeContact","$title":"Set contact - clientCep","$invalid":false,"settings":{"extras":{"clientCep":"{{clientCep}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"35fd6df6-cbcd-4ef1-b94e-a8e342047520","root":false,"$title":"Coletar CEP","$position":{"top":"1389px","left":"3752px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9e80cff9-7dc5-4d80-b5bf-456c2276ad41":{"$contentActions":[{"action":{"$id":"af484fa2-122a-4a78-ac40-02766f42a110","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"205b34a5-b2cf-4e5b-b2cc-2d9da60d9a83","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"205b34a5-b2cf-4e5b-b2cc-2d9da60d9a83","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"35f2575e-2506-4170-b64a-70f355afd723","$typeOfContent":"text","type":"SendMessage","settings":{"id":"57ab5d8f-f249-45c2-821e-a7415806e714","type":"text/plain","content":"- <b>Telefone de Contato:</b> Para mantermos uma comunicação eficiente.","metadata":{}},"$cardContent":{"document":{"id":"57ab5d8f-f249-45c2-821e-a7415806e714","type":"text/plain","content":"- <b>Telefone de Contato:</b> Para mantermos uma comunicação eficiente."},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"5b4ee9c2-8b67-45fb-a6a8-05b4c7dff10d","type":"text/plain","textContent":"User input","content":"contactNumber"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"contactNumber","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"17097fd7-6ad1-4139-8edd-3825201f6c00","typeOfStateId":"state","$connId":"con_118","$id":"c89af04d-09fb-473c-9b5d-014b0cbf2d58","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["true"],"source":"context","comparison":"equals","variable":"validatePhoneJs"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"a1440126-b0b6-4753-bf22-f775d7411a72","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validatePhoneJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(phoneNumber) {\n  try {\n    const phoneRegex = /^[\\d\\s\\(\\)\\-+]+$/;\n    return phoneRegex.test(phoneNumber);\n  } catch (error) {\n    return error.message;\n  }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validatePhoneJs] \"+String(err);}}","inputVariables":["contactNumber"],"outputVariable":"validatePhoneJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT6-4753-bf22-f775d7411a72","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validatePhoneJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validatePhoneJs"}],"$invalid":false},{"$id":"7aa5a47a-5803-4702-9448-d1e2a722b439","$typeOfContent":"","type":"MergeContact","$title":"Set contact - contactNumber","$invalid":false,"settings":{"extras":{"contactNumer":"{{conactNumber}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"9e80cff9-7dc5-4d80-b5bf-456c2276ad41","root":false,"$title":"Coletar telefone","$position":{"top":"1398px","left":"3975px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a0a3ed33-9839-4789-9bb9-5b59b65bfd73":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"cca6c640-2e05-45f7-aaab-031711c79070","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"a0a3ed33-9839-4789-9bb9-5b59b65bfd73","root":false,"$title":"API - criar lead","$position":{"top":"836px","left":"3756px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f7c5d6c3-ccfd-4d07-ac89-836130f66f93":{"$contentActions":[{"action":{"$id":"5bca01fb-c564-477f-b1ad-c3422412e6e3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3f422670-bed7-4d84-8f08-b6221c4d8531","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3f422670-bed7-4d84-8f08-b6221c4d8531","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"1adf77dd-8b72-4e29-aaca-6ec3fec2744b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"5e591e3c-9f43-491c-84f7-d5a42b984390","type":"text/plain","content":"<b>Obrigado por nos contatar!</b> ☕\nNosso time recebeu sua solicitação e entrará em contato com você o mais breve possível para oferecer a melhor solução para suas necessidades.\n\n<b>Apreciamos sua paciência e estamos ansiosos para falar com você!</b> 📞✨","metadata":{}},"$cardContent":{"document":{"id":"5e591e3c-9f43-491c-84f7-d5a42b984390","type":"text/plain","content":"<b>Obrigado por nos contatar!</b> ☕\nNosso time recebeu sua solicitação e entrará em contato com você o mais breve possível para oferecer a melhor solução para suas necessidades.\n\n<b>Apreciamos sua paciência e estamos ansiosos para falar com você!</b> 📞✨"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"5b3db92d-8773-4e0a-a581-ec0477d7e631","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"onboarding","typeOfStateId":"state","$connId":"con_123","$id":"10466b19-81dc-4d8e-9232-a82982976fef","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","root":false,"$title":"Mensagem - Encerramento","$position":{"top":"1921px","left":"2432px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"18b94675-8e98-4b3d-930a-c0db7909364f":{"$contentActions":[{"action":{"$id":"651f1aba-03b3-483f-8382-71c09c337539","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"36f3cf54-ab2e-4265-874c-0915fbf60ec3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"36f3cf54-ab2e-4265-874c-0915fbf60ec3","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"54ffb418-a240-4152-87aa-ea47e21d62bc","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"472d1eaf-7186-4459-a1f5-487c4388b0b7","type":"text/plain","textContent":"User input","content":"inputMenuEquipe"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuEquipe","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"27f30a39-df19-40d1-be4a-12e8eca7852b","typeOfStateId":"state","$connId":"con_128","$contentId":"fe3937d7-e20e-4711-88d0-4b44f7a41cf5","$id":"4c4e26e8-6eef-4b3b-82a9-bec094009844","conditions":[{"source":"input","comparison":"equals","values":["Vagas disponíveis"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_133","$contentId":"fe3937d7-e20e-4711-88d0-4b44f7a41cf5","$id":"67acbfdd-ff32-4450-bf9f-3b3d88dc0de9","conditions":[{"source":"input","comparison":"equals","values":["Saber mais"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"982fdb9c-36ac-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTc-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"fec52f09-65c6-4315-9825-c835aae91226","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal) {\n  try {\n    const textHeader = \"\";\n    const textBody = `Clique no botão abaixo . 👇`;\n    const textFooter = ``;\n\n\n    if (canal === \"whatsapp\") {\n      return {\n        type: \"application/json\",\n        content: {\n          \"recipient_type\": \"individual\",\n          \"type\": \"interactive\",\n          interactive: {\n            \"type\": \"list\",\n            header: {\n              \"type\": \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              \"button\": \"Clique aqui\",\n              \"sections\": [\n                {\n                  \"title\": \"Menu principal\",\n                  \"rows\": [\n                    { \"id\": \"1\", \"title\": \"Saber mais\", \"description\": \"Saiba mais detalhes sobre sua candidatura\" },\n                    { \"id\": \"2\", \"title\": \"Vagas disponíveis\", \"description\": \"Saber quais vagas estão disponíveis\" },\n                    { \"id\": \"3\", \"title\": \"Sair\", \"description\": \"Sair do fluxo.\" }]\n                }\n              ]\n            },\n          },\n        }\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT6-4315-9825-c835aae91226","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false},{"$id":"576169e4-7177-4520-a961-e1670afd88aa","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validateInputMenuEquipeJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(input) {\n  try {\n    const normalizedInput = input.trim();\n\n    const nameParts = normalizedInput.split(\" \");\n\n    return nameParts.length >= 2;\n  } catch (error) {\n    return false;\n  }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validateInputMenuEquipeJs] \"+String(err);}}","inputVariables":["inputMenuEquipe"],"outputVariable":"validateInputMenuEquipeJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT7-4520-a961-e1670afd88aa","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validateInputMenuEquipeJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validateInputMenuEquipeJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"a0619eb9-f534-4aa2-a5d0-c3049d260fe2","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu equipe","action":"{{inputMenuEquipe}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuEquipe"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"18b94675-8e98-4b3d-930a-c0db7909364f","root":false,"$title":"Menu - equipe","$position":{"top":"1146px","left":"3231px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"93bcf7ca-6574-4e76-a032-28a67ac5edb0":{"$contentActions":[{"action":{"$id":"322ecba8-01cc-4598-8f28-b00ad144599f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"4ffe7a5f-6d29-412b-b91c-d084d0568e7e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"4ffe7a5f-6d29-412b-b91c-d084d0568e7e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"b14efa1c-7aed-4edc-a509-2063e47f2b45","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7c1be6c7-e1a9-494c-99e4-6649faf24555","type":"text/plain","content":"Aqui estão algumas de nossas oportunidades: ","metadata":{}},"$cardContent":{"document":{"id":"7c1be6c7-e1a9-494c-99e4-6649faf24555","type":"text/plain","content":"Aqui estão algumas de nossas oportunidades: "},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"b895ef46-ab4a-4906-a082-25e6fee61099","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3f55ed0d-9af0-42f6-adca-43f156fa900e","type":"text/plain","content":"{{organizaVagasJs}}","metadata":{}},"$cardContent":{"document":{"id":"3f55ed0d-9af0-42f6-adca-43f156fa900e","type":"text/plain","content":"{{organizaVagasJs}}"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9fe8d2a4-c823-48a4-a6f8-3463c22f2c86","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"expiration":"01:00"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_138","$id":"b9743cef-1c08-4920-bb26-1744a2855e0a","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c7c31a61-e88c-4d2b-be4a-614f1e1800d2","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - organizaVagasJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(data) {\n    try {\n        const vagas = JSON.parse(data);\n        const vagasOrganizadas = vagas.map(item => ({\n            Vaga: item.Vaga,\n            Filial: item.Filial\n        }));\n\n        const resultado = vagasOrganizadas.map(item => `Vaga: ${item.Vaga}, Local: ${item.Filial}`).join('\\n');\n        return resultado;\n    } catch (error) {\n        return error.message;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - organizaVagasJs] \"+String(err);}}","inputVariables":["responseConsultaVagas"],"outputVariable":"organizaVagasJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTc-4d2b-be4a-614f1e1800d2","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{organizaVagasJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"organizaVagasJs"}],"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"93bcf7ca-6574-4e76-a032-28a67ac5edb0","root":false,"$title":"Mensagem - vagas disponíveis","$position":{"top":"1650px","left":"2585px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fab34289-eb25-4f27-ad76-283481b1e08b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"85b0fc8f-c239-41dc-9bbb-81c9c8b21302","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"expiration":"01:00"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false}],"$enteringCustomActions":[{"$id":"20465eb8-7ea6-4f3c-8451-0d8c3d64a233","$typeOfContent":"","type":"ExecuteScript","$title":"SET 'redirectInformation'","$invalid":false,"settings":{"function":"dwnt_run","source":"function run() {\n\ttry {\n\t\treturn {\n\t\t\t\"stateId\": \"{{state.previous.id}}\",\n\t\t\t\"stateName\": \"{{state.previous.name}}\",\n\t\t\t\"apllicationIdentifier\": \"{{application.identifier}}\",\n\t\t\t\"userInput\": \"{{input.content}}\"\n\t\t}\n\t} catch (error) {\n\t\treturn \"erro redirect\"\n\t}\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [SET 'redirectInformation'] \"+String(err);}}","inputVariables":[],"outputVariable":"redirectInformation","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT6-4f3c-8451-0d8c3d64a233","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{redirectInformation}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"redirectInformation"}],"$invalid":false},{"$id":"86edb703-364b-476c-a704-2727cbe2ff00","$typeOfContent":"","type":"Redirect","$title":"redirecionar ath","$invalid":false,"settings":{"address":"Ath","context":{"type":"text/plain","value":"{{redirectInformation}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#5bc0eb","label":"Redirect","id":"DWNT0d25-28a5-43f4-b509-3306608554fa","canChangeBackground":false}],"id":"fab34289-eb25-4f27-ad76-283481b1e08b","root":false,"$title":"Ath","$position":{"top":"1289px","left":"8840px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e2a65f54-49fa-472c-954c-6b554f0c4504":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"143b54b7-bc12-4fe2-bd5c-94e97fbdc8df","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"8525e3b6-273a-4b91-9a50-65288cc23284","typeOfStateId":"state","$connId":"con_143","$id":"26c99ba1-6177-4600-85ad-77194b3fd278","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"cb20a73a-7ae1-4f20-9fd4-fad8cc3ae1e3","$typeOfContent":"","type":"ProcessHttp","$title":"[Sales] Get token","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded"},"method":"POST","body":"grant_type=client_credentials&client_id=3MVG9p1Q1BCe9GmAckI.3AbrpmPwEnDHvfvg8AAHvVfxlbtNljj00mWxh_woeJm.lMn7gc75D1WJp7Y6.C9Ii&client_secret=F8021F6DA314E004675B64181BCF921B91AE63216E878974ABF7907011028384","uri":"https://astoriamaquinas.my.salesforce.com/services/oauth2/token","responseStatusVariable":"salesforceTokenStatus","responseBodyVariable":"salesforceTokenResponse"},"conditions":[]},{"$id":"b64126d9-cacb-45fc-baba-186854f0c2a2","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getAccessToken","$invalid":false,"settings":{"function":"run","source":"function run(accessToken) {\n\ttry {\n\t\tconst token = JSON.parse(accessToken)\n\t\treturn token.access_token;\n\t} catch (e) {\n\t\treturn e.message\n\t}\n}","inputVariables":["salesforceTokenResponse"],"outputVariable":"getAccessToken","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"e2a65f54-49fa-472c-954c-6b554f0c4504","root":false,"$title":"API - Get token","$position":{"top":"936.5px","left":"740.75px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"17097fd7-6ad1-4139-8edd-3825201f6c00":{"$contentActions":[{"action":{"$id":"bb58f810-c7c0-426c-9027-15f4ae0b91d9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"37123987-a7ba-4eb8-83e3-c46de19c521c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"37123987-a7ba-4eb8-83e3-c46de19c521c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"06a9127b-1e3d-4023-b4ba-9cfca1dca657","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ffd89bc6-92b7-4d82-9e59-ed0df70c0188","type":"text/plain","content":"Agradecemos por compartilhar esses detalhes conosco!","metadata":{}},"$cardContent":{"document":{"id":"ffd89bc6-92b7-4d82-9e59-ed0df70c0188","type":"text/plain","content":"Agradecemos por compartilhar esses detalhes conosco!"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"006ae4cd-04fb-453f-88e5-d5602db89b59","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_148","$id":"e4a64f92-9158-4d49-8303-c6bb00ffd416","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"17097fd7-6ad1-4139-8edd-3825201f6c00","root":false,"$title":"Agradecimento CEP e Telefone","$position":{"top":"1390px","left":"4205px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"610c7d39-e1fe-4a73-b639-9f6aef4310a2":{"$contentActions":[{"action":{"$id":"7384021d-3b2b-44c4-93e7-b37607a3c447","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fcf9c84c-e2f2-4818-acf7-2772cf6cbf76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fcf9c84c-e2f2-4818-acf7-2772cf6cbf76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f3b0d654-275c-4e53-a7e1-def9f23c83ef","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"472d1eaf-7186-4459-a1f5-487c4388b0b7","type":"text/plain","textContent":"User input","content":"inputMenuAjuda"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuAjuda","expiration":"1:0","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"ee5b52f6-8491-47f4-86aa-e968c9b7841d","typeOfStateId":"state","$connId":"con_153","$contentId":"fe3937d7-e20e-4711-88d0-4b44f7a41cf5","$id":"4c4e26e8-6eef-4b3b-82a9-bec094009844","conditions":[{"source":"context","comparison":"equals","values":["Falar com atendente","1","Falar com um atendente"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"544d6bf4-2d0a-4e77-a1e5-f22612045cc8","typeOfStateId":"state","$connId":"con_158","$contentId":"fe3937d7-e20e-4711-88d0-4b44f7a41cf5","$id":"67acbfdd-ff32-4450-bf9f-3b3d88dc0de9","conditions":[{"source":"context","comparison":"equals","values":["Comprar Produtos","2"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"a04b6838-018a-47c7-abc5-8c0756cc2b2e","typeOfStateId":"state","$connId":"con_163","$id":"91d00e7b-739a-4a3f-8d72-b51830abc1e7","conditions":[{"source":"context","comparison":"equals","values":["Locação de Aparelhos","3","Locação de Equipamentos"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"7c61421e-7dc0-4c6c-909e-636644a4c0d2","typeOfStateId":"state","$connId":"con_168","$id":"9aa05d54-e98c-4358-9c15-c89b3d8c5a6f","conditions":[{"source":"context","comparison":"equals","values":["Problema no aparelho","4","Problema no equipamento"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"544d6bf4-2d0a-4e77-a1e5-f22612045cc8","typeOfStateId":"state","$connId":"con_173","$id":"dd0e85d2-8fbb-4522-87de-68d0109c19b3","conditions":[{"source":"context","comparison":"equals","values":["2 via do boleto","5"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"839e899b-619a-4521-a710-d7cdf4af851a","typeOfStateId":"state","$connId":"con_178","$id":"f390032f-2115-4b0b-b63a-bad514e79af6","conditions":[{"source":"context","comparison":"equals","values":["2 Via de Nota Fiscal","6"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"113e3422-479d-479a-9ac4-8cf896891e35","typeOfStateId":"state","$connId":"con_183","$id":"733b116a-0428-44e5-bf1f-286603a26a30","conditions":[{"source":"context","comparison":"equals","values":["Recibo de locação","7"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"544d6bf4-2d0a-4e77-a1e5-f22612045cc8","typeOfStateId":"state","$connId":"con_188","$id":"ec34b06e-dadd-4b24-b7a9-714afb00b8f7","conditions":[{"source":"context","comparison":"equals","values":["Ver títulos abertos","8","Ver títulos em aberto"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"ee5b52f6-8491-47f4-86aa-e968c9b7841d","typeOfStateId":"state","$connId":"con_193","$id":"d37a600c-5ed8-472d-bbeb-26bbef939aee","conditions":[{"source":"context","comparison":"equals","values":["Negociar títulos","9"],"variable":"inputMenuAjuda"}],"$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_198","$id":"0f7247a4-f01c-45d9-80c7-c678051139c9","conditions":[{"source":"context","comparison":"equals","values":["Sair","10","Deixar fluxo"],"variable":"inputMenuAjuda"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"982fdb9c-36ac-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTc-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"fec52f09-65c6-4315-9825-c835aae91226","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal) {\n    try {\n      const textHeader = \"\";\n      const textBody = `Por favor, clique no botão abaixo para ver as opções. 👇`;\n      const textFooter = ``;\n  \n      const arrayOptions = [\n        { \"id\": \"1\", \"title\": \"Falar com um atendente\", \"description\": \"\" },\n        { \"id\": \"2\", \"title\": \"Comprar Produtos\", \"description\": \"\" },\n        { \"id\": \"3\", \"title\": \"Locação de Equipamentos\", \"description\": \"\" },\n        { \"id\": \"4\", \"title\": \"Problema no equipamento\", \"description\": \"\" },\n        { \"id\": \"5\", \"title\": \"2 via do boleto\", \"description\": \"\" },\n        { \"id\": \"6\", \"title\": \"2 Via de Nota Fiscal\", \"description\": \"\" },\n        { \"id\": \"7\", \"title\": \"Recibo de locação\", \"description\": \"\" },\n        { \"id\": \"8\", \"title\": \"Ver títulos em aberto\", \"description\": \"\" },\n        { \"id\": \"9\", \"title\": \"Negociar títulos\", \"description\": \"\" },\n        { \"id\": \"10\", \"title\": \"Deixar fluxo\", \"description\": \"Sair do fluxo.\" }];\n  \n      if (canal === \"whatsapp\") {\n        return {\n          type: \"application/json\",\n          content: {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            interactive: {\n              \"type\": \"list\",\n              header: {\n                \"type\": \"text\",\n                text: textHeader,\n              },\n              body: {\n                text: textBody,\n              },\n              footer: {\n                text: textFooter,\n              },\n              action: {\n                \"button\": \"Clique aqui\",\n                \"sections\": [\n                  {\n                    \"title\": \"\",\n                    \"rows\": mountMenuWhatsApp(arrayOptions)\n                  }\n                ]\n              },\n            },\n          }\n        };\n      }\n      if (canal === \"BlipChat\") {\n        return {\n          type: \"application/vnd.lime.select+json\",\n          content: {\n            text: textBody,\n            options: mountMenuBlipChat(arrayOptions),\n          },\n        };\n      }\n  \n      return {\n        type: \"text/plain\",\n        content: mountMenuText(textBody, arrayOptions),\n      };\n    } catch (error) {\n      return error.message;\n    }\n  }\n  \n  function mountMenuWhatsApp(arrayOptions) {\n  \n    // function parseDate(str) {\n    //   const parts = str.split('/');\n    //   return new Date(parts[2], parts[1] - 1, parts[0]);\n    // }\n  \n    // const sortedOptions = arrayOptions.sort((a, b) => parseDate(b.data_criacao) - parseDate(a.data_criacao));\n  \n    // const recentOptions = sortedOptions.slice(0, 10);\n  \n    return arrayOptions.reduce((acc, eachOption, index) => {\n      if (typeof eachOption === 'string') {\n        acc.push({\n          id: `${eachOption.id}`,\n          title: `${eachOption.title}`,\n          description: ''\n        });\n      } else {\n        acc.push({\n          id: `${eachOption.id}`,\n          title: `${eachOption.title}`,\n          description: `${eachOption.description}` || ''\n        });\n      }\n      return acc;\n    }, []);\n  }\n  \n  function mountMenuBlipChat(arrayOptions) {\n    return arrayOptions.reduce((acc, eachOption, index) => {\n      acc.push({\n        id: eachOption.id,\n        title: eachOption.title,\n      });\n      return acc;\n    }, []);\n  }\n  \n  function mountMenuText(textBody, arrayOptions) {\n    const textOptions = arrayOptions.reduce((acc, eachOption, index) => {\n      acc.push(`${eachOption.id} - ${eachOption.title}`);\n  \n      return acc;\n    }, []);\n  \n    return `${textBody}\\n\\n${textOptions.join(\"\\n\")}`;\n  }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT6-4315-9825-c835aae91226","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"d2ecdf7f-6048-44cb-9aaa-5a2000de747f","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu ajuda","action":"{{inputMenuAjuda}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuAjuda"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","root":false,"$title":"Menu - Ajuda","$position":{"top":"1076px","left":"4631px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ee5b52f6-8491-47f4-86aa-e968c9b7841d":{"$contentActions":[{"action":{"$id":"1cff7c25-aa7c-4667-bfd8-ffa423ef08a4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5d3967c8-30a7-47df-84ab-5b21f69233a7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"5d3967c8-30a7-47df-84ab-5b21f69233a7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"ca3030af-8943-46a8-927d-f22c2b036250","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3c93ca6b-7449-41a6-ae3e-8cf3dd3b973f","type":"text/plain","content":"Seu atendimento será transferido em breve para um de nossos atendentes. Por favor, aguarde um momento.","metadata":{}},"$cardContent":{"document":{"id":"3c93ca6b-7449-41a6-ae3e-8cf3dd3b973f","type":"text/plain","content":"Seu atendimento será transferido em breve para um de nossos atendentes. Por favor, aguarde um momento."},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e185a80c-f949-43f9-8953-54efe06db004","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_203","$id":"6fbc4f95-115c-416c-8f3e-5dd897a21b28","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"ee5b52f6-8491-47f4-86aa-e968c9b7841d","root":false,"$title":"Mensagem - Aguardar atendimento","$position":{"top":"1628px","left":"5074px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"113e3422-479d-479a-9ac4-8cf896891e35":{"$contentActions":[{"action":{"$id":"665826f6-144f-4139-a4f5-05842e71d556","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"086fb814-677e-4691-be2f-bdf22fc357fa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"086fb814-677e-4691-be2f-bdf22fc357fa","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"91ca8da6-c383-4b82-86d3-59d2ef4bc1af","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f97b06ec-daa8-461e-a9e6-f4b6daaa24cd","type":"text/plain","content":"Por favor, informe o mês relativo aos recibos que gostaria de receber?","metadata":{}},"$cardContent":{"document":{"id":"f97b06ec-daa8-461e-a9e6-f4b6daaa24cd","type":"text/plain","content":"Por favor, informe o mês relativo aos recibos que gostaria de receber?"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"8da461e6-99b1-4c21-b73e-79566be85188","type":"text/plain","textContent":"User input","content":"monthOfReceipt"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"monthOfReceipt","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_208","$id":"f2f3e2d2-efc9-4d9f-b21a-164ab7e5745f","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"113e3422-479d-479a-9ac4-8cf896891e35","root":false,"$title":"Coleta mês","$position":{"top":"1398px","left":"4636px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3535615c-cafd-48a3-b810-8e30e9693aab":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ffce86ef-9479-4881-8074-69b46e6e796f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_213","$id":"68a1b749-5e46-46d8-8f57-3d5f748a149c","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"5234a34b-ebce-4f7a-9d0a-853a867bb392","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - setQueue","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(input) {\n      const optionsMap = {\n          \"Falar com atendente\": \"default\",\n          \"Comprar Produtos\": \"vendas\",\n          \"2 via do boleto\": \"financial\",\n          \"2 Via de Nota Fiscal\": \"financial\",\n          \"Recibo de locação\": \"financial\",\n          \"Ver títulos abertos\": \"financial\",\n          \"Negociar títulos\": \"financial\"\n        };\n    try {\n      if (!optionsMap.hasOwnProperty(input)) {\n       return \"default\";\n      }\n      return optionsMap[input];\n    } catch (error) {\n      return error.message;\n    }\n  }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - setQueue] \"+String(err);}}","inputVariables":["inputMenuAjuda"],"outputVariable":"setQueueJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTe-4f7a-9d0a-853a867bb392","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{setQueueJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"setQueueJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"e958a753-2fed-4ef0-afee-3cab623e6f05","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"{{setQueueJs}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"3535615c-cafd-48a3-b810-8e30e9693aab","root":false,"$title":"Set ath","$position":{"top":"1295px","left":"8411px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a2635991-ed3c-454f-bc72-67121fb00de6":{"$contentActions":[{"action":{"$id":"729a4633-3b14-48ae-b738-170156fefb7e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"161d0f56-aaa4-43ab-bebb-074ebfdba180","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"161d0f56-aaa4-43ab-bebb-074ebfdba180","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"daf1c1f8-ac80-4e81-be10-19ae9f10830f","$typeOfContent":"text","type":"SendMessage","settings":{"id":"47f14c0e-96b6-4dce-9497-b6d66788a395","type":"text/plain","content":"Qual o número da Nota Fiscal?\nSe não sabe, você pode consultar no boleto😉","metadata":{}},"$cardContent":{"document":{"id":"47f14c0e-96b6-4dce-9497-b6d66788a395","type":"text/plain","content":"Qual o número da Nota Fiscal?\nSe não sabe, você pode consultar no boleto😉"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"397a6c0b-55ec-40b7-9af9-32729ce51d6b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3bfb4d09-52e7-46d0-a4f9-9de0d57a598b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3bfb4d09-52e7-46d0-a4f9-9de0d57a598b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"dddc1950-f3cd-474d-a86a-d88f4da75d46","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"76330f8f-d98f-4258-b58b-05dc6605fa37","type":"application/vnd.lime.select+json","content":{"text":"Se você já encontrou o número da nota fiscal, é só digitar. Senão nossa equipe financeira está pronta para te ajudar.","scope":"immediate","options":[{"text":"Não","previewText":"Não","value":null,"index":0,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"76330f8f-d98f-4258-b58b-05dc6605fa37","type":"application/vnd.lime.select+json","content":{"text":"Se você já encontrou o número da nota fiscal, é só digitar. Senão nossa equipe financeira está pronta para te ajudar.","scope":"immediate","options":[{"text":"Não","previewText":"Não","value":null,"index":0,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"8b502a24-101c-4c61-b360-5b37f5e91395","type":"text/plain","textContent":"User input","content":"noteNumber"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"noteNumber","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_218","$contentId":"dddc1950-f3cd-474d-a86a-d88f4da75d46","$id":"5ccc4d7a-e6e6-41c6-bb95-2e469b509673","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false},{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_223","$id":"fc1183f7-f197-45fb-96ca-9fecc9087e70","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"0af8d8f3-e9bb-414e-92ae-fff4845ce964","$typeOfContent":"","type":"MergeContact","$title":"Set contact - noteNumber","$invalid":false,"settings":{"extras":{"noteNumber":"{{noteNumber}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":["Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"a2635991-ed3c-454f-bc72-67121fb00de6","root":false,"$title":"Coleta número da nota","$position":{"top":"1415px","left":"5078px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a04b6838-018a-47c7-abc5-8c0756cc2b2e":{"$contentActions":[{"action":{"$id":"d2142405-43af-4ea6-8a14-8badef965a78","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"16d28f69-60a0-49ab-9bf4-3fc14a3a581c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"16d28f69-60a0-49ab-9bf4-3fc14a3a581c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"16524382-0260-4a34-9941-50e05447b322","$typeOfContent":"select","type":"SendMessage","settings":{"id":"8e8b2748-16b5-4390-a2a3-13365f905684","type":"application/vnd.lime.select+json","content":{"text":"Por favor, escolha uma opção para falar de locação:","options":[{"text":"Alugar uma máquina","previewText":"Alugar uma máquina","value":null,"index":0,"type":null},{"text":"Minha instalação","previewText":"Minha instalação","value":null,"index":1,"type":null},{"text":"Trocar minha máquina","previewText":"Trocar minha máquina","value":null,"index":2,"type":null},{"index":3,"text":"Quero devolver","previewText":"Quero devolver","type":null,"value":null},{"index":4,"text":"Falar com atendente","previewText":"Falar com atendente","type":null,"value":null}],"limitMenu":false},"metadata":{}},"$cardContent":{"document":{"id":"8e8b2748-16b5-4390-a2a3-13365f905684","type":"application/vnd.lime.select+json","content":{"text":"Por favor, escolha uma opção para falar de locação:","options":[{"text":"Alugar uma máquina","previewText":"Alugar uma máquina","value":null,"index":0,"type":null},{"text":"Minha instalação","previewText":"Minha instalação","value":null,"index":1,"type":null},{"text":"Trocar minha máquina","previewText":"Trocar minha máquina","value":null,"index":2,"type":null},{"index":3,"text":"Quero devolver","previewText":"Quero devolver","type":null,"value":null},{"index":4,"text":"Falar com atendente","previewText":"Falar com atendente","type":null,"value":null}],"limitMenu":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"f732e92c-61d1-4bfd-87e6-356c695cf79b","type":"text/plain","textContent":"User input","content":"inputMenuLocacao"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuLocacao","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_228","$contentId":"16524382-0260-4a34-9941-50e05447b322","$id":"56880c73-2339-4acf-90c0-7378439041df","conditions":[{"source":"input","comparison":"equals","values":["Alugar uma máquina","1"]}],"$invalid":false},{"stateId":"2af42be1-4a78-4a83-963c-43568d1c42b4","typeOfStateId":"state","$connId":"con_233","$contentId":"16524382-0260-4a34-9941-50e05447b322","$id":"d73cac86-6f3f-46d5-8b03-5958a2c992f5","conditions":[{"source":"input","comparison":"equals","values":["Minha instalação","2"]}],"$invalid":false},{"stateId":"5a6e28a7-3716-4665-8038-75a1ada385c4","typeOfStateId":"state","$connId":"con_238","$contentId":"16524382-0260-4a34-9941-50e05447b322","$id":"367d9aa3-fbf2-4cdb-87a6-330818669e8f","conditions":[{"source":"input","comparison":"equals","values":["Trocar minha máquina","3"]}],"$invalid":false},{"stateId":"20a5d33f-1f03-4726-84dc-7d6b3a3e5256","typeOfStateId":"state","$connId":"con_243","$contentId":"16524382-0260-4a34-9941-50e05447b322","$id":"890e6748-6f59-418b-a993-42ab3aea19f8","conditions":[{"source":"input","comparison":"equals","values":["Quero devolver","4"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_248","$contentId":"16524382-0260-4a34-9941-50e05447b322","$id":"90a5afb8-0121-4b93-a19c-580178b50a53","conditions":[{"source":"input","comparison":"equals","values":["Falar com atendente","5"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"f9a72bc4-a981-42e7-bbe7-67297541533d","$typeOfContent":"","type":"MergeContact","$title":"Set contact - setQueue","$invalid":false,"settings":{"extras":{"queue":"contract"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"8e23795e-a3a3-4ed8-9594-3ef8c312c7a6","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu locação","action":"{{inputMenuLocacao}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuLocacao"}]}],"$inputSuggestions":["Alugar uma máquina","Minha instalação","Trocar minha máquina","Quero devolver","Falar com atendente"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"a04b6838-018a-47c7-abc5-8c0756cc2b2e","root":false,"$title":"Menu - locação","$position":{"top":"1281px","left":"5765px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2af42be1-4a78-4a83-963c-43568d1c42b4":{"$contentActions":[{"action":{"$id":"832666df-99b4-47d6-b210-0edf737e9fa9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"27aa215a-eb32-4b2f-b7a8-fbb28a21ee88","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"27aa215a-eb32-4b2f-b7a8-fbb28a21ee88","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"0dff9710-88c5-46f7-bf69-1d73d7dd9559","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fe81f075-e941-416a-ba7f-aa41e6a099c6","type":"text/plain","content":"Ok então, pra eu te direcionar pra um especialista, você precisa preparar o local da instalação conforme nosso time comercial já te instruiu e como consta no nosso contrato.\nMas se tiver alguma dúvida, aqui tem umas dicas bem legais:\n\nhttps://www.youtube.com/watch?v=So4Cy0gkk7U&t=63s\n\nE aqui o croqui da instalação:","metadata":{}},"$cardContent":{"document":{"id":"fe81f075-e941-416a-ba7f-aa41e6a099c6","type":"text/plain","content":"Ok então, pra eu te direcionar pra um especialista, você precisa preparar o local da instalação conforme nosso time comercial já te instruiu e como consta no nosso contrato.\nMas se tiver alguma dúvida, aqui tem umas dicas bem legais:\n\nhttps://www.youtube.com/watch?v=So4Cy0gkk7U&t=63s\n\nE aqui o croqui da instalação:"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"9b5ff3d7-607b-4681-b71d-09cd02160c67","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"08830837-d067-41d8-bc84-35dca4d74335","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"08830837-d067-41d8-bc84-35dca4d74335","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"2c5c5900-3b39-4294-a733-8b9adea35db8","$typeOfContent":"media","type":"SendMessage","settings":{"id":"6c6d0719-a40f-447e-b5ff-e4c40ce8c16d","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://assets.dawntech.dev/content/astoria-info-tecnicas.png","aspectRatio":"1:1"},"metadata":{}},"$cardContent":{"document":{"id":"6c6d0719-a40f-447e-b5ff-e4c40ce8c16d","type":"application/vnd.lime.media-link+json","content":{"title":"","text":"","type":"image/png","uri":"https://assets.dawntech.dev/content/astoria-info-tecnicas.png","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"9c127d8f-b336-4dde-9868-e22f218c4464","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"5bafee15-ce04-4e0b-927e-4247a0854b33","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{}},"$cardContent":{"document":{"id":"5bafee15-ce04-4e0b-927e-4247a0854b33","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"502dabc6-6858-4dcb-80d6-b1510589386c","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"92d1e5b1-c24d-4731-82dc-9b736f79cf32","type":"application/vnd.lime.select+json","content":{"text":"Conseguiu preparar o local seguindo as instruções 🧐? ","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"92d1e5b1-c24d-4731-82dc-9b736f79cf32","type":"application/vnd.lime.select+json","content":{"text":"Conseguiu preparar o local seguindo as instruções 🧐? ","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"e15c11a9-43af-4ae3-9244-53ca4826301b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_253","$contentId":"502dabc6-6858-4dcb-80d6-b1510589386c","$id":"bab8ee7f-eed9-43bb-8b9f-9304ec4aad99","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"304d4e91-eb8e-4ebe-8c64-9d5e81851951","typeOfStateId":"state","$connId":"con_258","$contentId":"502dabc6-6858-4dcb-80d6-b1510589386c","$id":"1d359db1-19dc-431f-b96e-86ee950ba44a","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"2af42be1-4a78-4a83-963c-43568d1c42b4","root":false,"$title":"Preparar o local","$position":{"top":"1421px","left":"5416px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"519c9168-a231-4181-aef3-3a58e581e9fe":{"$contentActions":[{"action":{"$id":"6cf7bef2-421f-40d5-89ce-5ab24148991c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0b3de38d-0479-4b5d-9f5e-0e4ebca2f40d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0b3de38d-0479-4b5d-9f5e-0e4ebca2f40d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f4b6ac8a-f9f2-461c-92b9-d4674c852745","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a7eb0263-50ce-43ac-9904-5c3f0e134d05","type":"text/plain","content":"Pra gente agilizar a sua instalação e você ter sua Máquina Astoria encantando seus clientes sem nenhum problema, consegue me mandar as fotos como neste modelo, por favor?","metadata":{}},"$cardContent":{"document":{"id":"a7eb0263-50ce-43ac-9904-5c3f0e134d05","type":"text/plain","content":"Pra gente agilizar a sua instalação e você ter sua Máquina Astoria encantando seus clientes sem nenhum problema, consegue me mandar as fotos como neste modelo, por favor?"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"fd7312a6-c958-46d0-a694-6df066770fe2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c77e855e-99f6-4964-8fe2-f8445f10b732","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c77e855e-99f6-4964-8fe2-f8445f10b732","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"57811884-f0a0-472f-87de-2298c0fb57cb","$typeOfContent":"media","type":"SendMessage","settings":{"id":"0729d0d1-2c69-446c-b304-b9b0843efc25","type":"application/vnd.lime.media-link+json","content":{"title":"Media link title","text":"Media link subtitle","type":"image/png","uri":"https://s3-sa-east-1.amazonaws.com/msging.net/Services/Images/2e3ff2b4-a8c6-4188-bc0c-0f23531739b2","aspectRatio":"1:1"}},"$cardContent":{"document":{"id":"0729d0d1-2c69-446c-b304-b9b0843efc25","type":"application/vnd.lime.media-link+json","content":{"title":"Media link title","text":"Media link subtitle","type":"image/png","uri":"https://s3-sa-east-1.amazonaws.com/msging.net/Services/Images/2e3ff2b4-a8c6-4188-bc0c-0f23531739b2","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"752cb16d-c41f-4382-a617-2c56d0ec3c0c","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_263","$id":"7e197bd3-1167-40b0-b3c4-3703f00523a9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"96448767-1ca4-48b5-979f-38f23ef499dd","$typeOfContent":"","type":"MergeContact","$title":"Set contact - setQueue","$invalid":false,"settings":{"extras":{"queue":"operational"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"519c9168-a231-4181-aef3-3a58e581e9fe","root":false,"$title":"Mensagem - Sim, preparou o local","$position":{"top":"1787px","left":"5433px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"304d4e91-eb8e-4ebe-8c64-9d5e81851951":{"$contentActions":[{"action":{"$id":"8c2b2e4c-9cb3-4396-b7ae-6fa50cf9d836","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"183e6aca-961b-4f77-ab92-8f79d9c6cd7c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"183e6aca-961b-4f77-ab92-8f79d9c6cd7c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"ca099ff2-776c-4a5e-bcf9-677dc76ca54d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7696b13a-182f-46e6-888d-07241ae8e4d1","type":"text/plain","content":"Tudo bem! Quando estiver tudo certo você entra novamente em contato que a gente fala sobre este assunto!☕🤌","metadata":{}},"$cardContent":{"document":{"id":"7696b13a-182f-46e6-888d-07241ae8e4d1","type":"text/plain","content":"Tudo bem! Quando estiver tudo certo você entra novamente em contato que a gente fala sobre este assunto!☕🤌"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"34c1a1ab-a691-4c26-993f-238a846c675e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"onboarding","typeOfStateId":"state","$connId":"con_268","$id":"56da04cb-3813-47ed-890f-26be6639e6c4","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"304d4e91-eb8e-4ebe-8c64-9d5e81851951","root":false,"$title":"Mensagem - Não conseguiu preparar o local","$position":{"top":"1591px","left":"5420px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5a6e28a7-3716-4665-8038-75a1ada385c4":{"$contentActions":[{"action":{"$id":"a8f74a51-44db-448c-9ecf-6cb3fc395f8a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"acab0643-9b5f-475f-b9a4-11d5f0b19722","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"acab0643-9b5f-475f-b9a4-11d5f0b19722","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"81765cff-0e44-4791-a29c-15f538ff0eee","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"c0a25efd-3b4e-43d5-9b1f-8c21b5a1f543","type":"application/vnd.lime.select+json","content":{"text":"Para nos ajudar a atendê-lo melhor, por favor, nos conte o motivo.","scope":"immediate","options":[{"text":"Problema técnico","previewText":"Problema técnico","value":null,"index":0,"type":null},{"text":"Quero outra máquina","previewText":"Quero outra máquina","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"c0a25efd-3b4e-43d5-9b1f-8c21b5a1f543","type":"application/vnd.lime.select+json","content":{"text":"Para nos ajudar a atendê-lo melhor, por favor, nos conte o motivo.","scope":"immediate","options":[{"text":"Problema técnico","previewText":"Problema técnico","value":null,"index":0,"type":null},{"text":"Quero outra máquina","previewText":"Quero outra máquina","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"7b9bc19e-066e-4199-80dc-7ceade952560","type":"text/plain","textContent":"User input","content":"inputMenuTroca"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputMenuTroca"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"7c61421e-7dc0-4c6c-909e-636644a4c0d2","typeOfStateId":"state","$connId":"con_273","$contentId":"81765cff-0e44-4791-a29c-15f538ff0eee","$id":"af435d1d-4e66-4df9-b70f-5b3cea1f15a8","conditions":[{"source":"input","comparison":"equals","values":["Problema técnico","1"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_278","$contentId":"81765cff-0e44-4791-a29c-15f538ff0eee","$id":"f86e64f1-4233-4b41-aa01-1589c7236317","conditions":[{"source":"input","comparison":"equals","values":["Quero outra máquina","2"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"cb7a5785-c0a4-4bb9-af05-97d973101ef1","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu Troca","action":"{{inputMenuTroca}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuTroca"}]}],"$inputSuggestions":["Problema técnico","Quero outra máquina"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"5a6e28a7-3716-4665-8038-75a1ada385c4","root":false,"$title":"Menu - Troca","$position":{"top":"1246px","left":"6249px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"20a5d33f-1f03-4726-84dc-7d6b3a3e5256":{"$contentActions":[{"action":{"$id":"e36f473f-998f-47cf-8f0b-e943deeeb5b0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"7f072bdf-0e85-456f-856c-33d3d9dcb4c1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"7f072bdf-0e85-456f-856c-33d3d9dcb4c1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"d530821a-17a2-4bf4-9ea7-d8c991222c19","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1523fbe3-3760-4923-ac8c-396577fe37d4","type":"text/plain","content":"Por favor, nos informe o endereço da instalação.","metadata":{}},"$cardContent":{"document":{"id":"1523fbe3-3760-4923-ac8c-396577fe37d4","type":"text/plain","content":"Por favor, nos informe o endereço da instalação."},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"297d0fb3-cf41-47d2-9627-9aaaa423d621","type":"text/plain","textContent":"User input","content":"clientAddress"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"clientAddress","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"85e6f49b-355a-483a-9594-383a540da61b","typeOfStateId":"state","$connId":"con_283","$id":"09e5cc35-29a6-4e16-9101-6c7dbcde03b9","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"20a5d33f-1f03-4726-84dc-7d6b3a3e5256","root":false,"$title":"Mensagem - Devolver máquina","$position":{"top":"1625px","left":"6568px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"85e6f49b-355a-483a-9594-383a540da61b":{"$contentActions":[{"action":{"$id":"3eebf9a2-a008-4544-bcef-b5bcd415138b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c040ff35-6f73-4cb6-9b2e-56d52f8a85b6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c040ff35-6f73-4cb6-9b2e-56d52f8a85b6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"bc4c75cf-f45d-4edf-b196-522e376f104e","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"6a74328d-58b2-4cac-bffc-831f657e1ac0","type":"application/vnd.lime.select+json","content":{"text":"E nós já realizamos a instalação de sua máquina?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"6a74328d-58b2-4cac-bffc-831f657e1ac0","type":"application/vnd.lime.select+json","content":{"text":"E nós já realizamos a instalação de sua máquina?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"46abb54c-660f-48d6-9bdc-fea58ef23b8d","type":"text/plain","textContent":"User input","content":"inputInstalacaoRealizada"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputInstalacaoRealizada"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"5950ff8e-a67b-4374-b6e1-dd0c537ee5c2","typeOfStateId":"state","$connId":"con_288","$contentId":"bc4c75cf-f45d-4edf-b196-522e376f104e","$id":"ed10642b-92f2-40de-aeeb-50e60ef73ff8","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_293","$contentId":"bc4c75cf-f45d-4edf-b196-522e376f104e","$id":"01767197-d856-4378-9bac-afd36344ba8b","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"82a387b1-fd65-4ade-b3f9-38567a10471b","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Instalação realizada?","action":"{{inputInstalacaoRealizada}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputInstalacaoRealizada"}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"85e6f49b-355a-483a-9594-383a540da61b","root":false,"$title":"Instalação realizada?","$position":{"top":"1408px","left":"6775px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5950ff8e-a67b-4374-b6e1-dd0c537ee5c2":{"$contentActions":[{"action":{"$id":"d76a856d-18dd-4df0-b93a-c8445b54c6b7","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0d238af8-e232-4114-98f6-bcd4560ef4a7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0d238af8-e232-4114-98f6-bcd4560ef4a7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"e148c6ea-6d78-492a-aad5-0a83e2fc320b","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"100680bb-cda9-41fe-820f-3923c79874d5","type":"application/vnd.lime.select+json","content":{"text":"O contrato já foi rescindido?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"100680bb-cda9-41fe-820f-3923c79874d5","type":"application/vnd.lime.select+json","content":{"text":"O contrato já foi rescindido?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"62c76858-c5a2-45c3-bf97-9c28d15a665e","type":"text/plain","textContent":"User input","content":"inputContratoRescindido"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputContratoRescindido"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_298","$contentId":"e148c6ea-6d78-492a-aad5-0a83e2fc320b","$id":"edcfaf7a-6797-437a-b62b-a324bc9faa0b","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"1a89e173-7b5b-4a56-af58-bd149f334250","typeOfStateId":"state","$connId":"con_303","$contentId":"e148c6ea-6d78-492a-aad5-0a83e2fc320b","$id":"327923df-6fb9-4c59-81d9-217a9cf48f88","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"4144ba6a-dc47-45ad-af2a-a58be9454e10","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Contrato rescindido?","action":"{{inputContratoRescindido}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputContratoRescindido"}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"5950ff8e-a67b-4374-b6e1-dd0c537ee5c2","root":false,"$title":"Contrato rescindido?","$position":{"top":"1404px","left":"7020px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1a89e173-7b5b-4a56-af58-bd149f334250":{"$contentActions":[{"action":{"$id":"51af40d9-6ce7-482b-bfe0-0d80e9464cc0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"64ba26df-5440-4278-ba08-57c1f8026f0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"64ba26df-5440-4278-ba08-57c1f8026f0d","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"7d790789-4e8b-49d5-ba2c-85c193f15485","$typeOfContent":"text","type":"SendMessage","settings":{"id":"b5567a42-270f-4c92-b641-c5f75c0ead7d","type":"text/plain","content":"É uma pena 😢, mas vamos dar andamento.\nSó preciso te informar que há alguns custos envolvidos neste processo.","metadata":{}},"$cardContent":{"document":{"id":"b5567a42-270f-4c92-b641-c5f75c0ead7d","type":"text/plain","content":"É uma pena 😢, mas vamos dar andamento.\nSó preciso te informar que há alguns custos envolvidos neste processo."},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"76b28de7-c6c9-4e7c-8d2b-d178d2234435","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f67d0d4-75b1-4065-ac48-fe54120c16c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f67d0d4-75b1-4065-ac48-fe54120c16c8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"3b4fc59c-098f-4a51-81fe-1275e0a00a1a","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"9baa0c72-ef00-42b3-8728-851b371748c8","type":"application/vnd.lime.select+json","content":{"text":"Podemos continuar com o cancelamento?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"9baa0c72-ef00-42b3-8728-851b371748c8","type":"application/vnd.lime.select+json","content":{"text":"Podemos continuar com o cancelamento?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"8b4fd379-e44c-4319-8972-b5641b58f92d","type":"text/plain","textContent":"User input","content":"inputCancelamentoContrato"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputCancelamentoContrato"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_308","$contentId":"3b4fc59c-098f-4a51-81fe-1275e0a00a1a","$id":"9f43504e-1c20-4c05-b415-23c58f203b8e","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false},{"stateId":"8dd558ee-3a74-413a-b283-7e2b1dee3749","typeOfStateId":"state","$connId":"con_313","$contentId":"3b4fc59c-098f-4a51-81fe-1275e0a00a1a","$id":"4d3ce8ee-987a-4b85-ab19-b0b46614720b","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"b60d543b-4bc0-473d-a0c5-cefbb1a4c562","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- cancelar contrato?","action":"{{inputCancelamentoContrato}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputCancelamentoContrato"}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"1a89e173-7b5b-4a56-af58-bd149f334250","root":false,"$title":"Mensagem - cancelar contrato?","$position":{"top":"1376px","left":"7276px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7c61421e-7dc0-4c6c-909e-636644a4c0d2":{"$contentActions":[{"action":{"$id":"e026c083-2e29-49bc-ae72-c5c17e8e7f81","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"21bf8ce1-1403-4153-9d43-8165d2c6a3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"21bf8ce1-1403-4153-9d43-8165d2c6a3e7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"85b707d4-5ba2-4c4a-869d-660e0b242fc2","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"50e6d968-e747-4605-af74-9a89d6748b35","type":"application/vnd.lime.select+json","content":{"text":"Qual tipo de equipamento não está operando conforme o esperado?⚙️","scope":"immediate","options":[{"text":"Moinho","previewText":"Moinho","value":null,"index":0,"type":null},{"text":"Máquina de café","previewText":"Máquina de café","value":null,"index":1,"type":null},{"index":-1,"text":"Máquina de lavar","previewText":"Máquina de lavar","type":null,"value":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"50e6d968-e747-4605-af74-9a89d6748b35","type":"application/vnd.lime.select+json","content":{"text":"Qual tipo de equipamento não está operando conforme o esperado?⚙️","scope":"immediate","options":[{"text":"Moinho","previewText":"Moinho","value":null,"index":0,"type":null},{"text":"Máquina de café","previewText":"Máquina de café","value":null,"index":1,"type":null},{"index":-1,"text":"Máquina de lavar","previewText":"Máquina de lavar","type":null,"value":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"e8bfe8ab-a64f-4e7c-a91b-ea569336495b","type":"text/plain","textContent":"User input","content":"inputTipoDoEquipamento"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputTipoDoEquipamento"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"5b18f325-d3f1-4b9d-8dd8-4163bb12bb33","typeOfStateId":"state","$connId":"con_318","$contentId":"c36377a2-e7da-49a1-a28c-8eeaa71cd185","$id":"310b9712-847d-4a2b-99b0-9d48f9a4732e","conditions":[{"source":"input","comparison":"equals","values":["Moinho"]}],"$invalid":false},{"stateId":"ff8b9b85-35f7-4b23-abc0-8a5abe679d6c","typeOfStateId":"state","$connId":"con_323","$contentId":"c36377a2-e7da-49a1-a28c-8eeaa71cd185","$id":"a2a0ea1c-a0be-4363-9402-e701bea4096a","conditions":[{"source":"input","comparison":"equals","values":["Máquina de café"]}],"$invalid":false},{"stateId":"8543850e-c663-4fd7-80e2-29c91717704f","typeOfStateId":"state","$connId":"con_328","$contentId":"c36377a2-e7da-49a1-a28c-8eeaa71cd185","$id":"3b2e2649-722c-48d9-bbe5-eeac88d2f1a6","conditions":[{"source":"input","comparison":"equals","values":["Máquina de lavar"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"fea44431-eccf-49f2-ac80-3304ae7218fe","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu tipo do equipamento","action":"{{inputTipoDoEquipamento}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputTipoDoEquipamento"}]}],"$inputSuggestions":["Moinho","Máquina de café","Máquina de lavar"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"7c61421e-7dc0-4c6c-909e-636644a4c0d2","root":false,"$title":"Menu - Qual o tipo do equipamento?","$position":{"top":"2174px","left":"5336px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5b18f325-d3f1-4b9d-8dd8-4163bb12bb33":{"$contentActions":[{"action":{"$id":"026ae806-0cdb-49b9-867f-3c2d2c21b4a4","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fc80b12c-4702-4973-9dee-3bd09e7f4102","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fc80b12c-4702-4973-9dee-3bd09e7f4102","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"9138269b-d4ff-41c7-b762-d90cbd729eea","$typeOfContent":"text","type":"SendMessage","settings":{"id":"209bc2c8-f344-4a2c-83ba-bd10eca6bae6","type":"text/plain","content":"Você sabe regular o moinho?\nSegue um vídeo onde nosso time explica como se faz:\n\nhttps://www.youtube.com/watch?v=SS8cUuVupUQ","metadata":{}},"$cardContent":{"document":{"id":"209bc2c8-f344-4a2c-83ba-bd10eca6bae6","type":"text/plain","content":"Você sabe regular o moinho?\nSegue um vídeo onde nosso time explica como se faz:\n\nhttps://www.youtube.com/watch?v=SS8cUuVupUQ"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"b40527db-19a1-4dc9-b8a7-a86958935a45","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"45f70c69-cb3c-47e2-b549-67044f6f874b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"},"metadata":{}},"$cardContent":{"document":{"id":"45f70c69-cb3c-47e2-b549-67044f6f874b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":"3000"}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"ba4e1dbf-b206-4a80-b37f-60fbd4fef64f","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"7a015779-87d7-46bf-9712-aa49c8763939","type":"application/vnd.lime.select+json","content":{"text":"Seguindo as orientações, seu moinho entrega a moagem que você gostaria?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"7a015779-87d7-46bf-9712-aa49c8763939","type":"application/vnd.lime.select+json","content":{"text":"Seguindo as orientações, seu moinho entrega a moagem que você gostaria?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"560423a8-dc1c-45c7-afa9-2b1106003eeb","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_333","$contentId":"ba4e1dbf-b206-4a80-b37f-60fbd4fef64f","$id":"15f16e78-a4cf-4459-9616-c83c8b940316","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_338","$contentId":"ba4e1dbf-b206-4a80-b37f-60fbd4fef64f","$id":"499eca87-2eca-4f2f-ad7e-bc2f480763a6","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"531f3655-8bbf-4113-8469-852d05ffe3d0","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"technical"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"5b18f325-d3f1-4b9d-8dd8-4163bb12bb33","root":false,"$title":"Mensagem - regular moinho","$position":{"top":"2475px","left":"3185px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ff8b9b85-35f7-4b23-abc0-8a5abe679d6c":{"$contentActions":[{"action":{"$id":"7384021d-3b2b-44c4-93e7-b37607a3c447","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fcf9c84c-e2f2-4818-acf7-2772cf6cbf76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fcf9c84c-e2f2-4818-acf7-2772cf6cbf76","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f3b0d654-275c-4e53-a7e1-def9f23c83ef","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"472d1eaf-7186-4459-a1f5-487c4388b0b7","type":"text/plain","textContent":"User input","content":"inputMenuMaquinaDeCafe"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuMaquinaDeCafe","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_343","$id":"2d69f49f-486b-462e-9927-02e8a17086cc","conditions":[{"source":"input","comparison":"equals","values":["Porta filtro não encaixa"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_348","$id":"373cb474-6cc6-49a1-b540-14d846cb9548","conditions":[{"source":"input","comparison":"equals","values":["Máquina vazando"]}],"$invalid":false},{"stateId":"a9a7d5b0-2f32-4103-a53c-0abeea12c75a","typeOfStateId":"state","$connId":"con_353","$id":"d66dbcb0-e260-4e45-9be1-00a4d28e4f27","conditions":[{"source":"input","comparison":"equals","values":["Máquina parada"]}],"$invalid":false},{"stateId":"d904766e-a78a-4880-a8b4-c3350ee093d2","typeOfStateId":"state","$connId":"con_358","$id":"a723285b-9816-471b-a38f-fae1333cb5d6","conditions":[{"source":"input","comparison":"equals","values":["Máquina sem pressão"]}],"$invalid":false},{"stateId":"f58181e3-4e76-410c-85da-c5270d6cfd76","typeOfStateId":"state","$connId":"con_363","$id":"b585f890-1da3-4f54-878d-acffe834cbd2","conditions":[{"source":"input","comparison":"equals","values":["Tamanho inexato da dose"]}],"$invalid":false},{"stateId":"dbb9b219-e4e6-467e-bcef-a9d756ebc13e","typeOfStateId":"state","$connId":"con_368","$id":"236c466f-2752-4643-8f00-01b5452f1ee4","conditions":[{"source":"input","comparison":"equals","values":["Café abaixo do esperado"]}],"$invalid":false},{"stateId":"b33f98e0-e6fa-4d2c-af67-408963ab5b4a","typeOfStateId":"state","$connId":"con_373","$id":"867dc426-193c-4aee-87b4-901bfd250286","conditions":[{"source":"input","comparison":"equals","values":["Máquina com barulho"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_378","$id":"cc3ef756-69fc-47d4-a252-5b065331d671","conditions":[{"source":"input","comparison":"equals","values":["Vaporizador não conforme"]}],"$invalid":false},{"stateId":"0f0833df-2b9c-4764-8624-65d6af34a3c0","typeOfStateId":"state","$connId":"con_383","$id":"bd656db0-cafa-4296-9346-cea0ed490c80","conditions":[{"source":"input","comparison":"equals","values":["Não sai água no grupo"]}],"$invalid":false},{"stateId":"daa81d93-3e00-450c-b45f-ae4c08e7f918","typeOfStateId":"state","$connId":"con_388","$id":"7befcac6-d217-439e-b57a-57ab8221ec70","conditions":[{"source":"input","comparison":"equals","values":["LED piscando"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"982fdb9c-36ac-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTc-42da-92e9-6aa9d04eec2b","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"fec52f09-65c6-4315-9825-c835aae91226","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal) {\n    try {\n      const textHeader = \"\";\n      const textBody = `Conte para mim qual problema você está enfrentando. Muitas questões podem ser resolvidas mais rapidamente se eu te explicar como corrigir antes de transferir para um especialista. 🧑‍🔧`;\n      const textFooter = ``;\n  \n      const arrayOptions = [\n        { \"id\": \"1\", \"title\": \"Porta filtro não encaixa\", \"description\": \"\" },\n        { \"id\": \"2\", \"title\": \"Máquina vazando\", \"description\": \"\" },\n        { \"id\": \"3\", \"title\": \"Máquina parada\", \"description\": \"\" },\n        { \"id\": \"4\", \"title\": \"Máquina sem pressão\", \"description\": \"\" },\n        { \"id\": \"5\", \"title\": \"Tamanho inexato da dose\", \"description\": \"\" },\n        { \"id\": \"6\", \"title\": \"Café abaixo do esperado\", \"description\": \"\" },\n        { \"id\": \"7\", \"title\": \"Máquina com barulho\", \"description\": \"\" },\n        { \"id\": \"8\", \"title\": \"Vaporizador não conforme\", \"description\": \"\" },\n        { \"id\": \"9\", \"title\": \"Não sai água no grupo\", \"description\": \"\" },\n        { \"id\": \"10\", \"title\": \"LED piscando\", \"description\": \"\" }];\n  \n      if (canal === \"whatsapp\") {\n        return {\n          type: \"application/json\",\n          content: {\n            \"recipient_type\": \"individual\",\n            \"type\": \"interactive\",\n            interactive: {\n              \"type\": \"list\",\n              header: {\n                \"type\": \"text\",\n                text: textHeader,\n              },\n              body: {\n                text: textBody,\n              },\n              footer: {\n                text: textFooter,\n              },\n              action: {\n                \"button\": \"Clique aqui\",\n                \"sections\": [\n                  {\n                    \"title\": \"\",\n                    \"rows\": mountMenuWhatsApp(arrayOptions)\n                  }\n                ]\n              },\n            },\n          }\n        };\n      }\n      if (canal === \"BlipChat\") {\n        return {\n          type: \"application/vnd.lime.select+json\",\n          content: {\n            text: textBody,\n            options: mountMenuBlipChat(arrayOptions),\n          },\n        };\n      }\n  \n      return {\n        type: \"text/plain\",\n        content: mountMenuText(textBody, arrayOptions),\n      };\n    } catch (error) {\n      return error.message;\n    }\n  }\n  \n  function mountMenuWhatsApp(arrayOptions) {\n  \n    // function parseDate(str) {\n    //   const parts = str.split('/');\n    //   return new Date(parts[2], parts[1] - 1, parts[0]);\n    // }\n  \n    // const sortedOptions = arrayOptions.sort((a, b) => parseDate(b.data_criacao) - parseDate(a.data_criacao));\n  \n    // const recentOptions = sortedOptions.slice(0, 10);\n  \n    return arrayOptions.reduce((acc, eachOption, index) => {\n      if (typeof eachOption === 'string') {\n        acc.push({\n          id: `${eachOption.id}`,\n          title: `${eachOption.title}`,\n          description: ''\n        });\n      } else {\n        acc.push({\n          id: `${eachOption.id}`,\n          title: `${eachOption.title}`,\n          description: `${eachOption.description}` || ''\n        });\n      }\n      return acc;\n    }, []);\n  }\n  \n  function mountMenuBlipChat(arrayOptions) {\n    return arrayOptions.reduce((acc, eachOption, index) => {\n      acc.push({\n        id: eachOption.id,\n        title: eachOption.title,\n      });\n      return acc;\n    }, []);\n  }\n  \n  function mountMenuText(textBody, arrayOptions) {\n    const textOptions = arrayOptions.reduce((acc, eachOption, index) => {\n      acc.push(`${eachOption.id} - ${eachOption.title}`);\n  \n      return acc;\n    }, []);\n  \n    return `${textBody}\\n\\n${textOptions.join(\"\\n\")}`;\n  }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT6-4315-9825-c835aae91226","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false},{"$id":"71a1ed11-5512-4aa3-9f48-5d041932e092","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"technical"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[{"$id":"b3075553-ba75-4bec-ae08-5c763313ba14","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu máquina de café","action":"{{inputMenuMaquinaDeCafe}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMenuMaquinaDeCafe"}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"ff8b9b85-35f7-4b23-abc0-8a5abe679d6c","root":false,"$title":"Menu - Máquina de café","$position":{"top":"2447px","left":"5313px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8543850e-c663-4fd7-80e2-29c91717704f":{"$contentActions":[{"action":{"$id":"e96f52ed-9d63-454e-8373-81fefb403956","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"71b00c5c-ca9f-4c3b-8fec-ec195fb98742","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"71b00c5c-ca9f-4c3b-8fec-ec195fb98742","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"7b929ff3-4ff3-4831-8ca9-2b647601ed77","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"dbf3a4ca-625e-42b6-af47-71ba6d4ef74a","type":"application/vnd.lime.select+json","content":{"text":"Selecione umas das opções a seguir para prosseguirmos","scope":"immediate","options":[{"text":"Não consome secante","previewText":"Não consome secante","value":null,"index":0,"type":null},{"text":"Máquina está vazando","previewText":"Máquina está vazando","value":null,"index":1,"type":null},{"index":2,"text":"Máquina parada","previewText":"Máquina parada","type":null,"value":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"dbf3a4ca-625e-42b6-af47-71ba6d4ef74a","type":"application/vnd.lime.select+json","content":{"text":"Selecione umas das opções a seguir para prosseguirmos","scope":"immediate","options":[{"text":"Não consome secante","previewText":"Não consome secante","value":null,"index":0,"type":null},{"text":"Máquina está vazando","previewText":"Máquina está vazando","value":null,"index":1,"type":null},{"index":2,"text":"Máquina parada","previewText":"Máquina parada","type":null,"value":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"dd2ff06a-3706-4421-8841-ac1c711d34f7","type":"text/plain","textContent":"User input","content":"inputMaquinaDeLavar"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}],"variable":"inputMaquinaDeLavar"},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"d1350968-64f3-4129-ab40-9e28ad670cf3","typeOfStateId":"state","$connId":"con_393","$contentId":"7b929ff3-4ff3-4831-8ca9-2b647601ed77","$id":"3ec66504-989e-4d9c-8c81-90e750edd6fe","conditions":[{"source":"input","comparison":"equals","values":["Não consome secante"]}],"$invalid":false},{"stateId":"8baf118f-c00b-406f-97cf-75f32c3b4568","typeOfStateId":"state","$connId":"con_398","$contentId":"7b929ff3-4ff3-4831-8ca9-2b647601ed77","$id":"fab047bb-ae71-4081-ad75-ef39599e5068","conditions":[{"source":"input","comparison":"equals","values":["Máquina está vazando"]}],"$invalid":false},{"stateId":"e529d953-0510-4193-9638-ccf615e6fd92","typeOfStateId":"state","$connId":"con_403","$contentId":"7b929ff3-4ff3-4831-8ca9-2b647601ed77","$id":"ae20e69c-e20f-47a6-93da-6b6333f68667","conditions":[{"source":"input","comparison":"equals","values":["Máquina parada"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"81e79638-1115-4e50-b509-323948f89e71","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"technical"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"80de0e3a-253f-4f30-95fa-6295f9c9f53f","$typeOfContent":"","type":"TrackEvent","$title":"Event tracking","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu máquina de lavar","action":"{{inputMaquinaDeLavar}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMaquinaDeLavar"}]}],"$inputSuggestions":["Não consome secante","Máquina está vazando","Máquina parada"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"8543850e-c663-4fd7-80e2-29c91717704f","root":false,"$title":"Menu - Máquina de lavar","$position":{"top":"2750px","left":"3846px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2f4b8a61-197d-4b30-8f6b-12c5b1f92e6b":{"$contentActions":[{"action":{"$id":"be57ba85-9eb7-4393-8d8c-9091e5d3cb4a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6d706762-cb46-4d06-8602-2c5bfb939e6e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6d706762-cb46-4d06-8602-2c5bfb939e6e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"97c42c0e-3d7e-49cb-9350-42c7ee265b8e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"fb8427aa-e339-4d48-a090-d09c76240629","type":"text/plain","content":"Exibir as informações aqui","metadata":{}},"$cardContent":{"document":{"id":"fb8427aa-e339-4d48-a090-d09c76240629","type":"text/plain","content":"Exibir as informações aqui"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"3c6a4529-db30-48d7-8704-1d7fd7272658","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"1139321b-cb5a-44c6-860f-6745230806ec","typeOfStateId":"state","$connId":"con_408","$id":"ef31b77f-c152-49a9-8cd7-a64d8e01ca74","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"2f4b8a61-197d-4b30-8f6b-12c5b1f92e6b","root":false,"$title":"Informações - Filtro não encaixa","$position":{"top":"2756px","left":"4582px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1139321b-cb5a-44c6-860f-6745230806ec":{"$contentActions":[{"action":{"$id":"b52175f0-fc84-4ca9-a9f2-f0538dd2145d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"94b03a26-5a19-4514-8ddf-a4e82a7e425f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"94b03a26-5a19-4514-8ddf-a4e82a7e425f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"d4a41af1-eae3-4bc9-93d6-430c7e1e7929","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"92d789c7-7993-48eb-ba14-3db685ed0fa1","type":"application/vnd.lime.select+json","content":{"text":"Seguindo as orientações, seu porta filtro encaixa?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"92d789c7-7993-48eb-ba14-3db685ed0fa1","type":"application/vnd.lime.select+json","content":{"text":"Seguindo as orientações, seu porta filtro encaixa?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"16b7b5a4-9551-47c2-aea5-81810ea85843","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_413","$contentId":"d4a41af1-eae3-4bc9-93d6-430c7e1e7929","$id":"12fe19b2-4052-4dff-8038-9653e4d8c94c","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_418","$contentId":"d4a41af1-eae3-4bc9-93d6-430c7e1e7929","$id":"380c3088-5d74-423a-bbb8-8e1fe00afa33","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"b6be6068-adad-42a0-b5f4-4a0e2692458a","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"technical"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"1139321b-cb5a-44c6-860f-6745230806ec","root":false,"$title":"Problema com filtro resolvido?","$position":{"top":"2907px","left":"4581px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3913bac4-ccd3-4b43-9f32-68e83cfb1058":{"$contentActions":[{"action":{"$id":"5e943503-af90-41a9-88f3-adba7fe7737f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"153dd98d-4975-4403-aa34-da6c78dc8c7c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"153dd98d-4975-4403-aa34-da6c78dc8c7c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"fed29950-28ec-4d96-a0f3-bc0c4328756e","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"9b76ea1b-a78a-4e16-a408-1a23ebb0ef57","type":"application/vnd.lime.select+json","content":{"text":"Me conta uma coisa: A água que está vazando está transparente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"9b76ea1b-a78a-4e16-a408-1a23ebb0ef57","type":"application/vnd.lime.select+json","content":{"text":"Me conta uma coisa: A água que está vazando está transparente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"10a867ac-9b05-4c9e-b4c2-b31ee067585e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"bc456784-aedc-4df3-89ae-2530272a6905","typeOfStateId":"state","$connId":"con_423","$contentId":"fed29950-28ec-4d96-a0f3-bc0c4328756e","$id":"dfb06968-507b-474d-9c45-8d75f9f06042","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"2ec4442b-2532-432d-ba17-f27836bb4215","typeOfStateId":"state","$connId":"con_428","$contentId":"fed29950-28ec-4d96-a0f3-bc0c4328756e","$id":"0c974987-c81e-42e7-96a1-ac062b73233e","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"40940728-f7a1-4ff7-b785-1d086759e00b","$typeOfContent":"","type":"MergeContact","$title":"Set contact - queue","$invalid":false,"settings":{"extras":{"queue":"technical"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"3913bac4-ccd3-4b43-9f32-68e83cfb1058","root":false,"$title":"Instruções máquina vazando","$position":{"top":"2811px","left":"5159px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"bc456784-aedc-4df3-89ae-2530272a6905":{"$contentActions":[{"action":{"$id":"bc1e3a4e-b759-48d9-9a61-bc8f22443351","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"92c1d26f-b605-42a4-9308-74e2fdd48ecf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"92c1d26f-b605-42a4-9308-74e2fdd48ecf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"1452d32b-4812-42e6-a6ba-53167a310dcf","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e3aac809-0d6c-4cb3-afb7-19a9c7f63601","type":"text/plain","content":"Então preciso que você verifique se os furos maiores da bandeja estão corretamente posicionados abaixo dos bicos de extração. \nDeste jeito:","metadata":{}},"$cardContent":{"document":{"id":"e3aac809-0d6c-4cb3-afb7-19a9c7f63601","type":"text/plain","content":"Então preciso que você verifique se os furos maiores da bandeja estão corretamente posicionados abaixo dos bicos de extração. \nDeste jeito:"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"6dd0d321-4531-4f02-ab05-86c64e51cc0c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b0d8ed3c-86a7-4a74-8e3b-9c025646b346","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b0d8ed3c-86a7-4a74-8e3b-9c025646b346","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"270672a2-2480-4c4c-af7a-6dfca6a2954d","$typeOfContent":"media","type":"SendMessage","settings":{"id":"be7bc76b-0297-419b-95b1-ef73641e37a0","type":"application/vnd.lime.media-link+json","content":{"title":"Media link title","text":"Media link subtitle","type":"image/png","uri":"https://s3-sa-east-1.amazonaws.com/msging.net/Services/Images/2e3ff2b4-a8c6-4188-bc0c-0f23531739b2","aspectRatio":"1:1"}},"$cardContent":{"document":{"id":"be7bc76b-0297-419b-95b1-ef73641e37a0","type":"application/vnd.lime.media-link+json","content":{"title":"Media link title","text":"Media link subtitle","type":"image/png","uri":"https://s3-sa-east-1.amazonaws.com/msging.net/Services/Images/2e3ff2b4-a8c6-4188-bc0c-0f23531739b2","aspectRatio":"1:1"}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"ad246d34-5fae-48dd-8c83-1d8dd8119ecc","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"b068aaec-0120-4b75-a15a-c28fb24a7a77","typeOfStateId":"state","$connId":"con_433","$id":"b44fc8e7-0bf1-4c45-a2f4-34608b7bcbeb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"bc456784-aedc-4df3-89ae-2530272a6905","root":false,"$title":"Está transparente","$position":{"top":"3071px","left":"4989px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"2ec4442b-2532-432d-ba17-f27836bb4215":{"$contentActions":[{"action":{"$id":"2b297c5d-e847-4264-8fbc-7bdac7928298","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"94287f16-9e66-4dce-90ff-5ea3b9ac74e6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"94287f16-9e66-4dce-90ff-5ea3b9ac74e6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"644f01ce-9ec0-437e-92c8-d2779d5e863c","$typeOfContent":"text","type":"SendMessage","settings":{"id":"c4c774e4-2725-40ff-aee8-538c83baa3e3","type":"text/plain","content":"Neste caso, por favor retire a bandeja e verifique se a caixinha de dreno esta cheia","metadata":{}},"$cardContent":{"document":{"id":"c4c774e4-2725-40ff-aee8-538c83baa3e3","type":"text/plain","content":"Neste caso, por favor retire a bandeja e verifique se a caixinha de dreno esta cheia"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"0cfb25b4-1cca-4aff-b59b-ec20f82a9a08","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"06f10cc9-8122-408e-baeb-dc0feb141dc6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"06f10cc9-8122-408e-baeb-dc0feb141dc6","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"d2a0ff95-8eb6-4c6a-b5a3-48a658e266a8","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"a10f3c00-b407-4f19-aae0-4460deb72625","type":"application/vnd.lime.select+json","content":{"text":"Ela esta cheia?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"a10f3c00-b407-4f19-aae0-4460deb72625","type":"application/vnd.lime.select+json","content":{"text":"Ela esta cheia?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"9941d49c-f358-4b56-be0f-5795b9567d81","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"26c5ecd0-7b77-4d11-9bfa-6c82cd9953d8","typeOfStateId":"state","$connId":"con_438","$contentId":"d2a0ff95-8eb6-4c6a-b5a3-48a658e266a8","$id":"8a35bda6-79f8-4eb8-8ef8-07e14b578a4b","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_443","$contentId":"d2a0ff95-8eb6-4c6a-b5a3-48a658e266a8","$id":"cb5cba44-1e5d-46cb-ace8-8dc4155e38ad","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"2ec4442b-2532-432d-ba17-f27836bb4215","root":false,"$title":"Não está transparente","$position":{"top":"3029px","left":"5330px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b068aaec-0120-4b75-a15a-c28fb24a7a77":{"$contentActions":[{"action":{"$id":"7370db58-d693-4d2e-bf4c-799ef762182c","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0caddfc2-c4b1-4c08-b8b5-2e1d80f2d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0caddfc2-c4b1-4c08-b8b5-2e1d80f2d6d8","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"8b829392-7761-4966-9351-fc47a6a4b4e1","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"7c02ba1a-3896-448b-b084-4b0f34d26d18","type":"application/vnd.lime.select+json","content":{"text":"Estando a bandeja corretamente posicionada, o vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"7c02ba1a-3896-448b-b084-4b0f34d26d18","type":"application/vnd.lime.select+json","content":{"text":"Estando a bandeja corretamente posicionada, o vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"2a4f77b5-9d4a-4884-861b-b9c63cd7f1e3","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_448","$contentId":"8b829392-7761-4966-9351-fc47a6a4b4e1","$id":"072d9b97-f9fd-47a9-a44d-4e2b3f8cf18f","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_453","$contentId":"8b829392-7761-4966-9351-fc47a6a4b4e1","$id":"2f6c3abe-4819-4cf4-9b43-732f22b3952b","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"b068aaec-0120-4b75-a15a-c28fb24a7a77","root":false,"$title":"Água - Problema resolvido?","$position":{"top":"3220px","left":"4993px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dbb9b219-e4e6-467e-bcef-a9d756ebc13e":{"$contentActions":[{"action":{"$id":"d52f1538-5a62-438c-92d9-2713d1ec9328","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"823b8ce6-91bc-4cf4-aa6a-4c088a3a4c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"823b8ce6-91bc-4cf4-aa6a-4c088a3a4c4f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"d2b9b6ed-1aff-4570-8f93-457381f36eca","$typeOfContent":"text","type":"SendMessage","settings":{"id":"27d16d48-7626-4539-bbd4-4f5c4edaa1ef","type":"text/plain","content":"Muitas coisas podem ter acontecido para a sua bebida não estar com a qualidade que gostaria.\nNo Menu Anterior citamos os motivos mais recorrentes relacionados ao funcionamento da Máquina. Se nenhuma das opções te atendeu, recomendamos que siga o nosso canal do Youtube, em: https://www.youtube.com/@ASTORIABRASILoficial \n\nPor lá, teremos conteúdos que te ensinam como extrair o melhor dos nossos equipamentos entre outros conteúdos.\n\nDe cara, já indico este vídeo aqui:\nhttps://www.youtube.com/watch?v=AJudapZEL-w","metadata":{}},"$cardContent":{"document":{"id":"27d16d48-7626-4539-bbd4-4f5c4edaa1ef","type":"text/plain","content":"Muitas coisas podem ter acontecido para a sua bebida não estar com a qualidade que gostaria.\nNo Menu Anterior citamos os motivos mais recorrentes relacionados ao funcionamento da Máquina. Se nenhuma das opções te atendeu, recomendamos que siga o nosso canal do Youtube, em: https://www.youtube.com/@ASTORIABRASILoficial \n\nPor lá, teremos conteúdos que te ensinam como extrair o melhor dos nossos equipamentos entre outros conteúdos.\n\nDe cara, já indico este vídeo aqui:\nhttps://www.youtube.com/watch?v=AJudapZEL-w"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"9f2c9764-9046-4c02-8954-700896fe1fbb","typeOfStateId":"state","$connId":"con_458","$id":"f3f95fc1-853a-4b9e-a41e-227f2a390051","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"dbb9b219-e4e6-467e-bcef-a9d756ebc13e","root":false,"$title":"Instruções - qualidade do café","$position":{"top":"2751px","left":"6332px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"26c5ecd0-7b77-4d11-9bfa-6c82cd9953d8":{"$contentActions":[{"action":{"$id":"69fdb3cf-1cf0-48d2-a148-a25edd4714ff","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1a24662a-14b1-48af-b2a9-98ddc2f60a52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1a24662a-14b1-48af-b2a9-98ddc2f60a52","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"057507dc-2f25-49cd-bd66-b0359514fbb8","$typeOfContent":"text","type":"SendMessage","settings":{"id":"29a1ac6f-166a-44ac-8d96-7046d48db5ff","type":"text/plain","content":"Isso significa que o dreno de saída está entupido🤔\nPreciso que faça o seguinte:","metadata":{}},"$cardContent":{"document":{"id":"29a1ac6f-166a-44ac-8d96-7046d48db5ff","type":"text/plain","content":"Isso significa que o dreno de saída está entupido🤔\nPreciso que faça o seguinte:"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"15b5bce5-196d-4a93-be9c-0a72e183439b","typeOfStateId":"state","$connId":"con_463","$id":"d7dee477-3d30-4f24-a5ad-107dc8a21879","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"26c5ecd0-7b77-4d11-9bfa-6c82cd9953d8","root":false,"$title":"Instruções dreno","$position":{"top":"3175px","left":"5331px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"15b5bce5-196d-4a93-be9c-0a72e183439b":{"$contentActions":[{"action":{"$id":"dd7af987-5995-44d3-85ee-8821f456a4a3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"19b7c29d-a86a-43e8-a8c3-e4abbd103a3f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"19b7c29d-a86a-43e8-a8c3-e4abbd103a3f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"0a1654a6-094c-4b3d-89b8-94e593b8f3cc","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"cac96a5e-8f3f-4cc0-9db5-3c2f73446c13","type":"application/vnd.lime.select+json","content":{"text":"Após a limpeza o vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"cac96a5e-8f3f-4cc0-9db5-3c2f73446c13","type":"application/vnd.lime.select+json","content":{"text":"Após a limpeza o vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_468","$contentId":"0a1654a6-094c-4b3d-89b8-94e593b8f3cc","$id":"11f8cffc-af82-4d52-91b5-0f30773c39af","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_473","$contentId":"0a1654a6-094c-4b3d-89b8-94e593b8f3cc","$id":"dabdbc5a-3f0f-4468-9fc6-09b21c1823da","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"15b5bce5-196d-4a93-be9c-0a72e183439b","root":false,"$title":"vazamento continua?","$position":{"top":"3309px","left":"5336px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"a9a7d5b0-2f32-4103-a53c-0abeea12c75a":{"$contentActions":[{"action":{"$id":"94b4b61c-45f4-42c5-9b6f-e269494bc5a9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"800f33ef-8118-43ea-949b-751f0fc60a67","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000},"metadata":{}},"$cardContent":{"document":{"id":"800f33ef-8118-43ea-949b-751f0fc60a67","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f577fc69-b642-4ac4-954b-62de165984bc","$typeOfContent":"text","type":"SendMessage","settings":{"id":"e3d96bfb-51aa-4598-b7c2-1f1c1fa88272","type":"text/plain","content":"Vou te pedir pra tentar alguns procedimentos que podem resolver isto. Tudo bem? \n\nVeja o vídeo abaixo:\nhttps://www.youtube.com/watch?v=CuL8Q4juq78","metadata":{}},"$cardContent":{"document":{"id":"e3d96bfb-51aa-4598-b7c2-1f1c1fa88272","type":"text/plain","content":"Vou te pedir pra tentar alguns procedimentos que podem resolver isto. Tudo bem? \n\nVeja o vídeo abaixo:\nhttps://www.youtube.com/watch?v=CuL8Q4juq78"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"cf70adec-a687-4062-91a5-40551682c2b9","typeOfStateId":"state","$connId":"con_478","$id":"8014841a-c5ed-4634-881f-0cc1e42e4ddb","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"a9a7d5b0-2f32-4103-a53c-0abeea12c75a","root":false,"$title":"Instruções maquina parada","$position":{"top":"2756px","left":"5637px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"cf70adec-a687-4062-91a5-40551682c2b9":{"$contentActions":[{"action":{"$id":"c13e0597-1787-4321-8061-cc19e610a7ad","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"23f12297-2c5a-4739-adc7-3eec9ba3f610","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"23f12297-2c5a-4739-adc7-3eec9ba3f610","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f4e90215-82b7-44d2-9c3a-c41a8b39fbc3","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"972db406-4bdd-40cd-be8f-8ef7f9bd55e4","type":"application/vnd.lime.select+json","content":{"text":"O problema foi resolvido?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"972db406-4bdd-40cd-be8f-8ef7f9bd55e4","type":"application/vnd.lime.select+json","content":{"text":"O problema foi resolvido?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_483","$contentId":"f4e90215-82b7-44d2-9c3a-c41a8b39fbc3","$id":"a692ed17-c646-4227-bbca-82ff45a59dee","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_488","$contentId":"f4e90215-82b7-44d2-9c3a-c41a8b39fbc3","$id":"7fe98e35-977b-4a20-b761-2f9fbeea5ab0","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"cf70adec-a687-4062-91a5-40551682c2b9","root":false,"$title":"Máquina parada - resolveu?","$position":{"top":"2912px","left":"5619px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d904766e-a78a-4880-a8b4-c3350ee093d2":{"$contentActions":[{"action":{"$id":"a296df27-81c1-4a6c-9530-a2574cb4eeb8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0644b301-de04-4c6b-89be-df334ccf90a5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0644b301-de04-4c6b-89be-df334ccf90a5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"3aca057e-bc2e-46ff-aaa5-f5e1f95ee17d","$typeOfContent":"text","type":"SendMessage","settings":{"id":"f50a6039-7e44-4d90-a813-706c2ee3a3a3","type":"text/plain","content":"Sabe me dizer qual o modelo da sua máquina?","metadata":{}},"$cardContent":{"document":{"id":"f50a6039-7e44-4d90-a813-706c2ee3a3a3","type":"text/plain","content":"Sabe me dizer qual o modelo da sua máquina?"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"9b41ad18-f5b1-4ce3-8304-7352f7692f55","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b2e99af2-be9b-4bd3-8457-11306fe52d05","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b2e99af2-be9b-4bd3-8457-11306fe52d05","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"2e349484-d5f1-4d1b-bab1-a1f6d19afa31","$typeOfContent":"select","type":"SendMessage","settings":{"id":"965dc1c5-3f77-4885-a87b-d20dff0f0b24","type":"application/vnd.lime.select+json","content":{"text":"Tanya\nPegaso\nPolaris\nOrion Gold\nGloria\nCalypso\n\nO modelo da sua máquina seria algum destes acima?","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Outras","previewText":"Outras","value":null,"index":1,"type":null},{"text":"Não sei","previewText":"Não sei","value":null,"index":2,"type":null}],"limitMenu":false},"metadata":{}},"$cardContent":{"document":{"id":"965dc1c5-3f77-4885-a87b-d20dff0f0b24","type":"application/vnd.lime.select+json","content":{"text":"Tanya\nPegaso\nPolaris\nOrion Gold\nGloria\nCalypso\n\nO modelo da sua máquina seria algum destes acima?","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Outras","previewText":"Outras","value":null,"index":1,"type":null},{"text":"Não sei","previewText":"Não sei","value":null,"index":2,"type":null}],"limitMenu":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"3e1fc5fa-8eea-4922-92db-6d6481050302","typeOfStateId":"state","$connId":"con_493","$contentId":"2e349484-d5f1-4d1b-bab1-a1f6d19afa31","$id":"f0ac0661-4f42-472a-bb03-372d471e41ff","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_498","$contentId":"2e349484-d5f1-4d1b-bab1-a1f6d19afa31","$id":"06de08f2-fe81-4a52-9d27-bbaac72ab864","conditions":[{"source":"input","comparison":"equals","values":["Outras"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_503","$contentId":"2e349484-d5f1-4d1b-bab1-a1f6d19afa31","$id":"868ff5b7-c5ab-4664-a387-ea0becd3e078","conditions":[{"source":"input","comparison":"equals","values":["Não sei"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Outras","Não sei"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"d904766e-a78a-4880-a8b4-c3350ee093d2","root":false,"$title":"Máquina sem pressão - modelo da máquina","$position":{"top":"2745px","left":"5867px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"3e1fc5fa-8eea-4922-92db-6d6481050302":{"$contentActions":[{"action":{"$id":"44fbbd71-fc04-446a-890c-7abe15b65483","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"996ef22a-c5eb-4fe9-97f8-5400d9314edf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"996ef22a-c5eb-4fe9-97f8-5400d9314edf","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"4c140f45-8db7-4d2f-a4c1-50851c4475ec","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a1b99f92-f88c-4b0a-a06d-a5b4ad37da72","type":"text/plain","content":"Verifique, por favor, se a chave Liga/Desliga está na posição 2 e aguarde 40 minutos🕗","metadata":{}},"$cardContent":{"document":{"id":"a1b99f92-f88c-4b0a-a06d-a5b4ad37da72","type":"text/plain","content":"Verifique, por favor, se a chave Liga/Desliga está na posição 2 e aguarde 40 minutos🕗"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"372119f0-847d-4d4a-8fdb-d67e569379d5","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"a9dcf19d-924a-4d1a-be7c-2f38509dbab4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"a9dcf19d-924a-4d1a-be7c-2f38509dbab4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"845333fd-28e3-49ac-a3b1-1faae8038aa4","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"6be202e6-92b0-4b38-bd4f-fbcd6c58b37c","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, a máquina voltou a ter pressão?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"6be202e6-92b0-4b38-bd4f-fbcd6c58b37c","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, a máquina voltou a ter pressão?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_508","$contentId":"845333fd-28e3-49ac-a3b1-1faae8038aa4","$id":"2fa5a9b6-9f8c-4153-9f4b-12676990f79c","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_513","$contentId":"845333fd-28e3-49ac-a3b1-1faae8038aa4","$id":"60f37a21-ebcf-4ef3-9ab0-ed090fd9a988","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"3e1fc5fa-8eea-4922-92db-6d6481050302","root":false,"$title":"Instruções - máquina sem pressão","$position":{"top":"2916px","left":"5865px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f58181e3-4e76-410c-85da-c5270d6cfd76":{"$contentActions":[{"action":{"$id":"12813481-9a3b-4a99-b2cc-4e305ad2292f","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fc8aa5e5-7d24-49b2-82d4-ec89f18a696a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fc8aa5e5-7d24-49b2-82d4-ec89f18a696a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"0f131628-4768-4861-9dc7-9d0d1d6bb24b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"508b9c5c-a542-42c1-b77d-cfe01900db59","type":"text/plain","content":"Neste caso, posso te ajudar tentando programar o tamanho da dose em sua máquina! \nOlha neste vídeo como é fácil:\nhttps://www.youtube.com/watch?v=92dpKI8wfkM","metadata":{}},"$cardContent":{"document":{"id":"508b9c5c-a542-42c1-b77d-cfe01900db59","type":"text/plain","content":"Neste caso, posso te ajudar tentando programar o tamanho da dose em sua máquina! \nOlha neste vídeo como é fácil:\nhttps://www.youtube.com/watch?v=92dpKI8wfkM"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"14333b48-7db0-4f8e-9265-943d4fdf864b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f36b5d46-beea-42f8-9b06-aeedf757c861","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f36b5d46-beea-42f8-9b06-aeedf757c861","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"7b1be93a-1257-48b3-babe-222bef9e4235","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"f1cc4418-6743-4260-a86e-3e5ae3f42b44","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, o tamanho da dose está conforme o esperado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"f1cc4418-6743-4260-a86e-3e5ae3f42b44","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, o tamanho da dose está conforme o esperado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"4f9449cb-b1b9-4af8-9669-b929ecd15e88","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_518","$contentId":"7b1be93a-1257-48b3-babe-222bef9e4235","$id":"9491b3e8-a60a-41cc-8fda-1124d632fe69","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_523","$contentId":"7b1be93a-1257-48b3-babe-222bef9e4235","$id":"8006293c-611a-4c9e-8d95-dc02b4b72f97","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"f58181e3-4e76-410c-85da-c5270d6cfd76","root":false,"$title":"Instruções - tamanho da dose","$position":{"top":"2757px","left":"6101px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9f2c9764-9046-4c02-8954-700896fe1fbb":{"$contentActions":[{"action":{"$id":"a86195d1-9341-486c-b506-f9ad92a7b934","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1359ff73-d95a-4e33-afcc-ba8e93a7fbdd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1359ff73-d95a-4e33-afcc-ba8e93a7fbdd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"fee8c6d0-e89f-4e24-90f6-b1b1093b11db","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"17e2a887-801d-41e7-9cf8-77e920a8d184","type":"application/vnd.lime.select+json","content":{"text":"Mas vem cá, você utiliza café Casablanca ou Doppio que são ideais para expresso?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"17e2a887-801d-41e7-9cf8-77e920a8d184","type":"application/vnd.lime.select+json","content":{"text":"Mas vem cá, você utiliza café Casablanca ou Doppio que são ideais para expresso?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"8f873bc2-0392-462b-94c4-1aae579a91df","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_528","$contentId":"fee8c6d0-e89f-4e24-90f6-b1b1093b11db","$id":"f67a8eb7-932c-4402-ba87-e6bb86dcbaef","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"e61adddd-2db4-459b-8c8d-1b1c3727d5e6","typeOfStateId":"state","$connId":"con_533","$contentId":"fee8c6d0-e89f-4e24-90f6-b1b1093b11db","$id":"ddf628c7-5d96-4d5d-a106-91045457bf15","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"9f2c9764-9046-4c02-8954-700896fe1fbb","root":false,"$title":"qual café utilizado?","$position":{"top":"2896px","left":"6340px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e61adddd-2db4-459b-8c8d-1b1c3727d5e6":{"$contentActions":[{"action":{"$id":"4e321098-d80f-4063-8a96-e924a7b8b99b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"995b9ab9-4314-4aac-8a17-75b748fd1881","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"995b9ab9-4314-4aac-8a17-75b748fd1881","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"bcf656ae-a4a5-49b7-b1f1-3ca148feec5b","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"b71b70c5-4cd1-48ec-a583-4882c1b6120d","type":"application/vnd.lime.select+json","content":{"text":"Tem interesse em caber mais sobre nossos cafés?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"b71b70c5-4cd1-48ec-a583-4882c1b6120d","type":"application/vnd.lime.select+json","content":{"text":"Tem interesse em caber mais sobre nossos cafés?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"9de6ecc1-cd60-46b4-aab6-5f517373bdc2","type":"text/plain","textContent":"User input","content":"learnMoreCoffee"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"learnMoreCoffee","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_538","$contentId":"bcf656ae-a4a5-49b7-b1f1-3ca148feec5b","$id":"2a614dd1-2611-48d5-b83f-bae53c0f93bc","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_543","$contentId":"bcf656ae-a4a5-49b7-b1f1-3ca148feec5b","$id":"02c5d108-cc88-48b5-b90c-53b3735c7c67","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"142e6733-86d0-4969-93d5-9cde0d28a26d","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - setQueue","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(input) {\n\ttry {\n\t\tconst normalizedInput = input.trim().toLowerCase();\n\n\t\tif (normalizedInput === \"sim\") {\n\t\t\treturn \"sales\";\n\t\t} else if (normalizedInput === \"não\") {\n\t\t\treturn \"technical\";\n\t\t} else {\n\t\t\treturn \"default\";\n\t\t}\n\t} catch (error) {\n\t\treturn error.message;\n\t}\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - setQueue] \"+String(err);}}","inputVariables":["learnMoreCoffee"],"outputVariable":"setQueueJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT0-4969-93d5-9cde0d28a26d","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{setQueueJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"setQueueJs"}],"$invalid":false},{"$id":"c8991fba-373b-43a2-a184-6837376d76ff","$typeOfContent":"","type":"MergeContact","$title":"Set contact - setQueue","$invalid":false,"settings":{"extras":{"queue":"{{setQueueJs}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"e61adddd-2db4-459b-8c8d-1b1c3727d5e6","root":false,"$title":"saber mais sobre cafés?","$position":{"top":"3058px","left":"6334px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"b33f98e0-e6fa-4d2c-af67-408963ab5b4a":{"$contentActions":[{"action":{"$id":"8bafedac-8964-4583-9637-6db1b26e7b56","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"238e3ced-5880-4cfc-af2e-f02a89be9005","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"238e3ced-5880-4cfc-af2e-f02a89be9005","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"e1d780bd-e257-4a10-b659-feeb68160ab5","$typeOfContent":"text","type":"SendMessage","settings":{"id":"ce7bb752-8a1d-48ea-ada1-3ea30c31ee62","type":"text/plain","content":"Verifique se a mangueira de fornecimento de água está dobrada e se há pressão no fornecimento da máquina","metadata":{}},"$cardContent":{"document":{"id":"ce7bb752-8a1d-48ea-ada1-3ea30c31ee62","type":"text/plain","content":"Verifique se a mangueira de fornecimento de água está dobrada e se há pressão no fornecimento da máquina"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"19434559-bea9-46de-a776-0bb37ad92097","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"1acb4e5e-7f6d-429a-87f5-9f073941af67","typeOfStateId":"state","$connId":"con_548","$id":"92ff8809-5909-4adc-9c9c-9d98eff0dd66","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"b33f98e0-e6fa-4d2c-af67-408963ab5b4a","root":false,"$title":"instruções - máquina com barulho","$position":{"top":"2727px","left":"6583px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"1acb4e5e-7f6d-429a-87f5-9f073941af67":{"$contentActions":[{"action":{"$id":"1605a71c-2147-4f5b-ab54-f9f3f856c5e0","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"9c158f4d-adda-4502-99f7-7f7eac7191c9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"9c158f4d-adda-4502-99f7-7f7eac7191c9","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"529d6240-5327-4fb4-aa45-2adbc644bc89","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"e7e90203-284e-4122-864b-fda067e39ec4","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, o ruído ainda persiste?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"e7e90203-284e-4122-864b-fda067e39ec4","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, o ruído ainda persiste?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"14797a19-1a3e-4427-88e4-03d48ca170d5","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_553","$contentId":"529d6240-5327-4fb4-aa45-2adbc644bc89","$id":"ce17cfa1-8625-45fe-8139-84653004782f","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_558","$contentId":"529d6240-5327-4fb4-aa45-2adbc644bc89","$id":"eeee430a-cb2f-4777-be4b-a227ac560c38","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"1acb4e5e-7f6d-429a-87f5-9f073941af67","root":false,"$title":"o ruído persiste?","$position":{"top":"2894px","left":"6603px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f8da78e1-774a-4523-a463-b682aabdc827":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"a43d9386-a3c0-4b5f-8ebd-52a9da84a63d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"251bb932-87dd-47df-af40-4fa76d608002","typeOfStateId":"state","$connId":"con_563","$id":"452ba730-e3b2-4700-8cea-5e8e1773a503","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"f8da78e1-774a-4523-a463-b682aabdc827","root":false,"$title":"instruções de limpeza - vaporizador","$position":{"top":"2711px","left":"6849px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"251bb932-87dd-47df-af40-4fa76d608002":{"$contentActions":[{"action":{"$id":"71f4a008-35d8-4daa-8331-16580ec4acb8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"ce10b84a-6d95-48da-a91c-8ed2edda1c9f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"ce10b84a-6d95-48da-a91c-8ed2edda1c9f","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"688d5797-50b8-4309-b75e-42c2a62409c1","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"e1391d13-1aae-4fb5-8021-37ec1a7bd422","type":"application/vnd.lime.select+json","content":{"text":"O funcionamento está adequado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"e1391d13-1aae-4fb5-8021-37ec1a7bd422","type":"application/vnd.lime.select+json","content":{"text":"O funcionamento está adequado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"35a9ca1b-88eb-4706-b98d-3a7ba82f1ac5","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_568","$contentId":"688d5797-50b8-4309-b75e-42c2a62409c1","$id":"06ff7a41-bf34-4d90-a1da-f1e39951bf0e","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_573","$contentId":"688d5797-50b8-4309-b75e-42c2a62409c1","$id":"c6eb4f5c-973f-431e-8abd-57aa87633769","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"251bb932-87dd-47df-af40-4fa76d608002","root":false,"$title":"Problema resolvido? - Vaporizador","$position":{"top":"2888px","left":"6857px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"0f0833df-2b9c-4764-8624-65d6af34a3c0":{"$contentActions":[{"action":{"$id":"b052e200-ac05-44f2-bd8d-3ca4898c6d0d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"39b13d1c-f05d-461c-b9cc-bd52b99579f5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"39b13d1c-f05d-461c-b9cc-bd52b99579f5","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"55478af4-5980-44b8-926a-7670f995e466","$typeOfContent":"text","type":"SendMessage","settings":{"id":"932b4dbc-14ef-4c72-be16-04f045dd0302","type":"text/plain","content":"Alguns motivos podem estar ocasionando isto. \nVeja o vídeo a seguir:\nhttps://www.youtube.com/watch?v=STR0iHHJ-nQ","metadata":{}},"$cardContent":{"document":{"id":"932b4dbc-14ef-4c72-be16-04f045dd0302","type":"text/plain","content":"Alguns motivos podem estar ocasionando isto. \nVeja o vídeo a seguir:\nhttps://www.youtube.com/watch?v=STR0iHHJ-nQ"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"90bf7935-0243-4118-949c-59bcbbebd27e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"ec751d6c-b6ca-4218-84d3-feb7706d2ffb","typeOfStateId":"state","$connId":"con_578","$id":"8f5c901d-67aa-4dda-babb-59911496a5e5","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"0f0833df-2b9c-4764-8624-65d6af34a3c0","root":false,"$title":"Instruções - Não sai água ","$position":{"top":"2695px","left":"7146px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ec751d6c-b6ca-4218-84d3-feb7706d2ffb":{"$contentActions":[{"action":{"$id":"a8723134-9d7d-4941-a176-66228cb37fef","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1a853d0b-7867-4ae6-aff3-a8b62ddb8776","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1a853d0b-7867-4ae6-aff3-a8b62ddb8776","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"58c3126c-0005-4402-bfcd-feaba5a8a4c3","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"56aba537-f1ec-4d87-9b44-55db24101144","type":"application/vnd.lime.select+json","content":{"text":"Era algum destes motivos?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"56aba537-f1ec-4d87-9b44-55db24101144","type":"application/vnd.lime.select+json","content":{"text":"Era algum destes motivos?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"8bb17d3a-f94f-4f5b-a344-1cd9d8356908","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_583","$contentId":"58c3126c-0005-4402-bfcd-feaba5a8a4c3","$id":"2f4c8aec-caf9-4491-94ec-bb580ad682f0","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"784530d7-16d2-491a-b614-c3ab3538d37e","typeOfStateId":"state","$connId":"con_588","$contentId":"58c3126c-0005-4402-bfcd-feaba5a8a4c3","$id":"0fbee728-2a2d-429e-a194-ff40816e302b","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"ec751d6c-b6ca-4218-84d3-feb7706d2ffb","root":false,"$title":"Problema resolvido? - Não sai água","$position":{"top":"2864px","left":"7129px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"784530d7-16d2-491a-b614-c3ab3538d37e":{"$contentActions":[{"action":{"$id":"8e360da1-a499-4447-88f4-6dcaaca3a964","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f57e8616-7fb5-487f-8b6f-0c32601a76dd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f57e8616-7fb5-487f-8b6f-0c32601a76dd","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"86a5c5b9-5e3b-4d54-a9c4-6d9f67a9f018","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a971fa09-32f8-45b3-8939-9250724c7dd3","type":"text/plain","content":"Retire o porta filtro e acione o botão para extração manual","metadata":{}},"$cardContent":{"document":{"id":"a971fa09-32f8-45b3-8939-9250724c7dd3","type":"text/plain","content":"Retire o porta filtro e acione o botão para extração manual"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"481f444a-9a54-4382-ad08-1babcd16de5d","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"88805411-1e44-45fe-82b9-cb67c94b0855","typeOfStateId":"state","$connId":"con_593","$id":"b1434896-e84e-4a8b-ba4f-0546ea612d36","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"784530d7-16d2-491a-b614-c3ab3538d37e","root":false,"$title":"instruções 2 - não sai água","$position":{"top":"3057px","left":"7137px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"88805411-1e44-45fe-82b9-cb67c94b0855":{"$contentActions":[{"action":{"$id":"43ec4688-5db7-4b29-a2de-3b86e9a4e071","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0e7ba418-314f-403d-a396-c863193c1569","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0e7ba418-314f-403d-a396-c863193c1569","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"2ed950ad-4302-4836-ba5a-53692a95bb9f","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"778c7abb-2d84-4dc3-92ff-af9b31f6a902","type":"application/vnd.lime.select+json","content":{"text":"A água está fluindo normalmente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"778c7abb-2d84-4dc3-92ff-af9b31f6a902","type":"application/vnd.lime.select+json","content":{"text":"A água está fluindo normalmente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"451ec5f7-6207-461b-8f1a-b174dc80bc2a","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"9949cfee-4458-4940-90ba-a62d7aaae973","typeOfStateId":"state","$connId":"con_598","$contentId":"2ed950ad-4302-4836-ba5a-53692a95bb9f","$id":"80734200-5ef2-4b61-ad9f-08decac6a1c0","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_603","$contentId":"2ed950ad-4302-4836-ba5a-53692a95bb9f","$id":"1ed251b0-76f2-4016-bd65-2f23f65f297f","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"88805411-1e44-45fe-82b9-cb67c94b0855","root":false,"$title":"A água flui normalmente?","$position":{"top":"3229px","left":"7139px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9949cfee-4458-4940-90ba-a62d7aaae973":{"$contentActions":[{"action":{"$id":"4e9f30cb-8b60-49a6-8334-30aa89937273","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c8690137-9fec-411f-b97b-a0c8bbb7f8a1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c8690137-9fec-411f-b97b-a0c8bbb7f8a1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"3a091615-0cd1-4925-a172-b89920b7e127","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3bba96df-9198-4880-8eed-9987ea0321e4","type":"text/plain","content":"Isso pode significar que o café moído esta muito fino.\nVocê sabe regular o moinho? \n\nSegue um vídeo onde nosso time explica como se faz:\nhttps://www.youtube.com/watch?v=SS8cUuVupUQ","metadata":{}},"$cardContent":{"document":{"id":"3bba96df-9198-4880-8eed-9987ea0321e4","type":"text/plain","content":"Isso pode significar que o café moído esta muito fino.\nVocê sabe regular o moinho? \n\nSegue um vídeo onde nosso time explica como se faz:\nhttps://www.youtube.com/watch?v=SS8cUuVupUQ"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"709add9e-4e4b-45a8-bacd-67e5e800dcc9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fe2d5bb0-a460-4a19-88c2-64308270ebcf","typeOfStateId":"state","$connId":"con_608","$id":"87fad9f4-56dd-43be-81f0-75e9b8611b91","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"9949cfee-4458-4940-90ba-a62d7aaae973","root":false,"$title":"intruções 3 - não sai água","$position":{"top":"3400px","left":"7145px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"fe2d5bb0-a460-4a19-88c2-64308270ebcf":{"$contentActions":[{"action":{"$id":"c45cc921-28b0-4354-85eb-1ec0f2b69d9e","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"b9d230ce-ca8b-4aee-a23a-21a76ee62e0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"b9d230ce-ca8b-4aee-a23a-21a76ee62e0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"927f3150-dba0-4cd3-8226-4a0eb9b88884","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"564f6c77-568e-4f7c-a293-c11a6529496b","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, seguindo as orientações, o café passa a sair normalmente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"564f6c77-568e-4f7c-a293-c11a6529496b","type":"application/vnd.lime.select+json","content":{"text":"Depois me conta, seguindo as orientações, o café passa a sair normalmente?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0890e86d-4d7b-4a67-ba7f-f68bddc41bdc","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_613","$contentId":"927f3150-dba0-4cd3-8226-4a0eb9b88884","$id":"5b70bdcc-b74d-4da2-94fa-9b35dbce62e7","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_618","$contentId":"927f3150-dba0-4cd3-8226-4a0eb9b88884","$id":"5e5662e5-d51c-4bfd-b1b5-4de70b7443d4","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"fe2d5bb0-a460-4a19-88c2-64308270ebcf","root":false,"$title":"Problema resolvido? 2 - não sai água","$position":{"top":"3538px","left":"7151px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"daa81d93-3e00-450c-b45f-ae4c08e7f918":{"$contentActions":[{"action":{"$id":"0d64d33a-0c80-40dd-99e9-e5e1435e1f04","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"2ed24962-0600-405f-af7a-b056276fdddc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"2ed24962-0600-405f-af7a-b056276fdddc","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"bbe6d1ce-2d03-4639-9be7-29382e725861","$typeOfContent":"text","type":"SendMessage","settings":{"id":"80dbe1c0-d34a-4985-b95b-9a42237abe35","type":"text/plain","content":"Neste caso, preciso que você verifique se a mangueira de fornecimento de água está dobrada e se há pressão no fornecimento da máquina\n","metadata":{}},"$cardContent":{"document":{"id":"80dbe1c0-d34a-4985-b95b-9a42237abe35","type":"text/plain","content":"Neste caso, preciso que você verifique se a mangueira de fornecimento de água está dobrada e se há pressão no fornecimento da máquina\n"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"08e6952b-49a1-48f5-b777-474a838f3ab5","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"4b6fc3c4-8cf1-4aa8-8331-4ba300ae03b2","typeOfStateId":"state","$connId":"con_623","$id":"3941b56c-05a9-4761-8b42-a2ef5d0b0af6","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"daa81d93-3e00-450c-b45f-ae4c08e7f918","root":false,"$title":"instruções - led piscando","$position":{"top":"2687px","left":"7444px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"4b6fc3c4-8cf1-4aa8-8331-4ba300ae03b2":{"$contentActions":[{"action":{"$id":"a31f6182-606c-472e-8e51-133cf606b3c2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"db8bcb5f-1f00-45e3-8571-e8cfaab44687","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"db8bcb5f-1f00-45e3-8571-e8cfaab44687","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"97ba4fd8-aeb8-477a-b211-e0a574804375","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"50898eda-7c3d-4ace-9b54-46c0ae249a73","type":"application/vnd.lime.select+json","content":{"text":"O LED ainda está piscando?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"50898eda-7c3d-4ace-9b54-46c0ae249a73","type":"application/vnd.lime.select+json","content":{"text":"O LED ainda está piscando?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"847a463a-f904-4156-b9d2-c319b8626146","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_628","$contentId":"97ba4fd8-aeb8-477a-b211-e0a574804375","$id":"04393ade-56fa-41ef-809e-b84d8443dfb3","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_633","$contentId":"97ba4fd8-aeb8-477a-b211-e0a574804375","$id":"d810c7f6-1408-4df5-a6c1-8452348b4a7d","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"4b6fc3c4-8cf1-4aa8-8331-4ba300ae03b2","root":false,"$title":"O led ainda pisca?","$position":{"top":"2853px","left":"7444px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d1350968-64f3-4129-ab40-9e28ad670cf3":{"$contentActions":[{"action":{"$id":"93fc16f6-a117-471e-9e33-3739957fa00d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1384917f-5235-49a0-8b11-0141382395a1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1384917f-5235-49a0-8b11-0141382395a1","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"0cc84f34-8390-4344-98e6-513e73a96940","$typeOfContent":"text","type":"SendMessage","settings":{"id":"3f549cef-8625-4963-83d4-b2f7fdd829c1","type":"text/plain","content":"Por favor, verique se as extremidades das mangueiras de fornecimento estão corretamente imersas nas soluções e se ainda há soluções nos recipientes","metadata":{}},"$cardContent":{"document":{"id":"3f549cef-8625-4963-83d4-b2f7fdd829c1","type":"text/plain","content":"Por favor, verique se as extremidades das mangueiras de fornecimento estão corretamente imersas nas soluções e se ainda há soluções nos recipientes"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f9e9d550-5e18-4a03-833d-d3441e8238d9","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"c08cd457-7548-40d0-8841-f74a4595f759","typeOfStateId":"state","$connId":"con_638","$id":"8e7c3d6a-20d5-497c-8df4-a994d5664c47","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"d1350968-64f3-4129-ab40-9e28ad670cf3","root":false,"$title":"instruções - não consome secante/detergente","$position":{"top":"2728px","left":"4198px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"c08cd457-7548-40d0-8841-f74a4595f759":{"$contentActions":[{"action":{"$id":"39abbb93-c2ec-4a45-a84a-7b2a8a803e95","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"6622ae10-435c-4ff0-bd50-21a016f25e0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"6622ae10-435c-4ff0-bd50-21a016f25e0e","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"7b4104a5-4019-4631-9457-74b2b8fbfd78","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"d1c70942-92ba-4fb8-8fb6-a8aa73a414f4","type":"application/vnd.lime.select+json","content":{"text":"O funcionamento normalizado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"d1c70942-92ba-4fb8-8fb6-a8aa73a414f4","type":"application/vnd.lime.select+json","content":{"text":"O funcionamento normalizado?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"3aef477c-84fc-4b3f-ba91-5223113128fc","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_643","$contentId":"7b4104a5-4019-4631-9457-74b2b8fbfd78","$id":"78ef73e7-27e9-4c2a-8b2b-8405878cfcd7","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_648","$contentId":"7b4104a5-4019-4631-9457-74b2b8fbfd78","$id":"5ba8e42f-92d6-4297-90bf-8cef9cd5013f","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"c08cd457-7548-40d0-8841-f74a4595f759","root":false,"$title":"problema resolvido?  - máquina de lavar","$position":{"top":"2983px","left":"4226px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8baf118f-c00b-406f-97cf-75f32c3b4568":{"$contentActions":[{"action":{"$id":"0b1a242d-e46a-4d21-ba2e-362da3db15a2","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"58228419-9737-4262-be87-51a5221ca5d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"58228419-9737-4262-be87-51a5221ca5d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"d78ee25d-d44b-466b-8e3a-2907edd06d8a","$typeOfContent":"text","type":"SendMessage","settings":{"id":"7e38fb2b-a33f-4ac3-b921-617978b472b4","type":"text/plain","content":"Por favor, verifique se a água está escoando pelo dreno de saída","metadata":{}},"$cardContent":{"document":{"id":"7e38fb2b-a33f-4ac3-b921-617978b472b4","type":"text/plain","content":"Por favor, verifique se a água está escoando pelo dreno de saída"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"c37eec6b-9b55-4825-a6e5-3334ed4e533b","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"ed529874-d63f-44ca-a19d-c6241acf6759","typeOfStateId":"state","$connId":"con_653","$id":"9553fbae-48fc-42e0-a161-4dbe87d2b891","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"8baf118f-c00b-406f-97cf-75f32c3b4568","root":false,"$title":"instruções - máquina vazando - máquina de lavar","$position":{"top":"2923px","left":"3846px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"ed529874-d63f-44ca-a19d-c6241acf6759":{"$contentActions":[{"action":{"$id":"6f0a3133-dfd1-4f63-ba58-c93a2934dc4b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8a0084a0-f3a3-4032-8c97-0046c0fa18c0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8a0084a0-f3a3-4032-8c97-0046c0fa18c0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"1986eea9-4ed2-4e45-a3d9-39eca41740c8","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"0f8072ff-5c69-4ae8-936e-6f773088309d","type":"application/vnd.lime.select+json","content":{"text":"A água sai pelo dreno?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"0f8072ff-5c69-4ae8-936e-6f773088309d","type":"application/vnd.lime.select+json","content":{"text":"A água sai pelo dreno?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0cdb165a-af73-4557-8260-1e566562b5ff","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_658","$contentId":"1986eea9-4ed2-4e45-a3d9-39eca41740c8","$id":"e74aaa2e-f121-4dc5-9f5a-54fb28f6cdd7","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_663","$contentId":"1986eea9-4ed2-4e45-a3d9-39eca41740c8","$id":"4a111fa2-e838-4508-a005-95c6298ca20b","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"ed529874-d63f-44ca-a19d-c6241acf6759","root":false,"$title":"Problema resolvido? - vazamento - máquina de lavar","$position":{"top":"3091px","left":"3852px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"7d5f66a9-7bb5-42bf-ad2b-00ca0521ac43":{"$contentActions":[{"action":{"$id":"47d5c900-3b3c-4bc5-8557-13d69553a19d","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"255d29df-1d14-44c9-8e33-537ab9b19cee","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"255d29df-1d14-44c9-8e33-537ab9b19cee","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"e8005cf8-2278-40fb-918a-c77c0e21b148","$typeOfContent":"text","type":"SendMessage","settings":{"id":"1b783c11-1b10-4461-bb9d-5390a6621e66","type":"text/plain","content":"Isso significa que o dreno de saída está entupido🤔\nPreciso que faça o seguinte:","metadata":{}},"$cardContent":{"document":{"id":"1b783c11-1b10-4461-bb9d-5390a6621e66","type":"text/plain","content":"Isso significa que o dreno de saída está entupido🤔\nPreciso que faça o seguinte:"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"637fe16e-05b8-42af-9aa3-bd8ddc0c5b74","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f91309b7-9d4e-4bc2-994a-92915a29fc02","typeOfStateId":"state","$connId":"con_668","$id":"0289c91d-d629-44a7-9378-c5d65269310b","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"7d5f66a9-7bb5-42bf-ad2b-00ca0521ac43","root":false,"$title":"instruções 2 - máquina vazando","$position":{"top":"3312px","left":"3849px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"f91309b7-9d4e-4bc2-994a-92915a29fc02":{"$contentActions":[{"action":{"$id":"6f0a3133-dfd1-4f63-ba58-c93a2934dc4b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"8a0084a0-f3a3-4032-8c97-0046c0fa18c0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"8a0084a0-f3a3-4032-8c97-0046c0fa18c0","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"1986eea9-4ed2-4e45-a3d9-39eca41740c8","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"0f8072ff-5c69-4ae8-936e-6f773088309d","type":"application/vnd.lime.select+json","content":{"text":"O vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"0f8072ff-5c69-4ae8-936e-6f773088309d","type":"application/vnd.lime.select+json","content":{"text":"O vazamento continua?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0cdb165a-af73-4557-8260-1e566562b5ff","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_673","$id":"3dd5d2ab-0ccc-46d1-95ab-ba5fc72062db","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_678","$id":"8d17450c-7a4d-451e-b173-702e3477248a","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"f91309b7-9d4e-4bc2-994a-92915a29fc02","root":false,"$title":"Problema resolvido? 2 - vazamento - maq. de lavar","$position":{"top":"3460px","left":"3858px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"e529d953-0510-4193-9638-ccf615e6fd92":{"$contentActions":[{"action":{"$id":"83042f6f-f601-4337-89a2-8079fd256a8a","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"66d1c924-6eea-4e4f-a613-5662b068d45c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"66d1c924-6eea-4e4f-a613-5662b068d45c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"880990ee-6b52-4c6d-aa7d-e56f9af6c65e","$typeOfContent":"text","type":"SendMessage","settings":{"id":"0c8e51dd-3315-407a-9aa1-86456938428d","type":"text/plain","content":"Por favor, verifique se a rede de alimentação está de acordo com as especificações da instalação e se está funcionando adequadamente","metadata":{}},"$cardContent":{"document":{"id":"0c8e51dd-3315-407a-9aa1-86456938428d","type":"text/plain","content":"Por favor, verifique se a rede de alimentação está de acordo com as especificações da instalação e se está funcionando adequadamente"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"6e22df6c-0276-4e56-a6db-9b58b43f19fa","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"79a013c3-a84b-4dbe-93eb-d4dbc0fcc717","typeOfStateId":"state","$connId":"con_683","$id":"5b446bcc-864d-4293-b7ef-bde9cc71c874","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"e529d953-0510-4193-9638-ccf615e6fd92","root":false,"$title":"instruções - máquina parada","$position":{"top":"2777px","left":"3590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"79a013c3-a84b-4dbe-93eb-d4dbc0fcc717":{"$contentActions":[{"action":{"$id":"1a41cf2d-00f8-4dfa-a1eb-4917e17b951b","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"f5a9d0d5-f6c6-4352-8e47-a8d252f8ef13","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"f5a9d0d5-f6c6-4352-8e47-a8d252f8ef13","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"cebfed8f-1863-4b0c-a7e4-f90d720a1425","$typeOfContent":"select-immediate","type":"SendMessage","settings":{"id":"a59503b2-0937-4f73-96c8-76a2e63be657","type":"application/vnd.lime.select+json","content":{"text":"A Máquina voltou a funcionar?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false},"metadata":{}},"$cardContent":{"document":{"id":"a59503b2-0937-4f73-96c8-76a2e63be657","type":"application/vnd.lime.select+json","content":{"text":"A Máquina voltou a funcionar?","scope":"immediate","options":[{"text":"Sim","previewText":"Sim","value":null,"index":0,"type":null},{"text":"Não","previewText":"Não","value":null,"index":1,"type":null}],"quikReply":false}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"be9587d2-42d3-47d7-9e0e-5ea512a58540","type":"text/plain","textContent":"User input","content":"User input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"f7c5d6c3-ccfd-4d07-ac89-836130f66f93","typeOfStateId":"state","$connId":"con_688","$contentId":"cebfed8f-1863-4b0c-a7e4-f90d720a1425","$id":"78cf6f6f-fb7c-4228-afd5-b58c11d004a9","conditions":[{"source":"input","comparison":"equals","values":["Sim"]}],"$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_693","$contentId":"cebfed8f-1863-4b0c-a7e4-f90d720a1425","$id":"c5207368-2fc9-4df8-ab14-36f3b6959538","conditions":[{"source":"input","comparison":"equals","values":["Não"]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":["Sim","Não"],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"79a013c3-a84b-4dbe-93eb-d4dbc0fcc717","root":false,"$title":"problema resolvido? - máquina parada","$position":{"top":"2970px","left":"3590px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"dwnttags-9f2e-4d19-a96b-ec0d35ed339e":{"id":"dwnttags-9f2e-4d19-a96b-ec0d35ed339e","$title":"DWNT Tags","$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"DWNTaba5-bae9-4aed-81e3-2c53bf6e02f0","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Desabilita checkpoints nesse bloco","settings":{"function":"run","source":"function run(DWNT, stateId) {\n\ttry {\n\t\tDWNT = JSON.parse(DWNT || '');\n\t\tDWNT.disableCheckpoints = true;\n\t} catch(err) {\n        DWNT = { err: String(err) };\n    }\n\treturn JSON.stringify(DWNT);\n}","inputVariables":["DWNT"],"outputVariable":"DWNT","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false}],"$leavingCustomActions":[{"$id":"DWNT5eb1-4614-40a1-b156-b10ca3cc647c","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Adiciona checkpoint","settings":{"function":"run","source":"function run(DWNT, stateId) {\n\ttry {\n\t\tDWNT = JSON.parse(DWNT || '');\n\t\tDWNT.checkpoints = Array.from(DWNT.checkpoints || [])\n\t\tconst checkpoint = {\n\t\t\t\"state\": stateId, \n\t\t\t\"bot\": DWNT.application[\"bot\"], \n\t\t\t\"service\": DWNT.application[\"service\"]\n\t\t};\n\t\tconst index = DWNT.checkpoints.findIndex(cp => {\n\t\t\treturn cp.state == checkpoint.state && cp.bot == checkpoint.bot;\n\t\t});\n\n\t\t// Loops\n\t\tif (index >= 0) {\n\t\t\tDWNT.checkpoints.splice(0, index);\n\t\t} else {\n\t\t\tDWNT.checkpoints.unshift(checkpoint);\n\t\t}\n\n\t\tDWNT.hasCheckpoints = DWNT.checkpoints.length > 0 || undefined;\n\t\t\n\t} catch(err) {\n        DWNT = { err: String(err) };\n    }\n\treturn JSON.stringify(DWNT);\n}","inputVariables":["DWNT","state.id"],"outputVariable":"DWNT","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"$tags":[{"background":"#1060FD","label":"Main Bot","id":"DWNT9c38-c025-4181-9bbd-966ff8ff9bb0","canChangeBackground":false},{"background":"#004643","label":"Inatividade customizada","id":"DWNT0f84-3722-47eb-8250-3845d1af6d86","canChangeBackground":false},{"background":"#004643","label":"Erro customizado","id":"DWNTaf43-f10b-470d-be3e-58b6fa87c39a","canChangeBackground":false},{"background":"#004643","label":"Sair customizado","id":"DWNTc64b-0e60-4e99-b7ce-dd18f991f199","canChangeBackground":false},{"background":"#FF1E90","label":"Checkpoint","id":"DWNT9da7-ffa4-47c8-8487-6295b8f01d32","canChangeBackground":false},{"background":"#004643","label":"Voltar Customizado","id":"DWNT7030-3296-4370-829d-f428641750e4","canChangeBackground":false},{"background":"#F90300","label":"Erro Definido","id":"DWNT1d75-ce98-44e3-bf61-64c9a764ebb9","canChangeBackground":false},{"background":"#8F3985","label":"Intenções Definidas","id":"DWNT1d75-ce98-44e3-bf61-64c9a764ebb9","canChangeBackground":false},{"background":"#004643","label":"Retorno Ativo","id":"DWNT7a82-cfa6-4f64-acae-0ed4e6209764","canChangeBackground":false},{"background":"#004643","label":"Click to WhatsApp","id":"DWNT105d-9d5e-4200-a52e-3a1a95dcb670","canChangeBackground":false},{"background":"#5bc0eb","label":"Redirect","id":"DWNT0d25-28a5-43f4-b509-3306608554fa","canChangeBackground":false},{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"$position":{"top":"10000px","left":"10000px"},"root":false,"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"DWNT2ed1-aada-425e-a805-2558a70a1dbf":{"$contentActions":[{"action":{"$id":"4d8fb2e1-6c5f-49eb-b428-a913c4dd41f7","$typeOfContent":"text","type":"SendMessage","settings":{"id":"55911c1f-24bb-4371-840c-cb6d5a531074","type":"text/plain","content":"{{message}}","metadata":{}},"$cardContent":{"document":{"id":"55911c1f-24bb-4371-840c-cb6d5a531074","type":"text/plain","content":"{{message}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@ENABLED"},{"values":[],"source":"context","comparison":"notExists","variable":"commands@GOTO"},{"values":[],"source":"context","comparison":"notExists","variable":"commands@REDIRECT"}],"$cardContent":{"document":{"id":"0273a986-94ed-4b60-89f8-7ccb83b366c5","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right"},"expiration":"01:00","$invalid":false},"$invalid":false},{"action":{"$id":"4bbab46e-9d25-4393-bfa1-1cc73d96fcf7","$typeOfContent":"text","type":"SendMessage","conditions":[{"values":[],"source":"input","comparison":"notExists"}],"settings":{"id":"663d9e86-942f-4250-984f-04e68a5350c3","type":"text/plain","content":"Timeout exceeded. Redirecting to onboarding.","metadata":{"#stateName":"{{state.name}}","#stateId":"{{state.id}}","#messageId":"{{input.message@id}}","#previousStateId":"{{state.previous.id}}","#previousStateName":"{{state.previous.name}}"}},"$cardContent":{"document":{"id":"663d9e86-942f-4250-984f-04e68a5350c3","type":"text/plain","content":"Timeout exceeded. Redirecting to onboarding."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false}],"$conditionOutputs":[{"stateId":"DWNT2ed1-aada-425e-a805-2558a70a1dbf","typeOfStateId":"state","$id":"46940940-dd0b-40d9-9012-4d61abda10fe","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"commands@GOTO"},{"values":[],"comparison":"exists","source":"context","variable":"commands@ENABLED"},{"values":[],"source":"context","comparison":"notExists","variable":"commands@GOTO"}],"$connId":"con_698","$invalid":false},{"stateId":"{{commands@GOTO.data}}","typeOfStateId":"variable","$id":"1893834e-7be2-4dc1-b90c-0067eb452b1a","conditions":[{"source":"input","comparison":"exists","values":[],"variable":"commands@GOTO"},{"values":[],"source":"context","comparison":"exists","variable":"commands@GOTO"},{"values":[],"source":"context","comparison":"exists","variable":"commands@GOTO.data"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"d24db3ee-0962-4622-a775-52666ed001eb","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands","settings":{"function":"run","source":"\nfunction getContactData(contactId, contactData) {\n    let payload = {}\n    try {\n        payload = JSON.parse(contactData);\n    } catch (err) {}\n    payload[\"identity\"] = contactId;\n    return payload;\n}\n\nconst HELP_MESSAGE = `Commands:\n\n🔹 goto {block_id}: jump to block block_id.\n➡️ Example: <b>goto onboarding</b>\n\n🔹 redirect {service_name}: redirect to service service_name.\n➡️ Example: <b>redirect main</b>\n\n🔹 print {type}[contact | context | services]: print contact, context or services.\n➡️ Example: <b>print contact; print context; print services</b>\n<b>Print service caveats:</b>\nContext size can lead to reduced responses, thus you can use take and skip parameters\n➡️ Example: <b>print context {skip} {take}</b>\n\n🔹 set {type}[contact | context] {key} {value}: set key to value on contact or context. \n➡️ Example: <b>set context a 1</b>\n<b>Set contact caveats:</b>\nWhen key is json defined the command will produce a set contact but the value <b>must be JSON string</b>\n➡️ Example: <b>set contact {\"name\":\"test\"}</b>\nWhen key is a contact property the command will produce a merge contact. \n➡️ Example: <b>set contact name test; set contact extras.key 1</b>\n\n🔹 get {type}[context] {key}: get variavble key from context.\n➡️ Example: <b>get context a</b>\n\n🔹 merge {type}[contact] json {value}: merge value on contact. Value <b>must be JSON string</b>\n➡️ Example: <b>merge contact json {\"name\":\"test\"}</b>\n\n🔹 delete {type}[context] {key}: delete key on context. \n➡️ Example: <b>delete context a</b>\n`;\n\nfunction decodeCommand(command, context) {\n    const cmd = { \n        definition: command.join(\" \"),\n        args: command,\n        id: null,\n        data: null,\n        priority: 0,\n        message: null\n    };\n\n    let type = String(command[0]).toUpperCase();\n    let subtype = String(command[1] || \"\").toUpperCase();\n    let key = String(command[2] || \"\");\n    let value = String(command[3] || \"\");\n\n    let data = {};\n    const identity = context[\"identity\"];\n\n    switch(type) {\n        case \"#DEBUG\":\n            cmd[\"id\"] = \"DEBUG\";\n            cmd[\"data\"] = command[1];\n            break;\n        case \"SET\":\n            if (subtype == \"CONTACT\") {\n                cmd[\"id\"] = \"MERGE_CONTACT\";\n                if (key.toUpperCase() == \"JSON\") {\n                    cmd[\"id\"] = \"SET_CONTACT\";\n                    data = getContactData(identity, value);\n                } else if (key.startsWith(\"extras.\")) {\n                    const subkey = key.split(\"extras.\")[1];\n                    data = {extras: {}};\n                    data[\"extras\"][subkey] = value;\n                } else {\n                    data[key] = value;\n                }\n                data[\"identity\"] = identity;\n                cmd[\"data\"] = data;\n            } else if (subtype == \"CONTEXT\") {\n                cmd[\"id\"] = \"SET_CONTEXT\";\n                cmd[\"data\"] = { \"identity\": identity, \"key\": key, \"value\": value };\n            }\n            cmd[\"priority\"] = 1;\n            break;\n        case \"GET\":\n            if (subtype == \"CONTEXT\") {\n                cmd[\"id\"] = \"GET_CONTEXT\";\n                cmd[\"data\"] = { \"identity\": identity, \"key\": key };\n            }\n            cmd[\"priority\"] = 2;\n            break;\n        case \"MERGE\":\n            if (subtype == \"CONTACT\" && key.toUpperCase() == \"JSON\") {\n                cmd[\"id\"] = \"MERGE_CONTACT\";\n                data = getContactData(identity, value);\n                cmd[\"data\"] = data;\n            }\n            cmd[\"priority\"] = 3;\n            break;\n        case \"DELETE\":\n            if (subtype == \"CONTEXT\") {\n                cmd[\"id\"] = \"DELETE_CONTEXT\";\n                cmd[\"data\"] = { \"identity\": identity, \"key\": key };\n            } \n            cmd[\"priority\"] = 4;\n            break;\n        case \"HELP\":\n            cmd[\"id\"] = \"HELP\";\n            cmd[\"message\"] = HELP_MESSAGE;\n            cmd[\"priority\"] = 5;\n            break;\n        case \"PRINT\":\n            if (subtype == \"CONTEXT\") {\n                cmd[\"id\"] = \"PRINT_CONTEXT\";\n                cmd[\"data\"] = {\"take\": key || 200, \"skip\": value || 0 };\n            } else if (subtype == \"CONTACT\") {\n                cmd[\"id\"] = \"PRINT_CONTACT\";\n            } else if (subtype == \"SERVICES\") {\n                cmd[\"id\"] = \"PRINT_SERVICES\";\n            }\n            cmd[\"priority\"] = 6;\n            break;\n        case \"REDIRECT\":\n            cmd[\"id\"] = \"REDIRECT\";\n            cmd[\"data\"] = command[1];\n            cmd[\"priority\"] = 7;\n            break;\n        case \"GOTO\":\n            cmd[\"id\"] = \"GOTO\";\n            cmd[\"data\"] = command[1];\n            cmd[\"message\"] = `🔁 Jumping to block ${cmd[\"data\"]}`;\n            cmd[\"priority\"] = 8;\n            break;\n        case \"CLOSE\":\n            cmd[\"id\"] = \"CLOSE\";\n            break; \n    }\n\n    return cmd;\n}\n\nfunction decodeArgs(command) {\n    const [command, json] = command.split(/[\\t ]+json[\\t ]+/i);\n    const args = command.split(/[\\t ]+/);\n    if (json) {\n        args.push(\"json\", json);\n    }\n    return args\n        .map(chunk => chunk.trim())\n        .filter(chunk => chunk.length > 0);\n}\n\nfunction parseCommands(inputContent, context) {\n    let commands;\n    \n    commands = String(inputContent || \"\")\n        .split(/[;\\n]/)\n        .map(decodeArgs)\n        .filter(cmd => cmd.length > 0);\n\n    commands = commands\n        .map(cmd => decodeCommand(cmd, context))\n        .filter(cmd => cmd.id !== null);\n\n    if (commands.some(cmd => [\"PRINT_SERVICES\", \"REDIRECT\"].includes(cmd[\"id\"]))) {\n        commands.push({id: \"GET_SERVICES\"});\n    }\n\n    if (commands.some(cmd => cmd[\"id\"] == \"CLOSE\") && !commands.some(cmd => cmd[\"id\"] == \"GOTO\")) {\n        commands.push({id: \"GOTO\", data: \"onboarding\", message: \"🔁 Jumping to block onboarding\", priority: 8});\n    }\n    \n    commands = commands\n        .reduce(function (acc, cmd) {\n            acc[cmd.id] = cmd;\n            return acc;\n        }, {});\n\n    return commands\n}\n\nfunction run(input, contactId, secret, commands) {\n    secret = secret || \"123\";\n    \n    const session = JSON.parse(commands || \"{}\").DEBUG;\n\n    const context = {identity: contactId};\n    commands = parseCommands(input, context);\n\n    commands[\"DEBUG\"] = commands[\"DEBUG\"] || session;\n    commands[\"ENABLED\"] = commands.DEBUG && commands.DEBUG.data == secret;\n\n    return JSON.stringify(commands);\n}","inputVariables":["input.content","contact.identity","config.debugSecret","commands"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false},{"$id":"d8df88c1-3ff4-48a9-ad5e-0867984d1487","$typeOfContent":"","type":"ProcessCommand","$title":"Set Contact when SET_CONTACT exists","settings":{"to":"postmaster@msging.net","method":"set","resource":"{{commands@SET_CONTACT.data}}","type":"application/vnd.lime.contact+json","uri":"/contacts","variable":"setContactCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@SET_CONTACT"}],"$invalid":false},{"$id":"5ad3d211-0240-4489-83ed-af614c129b33","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when SET_CONTACT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    let message = `⚙️ Contact set to ${JSON.stringify(commands.SET_CONTACT.data)}.`;\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } \n    } catch (err) {\n        message = `❌ set contact: ${err.message}`;\n    }\n\n    commands.SET_CONTACT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","setContactCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@SET_CONTACT"}],"continueOnError":true,"$invalid":false},{"$id":"a00082d5-c648-4d7e-b6ef-0e4afba5370a","$typeOfContent":"","type":"ProcessCommand","$title":"Merge Contact when MERGE_CONTACT exists","settings":{"to":"postmaster@msging.net","method":"merge","resource":"{{commands@MERGE_CONTACT.data}}","type":"application/vnd.lime.contact+json","uri":"/contacts","variable":"mergeContactCommandResponse"},"conditions":[{"values":[],"source":"context","variable":"commands@MERGE_CONTACT","comparison":"exists"}],"$invalid":false},{"$id":"d9221ef7-8fbc-4d17-a7e2-eb5397574a55","$typeOfContent":"","type":"ExecuteScript","$title":"Process command when MERGE_CONTACT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    let message = `⚙️ Contact got merged with ${JSON.stringify(commands.MERGE_CONTACT.data)}.`;\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } \n    } catch (err) {\n        message = `❌ merge contact: ${err.message}`;\n    }\n\n    commands.MERGE_CONTACT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","mergeContactCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@MERGE_CONTACT"}],"continueOnError":true,"$invalid":false},{"$id":"a9635237-40a6-4f6e-bf08-aa431a53c2a2","$typeOfContent":"","type":"ProcessCommand","$title":"Set Context Variable when SET_CONTEXT exists","settings":{"to":"postmaster@msging.net","method":"set","resource":"{{commands@SET_CONTEXT.data.value}}","type":"text/plain","uri":"/contexts/{{contact.identity}}/{{commands@SET_CONTEXT.data.key}}","variable":"setContextCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@SET_CONTEXT"}],"$invalid":false},{"$id":"ac55004f-3a3c-423b-b891-772312cdcf53","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when SET_CONTEXT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    let message = `⚙️ Context variable <b>${commands.SET_CONTEXT.data.key}</b> set to <b>${commands.SET_CONTEXT.data.value}</b>.`;\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } \n    } catch (err) {\n        message = `❌ set context: ${err.message}`;\n    }\n\n    commands.SET_CONTEXT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","setContextCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@SET_CONTEXT"}],"continueOnError":true,"$invalid":false},{"$id":"884e97ac-65a7-433f-80ab-f4d24ea1cb23","$typeOfContent":"","type":"ProcessCommand","$title":"Get Context Variable when GET_CONTEXT exists","settings":{"to":"postmaster@msging.net","method":"get","uri":"/contexts/{{contact.identity}}/{{commands@GET_CONTEXT.data.key}}","variable":"getContextCommandResponse","from":"{{application.identity}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@GET_CONTEXT"}],"$invalid":false},{"$id":"e7c6abd9-cc66-458d-920d-df30f64a8681","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when GET_CONTEXT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    let message = null;\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } else {\n            const value = response.resource;\n            message = `⚙️ Context variable <b>${commands.GET_CONTEXT.data.key}</b>: <b>${value}</b>.`;\n        }\n    } catch (err) {\n        message = `❌ get context: ${err.message}`;\n    }\n\n    commands.GET_CONTEXT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","getContextCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@GET_CONTEXT"}],"continueOnError":true,"$invalid":false},{"$id":"313eaaa5-651b-4639-af86-3f81202f33c7","$typeOfContent":"","type":"ProcessCommand","$title":"Delete Context Variable when DELETE_CONTEXT exists","settings":{"to":"postmaster@msging.net","method":"delete","uri":"/contexts/{{contact.identity}}/{{commands@DELETE_CONTEXT.data.key}}","variable":"deleteContextCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@DELETE_CONTEXT"}],"$invalid":false},{"$id":"ff4ee09d-0693-4dea-a975-fe9e6f8d4be0","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when DELETE_CONTEXT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    let message = `⚙️ Context variable <b>${commands.DELETE_CONTEXT.data.key}</b> deleted.`;\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } \n    } catch (err) {\n        message = `❌ delete context: ${err.message}`;\n    }\n\n    commands.DELETE_CONTEXT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","deleteContextCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@DELETE_CONTEXT"}],"continueOnError":true,"$invalid":false},{"$id":"2b581fe9-3a05-4fb8-ba30-dcd5f5d0bfa8","$typeOfContent":"","type":"ProcessCommand","$title":"Get All Context when PRINT_CONTEXT exists","settings":{"to":"postmaster@msging.net","method":"get","uri":"/contexts/{{contact.identity}}?withContextValues=true&$skip={{commands@PRINT_CONTEXT.data.skip}}&$take={{commands@PRINT_CONTEXT.data.take}}","variable":"getAllContextCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@PRINT_CONTEXT"}],"$invalid":false},{"$id":"46abc774-db18-441d-8b53-699aa8b12df4","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when PRINT_CONTEXT exists","settings":{"function":"run","source":"const MAX_STR_LEN = 500;\n\nfunction printObject(data, level) {\n\treturn Object\n        .keys(data)\n        .map(function(key) {\n            const value = data[key];\n            let msg = new Array(level).fill(\"-\").join(\"\") + \" \";\n            if ([\"string\", \"boolean\", \"number\"].includes(typeof value)) {\n                let val = String(value);\n                if (val.length >= MAX_STR_LEN) {\n                    val = val.slice(0, MAX_STR_LEN) + \"...\";\n                }\n                msg += `<b>${key}:</b> ${val}`;\n            } else {\n                msg += `<b>${key}:</b>\\n${printObject(value, level + 1)}`;\n            }\n            return msg;\n        })\n        .join(\"\\n\");\n}\n\nfunction getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n\nfunction run(commands, commandReponse) {\n    const EXCLUDE_VARIABLES = [/commands/i, /message/i, /.*commandresponse/i, /.*stateid@.*/i];    \n\tlet message = null;\n\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status !== \"success\") {\n            throw new Error(getCommandError(response));\n        } else {\n\t\t\tconst context = response.resource.items.reduce(function (acc, item) {\n\t\t\t\tif (!EXCLUDE_VARIABLES.some(exp => exp.test(item.name))) {\n\t\t\t\t\tacc[item.name] = item.value;\n\t\t\t\t}\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\t\tif (Object.keys(context).length > 0) {\n\t\t\t\tmessage = printObject(context, 1);\n\t\t\t}  else {\n\t\t\t\tmessage = \"No variable found yet, try it again.\";\n\t\t\t}\n\t\t\tmessage = `📋 CONTEXT\\n${message}`;\n\t\t}\n    } catch (err) {\n        message = `❌ print context: ${err.message}`;\n    }\n\n    commands.PRINT_CONTEXT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","getAllContextCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@PRINT_CONTEXT"}],"continueOnError":true,"$invalid":false},{"$id":"ec13b725-6b3e-401c-9398-f155d7b5247b","$typeOfContent":"","type":"ProcessCommand","$title":"Get Contact when PRINT_CONTACT exists","settings":{"to":"postmaster@msging.net","method":"get","uri":"/contacts/{{contact.identity}}","variable":"getContactCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@PRINT_CONTACT"}],"$invalid":false},{"$id":"d80827cb-85fc-408a-b06d-67a0710f7c4e","$typeOfContent":"","type":"ExecuteScript","$title":"Process command when PRINT_CONTACT exists","settings":{"function":"run","source":"const MAX_STR_LEN = 500;\n\nfunction printObject(data, level) {\n\treturn Object\n        .keys(data)\n        .map(function(key) {\n            const value = data[key];\n            let msg = new Array(level).fill(\"-\").join(\"\") + \" \";\n            if ([\"string\", \"boolean\", \"number\"].includes(typeof value)) {\n                let val = String(value);\n                if (val.length >= MAX_STR_LEN) {\n                    val = val.slice(0, MAX_STR_LEN) + \"...\";\n                }\n                msg += `<b>${key}:</b> ${val}`;\n            } else {\n                msg += `<b>${key}:</b>\\n${printObject(value, level + 1)}`;\n            }\n            return msg;\n        })\n        .join(\"\\n\");\n}\n\nfunction getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n} \n\nfunction run(commands, commandReponse) {\n\tlet message = null;\n\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status === \"success\" && response.resource) {\n            contact = response.resource;\n            message = printObject(contact, 1);\n        } else {\n            throw new Error(getCommandError(response));\n        } \n\t} catch (err) {\n\t\tmessage = `❌ print contact: ${err.message}`;\n\t}\n\n\tcommands.PRINT_CONTACT.message = `📖 Contact\\n${message}`;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","getContactCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@PRINT_CONTACT"}],"continueOnError":true,"$invalid":false},{"$id":"9d405be6-4793-4dfd-8a81-b5f9742a5cf2","$typeOfContent":"","type":"ProcessCommand","$title":"Get Services when GET_SERVICES exists","settings":{"to":"postmaster@msging.net","method":"get","uri":"lime://start.master.hosting@msging.net/configuration","variable":"getServicesCommandResponse"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@GET_SERVICES"}],"$invalid":false},{"$id":"35876104-681b-4552-b7f4-fff8b1cf3b50","$typeOfContent":"","type":"ExecuteScript","$title":"Process command when PRINT_SERVICES exists","settings":{"function":"run","source":"function run(commands, commandReponse) {\n\tlet message = \"📑 Services\\n\";\n\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status === \"success\" && response.resource && response.resource.Application) {\n            const configuration = JSON.parse(response.resource.Application);\n            const services = configuration.settings.children;\n\n            message += Array.from(services)\n                .map(child => `${child.isDefault ? \"+\" : \"-\"} <b>${child.service}:</b> ${child.shortName} <i>${child.longName}</i>`)\n                .join(\"\\n\");\n        } else {\n            throw new Error(getCommandError(response));\n        } \n\t} catch (err) {\n\t\tmessage = `❌ print services: ${err.message}`;\n\t}\n\n\tcommands.PRINT_SERVICES.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","getServicesCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@PRINT_SERVICES"}],"continueOnError":true,"$invalid":false},{"$id":"0f43ed55-4182-4234-add1-f484297372ee","$typeOfContent":"","type":"ExecuteScript","$title":"Process command when REDIRECT exists","settings":{"function":"run","source":"function getCommandError(response) {\n    let message = JSON.stringify(response);\n    if (response.status === \"failure\" && response.reason && response.reason.description) {\n        message = response.reason.description;\n    } else if (response.reduced) {\n        message = \"Reduced\";\n    }\n\n    return message;\n}\n \n\nfunction run(commands, commandReponse) {\n\tlet message = null;\n\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    try {\n        const response = JSON.parse(commandReponse);\n        if (response.status === \"success\" && response.resource && response.resource.Application) {\n            const configuration = JSON.parse(response.resource.Application);\n            const services = Array.from(configuration.settings.children).map(child => child.service);\n            const service = services.find(service => String(service).toUpperCase() == String(commands.REDIRECT.data).toUpperCase());\n            if (!service) {\n                throw new Error(`service <b>${commands.REDIRECT.data}</b> does not exists.`);\n            } else {\n                commands.REDIRECT.data = service;\n                message = `🔁 Redirecting to service ${service}`;\n            }\n        } else {\n\t\t    throw new Error(getCommandError(response));\n\t    } \n\t} catch (err) {\n\t\tmessage = `❌ redirect: ${err.message}`;\n        commands.REDIRECT.data = undefined;\n\n\t}\n\n\tcommands.REDIRECT.message = message;\n\n\treturn JSON.stringify(commands); \n}\n","inputVariables":["commands","getServicesCommandResponse"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@REDIRECT"}],"continueOnError":true,"$invalid":false},{"$id":"00eb4cc3-e787-4e3c-bdf6-47037eeb4a90","$typeOfContent":"","type":"ExecuteScript","$title":"Process message","settings":{"function":"run","source":"\nfunction run(commands, botId) {\n    let message = \"Desculpe, não entendi!\";\n\ttry {\n\t\tcommands = JSON.parse(commands)\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n    if (!commands.ENABLED) {\n        return message;\n    } else {\n        message = `⚠️ <b>DEBUG MODE</b> ⚠️\\n current bot: <b>${botId}</b>\\n\\n`;\n    }\n\n    let messages = Object.keys(commands)\n        .filter(id => Boolean(commands[id][\"message\"]))\n        .sort((idA, idB) => commands[idA][\"priority\"] > commands[idB][\"priority\"])\n        .map(id => commands[id][\"message\"])\n\n    if (messages.length === 0) {\n        message += \"No command found, try <b>help</b> for the list of available commands.\"\n    } else {\n        messages = messages.join(\"\\n\");\n        if (messages.length < 3500) {\n            message += messages;\n        } else {\n            message += \"Message too long. Please run fewer commands or with more specific parameters.\"\n        }\n    }\n\n    if (!(commands.GOTO || commands.REDIRECT)) {\n        message += \"\\n\\nTo exit DEBUG mode you must use <b>close</b> or <b>goto</b> commands.\";\n        message += \"\\n➡️ Example: <b>goto onboarding</b> or <b>close</b>\";\n    }\n\n\treturn message; \n}\n\n","inputVariables":["commands","application.identifier"],"outputVariable":"message","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false}],"$leavingCustomActions":[{"$id":"0aa01d08-c523-4869-bdf9-4fc9cd48574b","$typeOfContent":"","type":"ExecuteScript","$title":"Reset commands when no input or GOTO or REDIRECT","settings":{"function":"run","source":"\nfunction run(commands, input) {\n\tcommands = JSON.parse(commands);\n\tif (!input || commands.GOTO || commands.REDIRECT || !commands.ENABLED) {\n\t\tcommands[\"DEBUG\"] = undefined;\n\t}\n\treturn JSON.stringify(commands);\n}","inputVariables":["commands","input.content"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false},{"$id":"79826d8b-f1e7-408d-9bf6-2bcf8cd24cc0","$typeOfContent":"","type":"Redirect","$title":"Redirect when REDIRECT exists","settings":{"address":"{{commands@REDIRECT.data}}"},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@REDIRECT"},{"values":[],"source":"context","comparison":"exists","variable":"commands@REDIRECT.data"}],"$invalid":false},{"$id":"f8ad824e-4557-4067-b3b4-787a889b160d","$typeOfContent":"","type":"ExecuteScript","$title":"Process commands when REDIRECT","settings":{"function":"run","source":"\nfunction run(commands) {\n\ttry {\n\t\tcommands = JSON.parse(commands);\n\t} catch(err) {\n\t\tcommands = {};\n\t}\n\n\tcommands.GOTO = { data: \"onboarding\" };\n\t\n\treturn JSON.stringify(commands);\n}","inputVariables":["commands"],"outputVariable":"commands","LocalTimeZoneEnabled":false},"conditions":[{"values":[],"source":"context","comparison":"exists","variable":"commands@REDIRECT"},{"values":[],"source":"context","comparison":"exists","variable":"commands@REDIRECT.data"}],"continueOnError":true,"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","typeOfStateId":"state","$invalid":false},"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false},{"background":"#5bc0eb","label":"Redirect","id":"DWNT0d25-28a5-43f4-b509-3306608554fa","canChangeBackground":false}],"id":"DWNT2ed1-aada-425e-a805-2558a70a1dbf","root":false,"$title":"#DEBUG by Dawntech","$position":{"top":"5005px","left":"1087px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"regular-error":{"id":"regular-error","$title":"[DWNT] Erro padrão","$contentActions":[{"action":{"$id":"01eecd22-0846-49ce-bc28-f252c56115b8","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3c69832e-079f-40f7-8274-7075fcef0e6a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3c69832e-079f-40f7-8274-7075fcef0e6a","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"debug"}]},"$invalid":false},{"action":{"$id":"7c9b42af-7fed-45a9-beae-3ecafbf99760","$typeOfContent":"text","type":"SendMessage","settings":{"id":"873751a2-c125-4c98-955d-d5e7d575580c","type":"text/plain","content":"<b>ERROR</b>\n<b>-----Info-----</b>\n<b>Type:</b> {{error@type}}\n<b>State:</b> {{error@state.name}}\n<b>Description:</b> {{error@description}}\n<b>----Return----</b>\n<b>State:</b> {{error@return.state}}\n<b>Bot:</b> {{error@return.bot}}\n<b>Service:</b> {{error@return.service}}","metadata":{}},"$cardContent":{"document":{"id":"873751a2-c125-4c98-955d-d5e7d575580c","type":"text/plain","content":"<b>ERROR</b>\n<b>-----Info-----</b>\n<b>Type:</b> {{error@type}}\n<b>State:</b> {{error@state.name}}\n<b>Description:</b> {{error@description}}\n<b>----Return----</b>\n<b>State:</b> {{error@return.state}}\n<b>Bot:</b> {{error@return.bot}}\n<b>Service:</b> {{error@return.service}}"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"debug"}]},"$invalid":false},{"action":{"$id":"6293c045-983b-416e-9193-b976be193171","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"034bba16-f254-479c-948a-927beee04b2c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"034bba16-f254-479c-948a-927beee04b2c","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"source":"context","comparison":"notEquals","values":["null"],"variable":"message"}]},"$invalid":false},{"action":{"$id":"66aab341-57ce-4817-b50f-506c91e3d327","$typeOfContent":"text","type":"SendMessage","settings":{"id":"bd5256e0-16f5-4840-a5f3-ff4c0cdc830f","type":"text/plain","content":"{{message}}","metadata":{}},"$cardContent":{"document":{"id":"bd5256e0-16f5-4840-a5f3-ff4c0cdc830f","type":"text/plain","content":"{{message}}"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"source":"context","comparison":"notEquals","values":["null"],"variable":"message"}]},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"f5abf80c-6aff-40ed-882e-98cd7db59671","type":"text/plain","textContent":"Entrada do usuário","content":"Entrada do usuário"},"editable":false,"deletable":true,"position":"right"},"conditions":[],"$invalid":false,"expiration":"01:00"},"$invalid":false}],"$conditionOutputs":[{"stateId":"{{error@return.state}}","typeOfStateId":"variable","$id":"a9e47d28-b940-4976-ad7c-825819c39440","conditions":[{"source":"context","comparison":"exists","values":[],"variable":"error@return"},{"values":["null"],"source":"context","comparison":"equals","variable":"error@return.bot"},{"values":["null"],"source":"context","comparison":"notEquals","variable":"error@return.state"}],"$invalid":false}],"$enteringCustomActions":[{"$id":"3d8e0e2b-1bf0-4244-9ad8-347788969d44","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Pega mensagem de erro","settings":{"function":"run","source":"\nfunction run(error) {\n\tlet message = null;\n\ttry {\n\t\terror = JSON.parse(error);\n\t\tmessage = error.message;\n\t} catch(err) {}\n\t\n\tif (!message || message == \"null\") {\n\t\treturn null;\n\t}\n\tmessage = String(message).split(/\\\\+n/g).join(\"\\n\");\n\treturn message;\n}","inputVariables":["error"],"outputVariable":"message","LocalTimeZoneEnabled":false},"conditions":[],"$invalid":false}],"$leavingCustomActions":[{"$id":"4b0d933b-e593-41a1-bad6-548e23ea2542","$typeOfContent":"","type":"Redirect","$title":"[DWNT] Redireciona para o serviço com bloco específico","settings":{"address":"{{error@return.service}}","context":{"type":"text/plain","value":"#goto {{error@return.state}}"}},"conditions":[{"values":["null"],"source":"context","comparison":"notEquals","variable":"error@return.bot"},{"values":["null"],"source":"context","comparison":"notEquals","variable":"error@return.state"}],"$invalid":false},{"$id":"47dc4e16-4913-4256-8a48-d4b4420094f9","$typeOfContent":"","type":"Redirect","$title":"[DWNT] Redireciona para o serviço principal","settings":{"address":"{{DWNT@mainService}}"},"conditions":[{"values":["null"],"source":"context","comparison":"equals","variable":"error@return.state"}],"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","typeOfStateId":"state","$invalid":false},"$tags":[{"background":"#5bc0eb","label":"Redirect","id":"DWNT0d25-28a5-43f4-b509-3306608554fa","canChangeBackground":false}],"$position":{"top":"5483px","left":"1089px"},"root":false,"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8dd558ee-3a74-413a-b283-7e2b1dee3749":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9c467547-6920-4ff4-bb38-2c4b3817c2d5","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"fab34289-eb25-4f27-ad76-283481b1e08b","typeOfStateId":"state","$connId":"con_703","$id":"a79efe6c-9437-483e-bcd3-b3df288fb9c2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"358758c7-f9d9-4341-bb0f-afbcde1a554c","$typeOfContent":"","type":"MergeContact","$title":"Set contact - setQueue","$invalid":false,"settings":{"extras":{"queue":"operational"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false}],"id":"8dd558ee-3a74-413a-b283-7e2b1dee3749","root":false,"$title":"setQueue","$position":{"top":"1367px","left":"7523px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"27f30a39-df19-40d1-be4a-12e8eca7852b":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"9a364ed4-0ded-4335-8c27-6a7714f2ff80","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false,"$$hashKey":"object:965"}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:985"}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false,"$$hashKey":"object:967"},{"stateId":"93bcf7ca-6574-4e76-a032-28a67ac5edb0","typeOfStateId":"state","$connId":"con_708","$id":"e6eb901c-6eb7-494e-9fff-8a93203be87f","conditions":[{"source":"context","comparison":"equals","values":["200"],"variable":"statusConsultaVagas","$$hashKey":"object:999"}],"$invalid":false,"$$hashKey":"object:968"}],"$enteringCustomActions":[{"$id":"d297b46d-20cf-412d-a481-692a925dff72","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - consulta vagas","$invalid":false,"settings":{"headers":{"api-key":"1060684d-9acf-4d27-943f-c20d7a6a52f0"},"method":"POST","body":"{\n    \"spreadsheetId\": \"1VlTO0ut_-HWfjl9aYZ5NXKTjEWa3a2LACOjb3qixDkA\",\n     \"filter\": [\n        {\n            \"column\": \"B\",\n            \"value\": \"Aberta\"\n        }\n    ]\n}","uri":"https://api.catalyst.dwnt.store/spreadsheets/rowslist?multiple=true","responseStatusVariable":"statusConsultaVagas","responseBodyVariable":"responseConsultaVagas"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-HTTPSTSf-412d-a481-692a925dff72","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' API","settings":{"variable":"errorType","value":"API"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["1","3","4","5"],"source":"context","comparison":"startsWith","variable":"statusConsultaVagas"}],"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#32DE8A","label":"HTTP/Command","id":"DWNT2aa2-f775-44ee-bd9a-ab6da9d7c548","canChangeBackground":false}],"id":"27f30a39-df19-40d1-be4a-12e8eca7852b","root":false,"$title":"API - Consulta Vagas","$position":{"top":"856px","left":"2642px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"839e899b-619a-4521-a710-d7cdf4af851a":{"$contentActions":[{"action":{"$id":"3fed9097-1f30-420e-83b9-432ea14d58a3","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3142d5eb-0b74-4511-ab0d-8a0432686310","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3142d5eb-0b74-4511-ab0d-8a0432686310","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"943d47be-f0d8-47de-8566-0a3051d8c09b","$typeOfContent":"text","type":"SendMessage","settings":{"id":"81bb7fc2-3007-49fe-90b2-c6bd9d3fbc3e","type":"text/plain","content":"Qual o número da Nota Fiscal?\nSe não sabe, você pode consultar no boleto😉","metadata":{}},"$cardContent":{"document":{"id":"81bb7fc2-3007-49fe-90b2-c6bd9d3fbc3e","type":"text/plain","content":"Qual o número da Nota Fiscal?\nSe não sabe, você pode consultar no boleto😉"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"cd2b4920-4dcb-4df4-bc02-6519ec8b5e7f","type":"text/plain","textContent":"User input","content":"noteNumber"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"noteNumber","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_713","$id":"54f1342d-5d03-4c76-8088-8dc4e6bc09a0","conditions":[{"source":"input","comparison":"exists","values":[]},{"values":["true"],"source":"context","comparison":"equals","variable":"validateNoteNumberJs"}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[{"$id":"39dda116-c417-42f9-8f59-3f3403fb480b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - validateNoteNumberJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(input) {\n    try {\n      const numberRegex = /^\\d+$/;\n      return numberRegex.test(input);\n    } catch (error) {\n      return error.message\n    }\n  }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - validateNoteNumberJs] \"+String(err);}}","inputVariables":["noteNumber"],"outputVariable":"validateNoteNumberJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT7-42f9-8f59-3f3403fb480b","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{validateNoteNumberJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"validateNoteNumberJs"}],"$invalid":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"839e899b-619a-4521-a710-d7cdf4af851a","root":false,"$title":"Mensagem - Qual o número da nota?","$position":{"top":"1623px","left":"4829px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"54149689-d7a5-4f04-b281-3d06976e2c8f":{"$contentActions":[{"action":{"$id":"14dce247-1faf-450a-b8d5-35e6b6a675a6","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"0f18ad78-9f4a-4a1a-80cc-dd6ca2d7f6db","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"0f18ad78-9f4a-4a1a-80cc-dd6ca2d7f6db","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f2e4e976-ecfe-4f9c-8c41-fd6bc0a3bdf6","$typeOfContent":"text","type":"SendMessage","settings":{"id":"2d9d3a3c-9924-4608-a0d5-3b72344873e1","type":"text/plain","content":"Antes de prosseguirmos, por favor nos diga, de qual estado você está falando?","metadata":{}},"$cardContent":{"document":{"id":"2d9d3a3c-9924-4608-a0d5-3b72344873e1","type":"text/plain","content":"Antes de prosseguirmos, por favor nos diga, de qual estado você está falando?"},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"66beef81-118a-4c8c-a849-496750733baa","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"1f847e4c-6dfe-4793-aea0-c8ecb978701b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"1f847e4c-6dfe-4793-aea0-c8ecb978701b","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"41b5595f-b39b-482d-aafe-6de3a7b103d9","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"648d3958-9d0c-45a4-ae98-ab3e7a3b1481","type":"text/plain","textContent":"User input","content":"stateOfClient"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"stateOfClient","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"$id":"DWNT4654-c1b9-42d9-bc9d-6ddf3d8d4f56","conditions":[{"comparison":"exists","source":"context","variable":"errorType","values":[]}],"stateId":"{{DWNT@states.fallback}}","typeOfStateId":"variable","$invalid":false},{"stateId":"61b6d544-ffa7-4378-a605-77135fde248e","typeOfStateId":"state","$connId":"con_718","$id":"eb6f5092-2455-44ce-90bc-087f1bb636a2","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"c24a30b8-ce8f-4bc8-8b1f-d5ffb07c963c","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTf-4bc8-8b1f-d5ffb07c963c","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"01e313fc-00dd-4c54-bf97-a314f78a4d3d","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal) {\n  try {\n    const textHeader = \"\";\n    const textBody = `Selecione seu estado. 👇`;\n    const textFooter = ``;\n\n    if (canal === \"whatsapp\") {\n      return {\n        type: \"application/json\",\n        content: {\n          \"recipient_type\": \"individual\",\n          \"type\": \"interactive\",\n          interactive: {\n            \"type\": \"list\",\n            header: {\n              \"type\": \"text\",\n              text: textHeader,\n            },\n            body: {\n              text: textBody,\n            },\n            footer: {\n              text: textFooter,\n            },\n            action: {\n              \"button\": \"Clique aqui\",\n              \"sections\": [\n                {\n                  \"title\": \"Menu principal\",\n                  \"rows\": [\n                    { \"id\": \"1\", \"title\": \"Rio Grande do Sul\", \"description\": \"\" },\n                    { \"id\": \"3\", \"title\": \"Santa Catarina\", \"description\": \"\" },\n                    { \"id\": \"4\", \"title\": \"Paraná\", \"description\": \"\" },\n                    { \"id\": \"5\", \"title\": \"Rio de Janeiro\", \"description\": \"\" },\n                    { \"id\": \"6\", \"title\": \"São Paulo\", \"description\": \"\" },\n                    { \"id\": \"7\", \"title\": \"Demais estados\", \"description\": \"\" }]\n                }\n              ]\n            },\n          },\n        }\n      };\n    }\n  } catch (error) {\n    return error.message;\n  }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPTd-4c54-bf97-a314f78a4d3d","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"f8e78b9d-af36-445e-9ccc-818e0194ce2e","$typeOfContent":"","type":"TrackEvent","$title":"Registro de eventos","$invalid":false,"settings":{"extras":{},"category":"REPORT- Menu Qual estado?","action":"{{stateOfClient}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":[],"source":"context","comparison":"exists","variable":"inputMainMenu"}]},{"$id":"692fe469-3bf1-4143-951f-40baef40d453","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getStateAbbreviationJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(stateOfClient) {\n    try {\n        const stateAbbreviations = {\n            \"Rio Grande do Sul\": \"RS\",\n            \"Santa Catarina\": \"SC\",\n            \"Paraná\": \"PR\",\n            \"Rio de Janeiro\": \"RJ\",\n            \"São Paulo\": \"SP\"\n            // \"Acre\": \"AC\",\n            // \"Alagoas\": \"AL\",\n            // \"Amapá\": \"AP\",\n            // \"Amazonas\": \"AM\",\n            // \"Bahia\": \"BA\",\n            // \"Ceará\": \"CE\",\n            // \"Distrito Federal\": \"DF\",\n            // \"Espírito Santo\": \"ES\",\n            // \"Goiás\": \"GO\",\n            // \"Maranhão\": \"MA\",\n            // \"Mato Grosso\": \"MT\",\n            // \"Mato Grosso do Sul\": \"MS\",\n            // \"Minas Gerais\": \"MG\",\n            // \"Pará\": \"PA\",\n            // \"Paraíba\": \"PB\",\n            // \"Pernambuco\": \"PE\",\n            // \"Piauí\": \"PI\",\n            // \"Rio Grande do Norte\": \"RN\",\n            // \"Rondônia\": \"RO\",\n            // \"Roraima\": \"RR\",\n            // \"Sergipe\": \"SE\",\n            // \"Tocantins\": \"TO\"\n        };\n\n        return stateAbbreviations[stateOfClient] || 'Demais estados';\n    } catch (e) {\n        return e.message\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - getStateAbbreviationJs] \"+String(err);}}","inputVariables":["stateOfClient"],"outputVariable":"getStateAbbreviationJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT1-4143-951f-40baef40d453","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{getStateAbbreviationJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"getStateAbbreviationJs"}],"$invalid":false},{"$id":"2808f27b-139c-415d-a2b6-19f1ba69e8cd","$typeOfContent":"","type":"MergeContact","$title":"Definir estado do cliente","$invalid":false,"settings":{"extras":{"state":"{{getStateAbbreviationJs}}"}},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false},{"background":"#C3423F","label":"MergeContact","id":"DWNTcc79-1eae-4759-9316-cd22153acf3f","canChangeBackground":false},{"background":"#779CAB","label":"TrackEvents","id":"DWNTe5a9-aaf2-4282-9d74-493810becee1","canChangeBackground":false}],"id":"54149689-d7a5-4f04-b281-3d06976e2c8f","root":false,"$title":"Menu - Qual estado?","$position":{"top":"1142px","left":"3517px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"494598cb-a5ac-4a3b-9ac8-870c9b175782":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"68b17212-8206-4383-9d8e-018928e21f56","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:3962"}],"$conditionOutputs":[{"stateId":"5fb682bf-92f2-4ed6-aaca-e211732f8e1f","typeOfStateId":"state","$connId":"con_723","$id":"22e41adb-4e97-4d14-8995-42c880072ab6","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"phoneDataVerify","$$hashKey":"object:3984"},{"values":["true"],"source":"context","comparison":"equals","variable":"dataSizeVerify","$$hashKey":"object:3985"}],"$invalid":false,"$$hashKey":"object:3964"},{"stateId":"a2a65e61-eb8c-48f9-a7cc-bad98deef6d6","typeOfStateId":"state","$connId":"con_728","$id":"84dff6a1-5f3c-47b9-9a8b-3ef89876d6e8","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"phoneDataVerify","$$hashKey":"object:4013"},{"values":["false"],"source":"context","variable":"dataSizeVerify","comparison":"equals","$$hashKey":"object:4014"}],"$invalid":false,"$$hashKey":"object:3965"},{"stateId":"f756708b-f3a1-4af0-be4c-e0a5af3b8dd3","typeOfStateId":"state","$connId":"con_733","$id":"fc17f219-d1bf-4191-94f2-2baf26039616","conditions":[{"source":"context","comparison":"equals","values":["false"],"variable":"phoneDataVerify","$$hashKey":"object:4040"}],"$invalid":false,"$$hashKey":"object:3966"}],"$enteringCustomActions":[{"$id":"62a290ca-985a-4b91-96f5-5752f2df9245","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - phoneDataVerify","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.records && Array.isArray(data.records) && data.records.length > 0) {\n            return true;\n        } else {\n            return false; \n        }\n    } catch (error) {\n        return false;\n    }\n}","inputVariables":["responseGetAccountByPhone"],"outputVariable":"phoneDataVerify","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4727ac19-bbf3-4472-b60e-dff51f434481","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - dataSizeVerify","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize > 1) {\n            return true;\n        } else if (data.totalSize <= 1) {\n            return false;\n        }\n    } catch (error) {\n        return error.message;\n    }\n}","inputVariables":["responseGetAccountByPhone"],"outputVariable":"dataSizeVerify","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"494598cb-a5ac-4a3b-9ac8-870c9b175782","root":false,"$title":"Verificar conta vinculada phone","$position":{"top":"1106px","left":"987px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"87d0208d-50b3-402a-8431-7472d186ce37":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"87a22571-a8d9-4bb1-b5d0-65a1256446de","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"66e31b76-8941-4c3a-a18b-47c1e211e77e","$typeOfContent":"","type":"SetVariable","$title":"[DELETAR] - phone","$invalid":false,"settings":{"variable":"phone","value":"5575998686535"},"conditions":[]},{"$id":"590ef58c-6970-4ef5-bd16-ef2ae3b1da36","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - formatedPhone","$invalid":false,"settings":{"function":"run","source":"function run(numero) {\n    try {\n        let numeroLimpo = numero.replace(/\\D/g, '');\n\n        if (numeroLimpo.length > 10) {\n            numeroLimpo = numeroLimpo.slice(4);\n        }\n\n        return numeroLimpo;\n    } catch (error) {\n        return error.message;\n    }\n}","inputVariables":["phone"],"outputVariable":"formatedPhone","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"87d0208d-50b3-402a-8431-7472d186ce37","root":false,"$title":"New block","$position":{"top":"1016.67px","left":"478.667px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"5fb682bf-92f2-4ed6-aaca-e211732f8e1f":{"$contentActions":[{"action":{"$id":"2b977898-3a62-4a2c-b593-546d75b01765","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c664c4ee-b679-4b9b-a479-9f70aa3346d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c664c4ee-b679-4b9b-a479-9f70aa3346d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"47efb6a9-b5b3-4af2-b349-0df434ad250b","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"action":{"$id":"f2dbc08e-2229-460e-ab4f-ebf4d6a16add","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"fe4e321d-30af-408e-a8bc-b7c9518d3969","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"fe4e321d-30af-408e-a8bc-b7c9518d3969","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0db20332-21bc-4e69-876e-e80ee4a64e78","type":"text/plain","textContent":"User input","content":"inputMenuDinamico"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuDinamico","expiration":"1:0","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","typeOfStateId":"state","$connId":"con_738","$id":"42480e71-2dfe-4eab-845a-dc58b8180310","conditions":[{"source":"input","comparison":"notEquals","values":["Outra"]}],"$invalid":false},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_743","$id":"a62ccd34-25b7-4fa1-987b-646b9e5ff0b2","conditions":[{"source":"input","comparison":"equals","values":["Outra"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"772c1714-b682-4859-bd52-f0e4d87a29a3","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - accountVerifyJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(data) {\n    try {\n        const parsedData = JSON.parse(data);\n        const records = parsedData.records;\n\n        if (!Array.isArray(records)) {\n            return \"Records is not an array\";\n        }\n\n        // const totalSize = parsedData.totalSize;\n\n        const accountNames = records.map(record => record.Name);\n        const accountCpfCnpj = records.map(record => record.CA_CPFCNPJ__c);\n        const totalSize = parsedData.totalSize;\n        const accountId = records.map(record => record.CA_CodigoERP__c)\n\n        return {\n            accountNames:accountNames,\n            accountCpfCnpj: accountCpfCnpj,\n            totalSize: totalSize,\n            accountId: accountId\n        };\n    } catch (error) {\n        return error.message;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - orderVerifyJs] \"+String(err);}}","inputVariables":["responseGetAccountByPhone"],"outputVariable":"accountVerifyJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT2-4859-bd52-f0e4d87a29a3","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{orderVerifyJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"orderVerifyJs"}],"$invalid":false},{"$id":"dd4ed878-10a5-45bd-9931-f26aea75b734","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT5-45bd-9931-f26aea75b734","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"DWNT-USRSCPTe-485b-bf7e-d19cab16b499","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{getOrderIdAndNumberJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"getOrderIdAndNumberJs"}],"$invalid":false},{"$id":"3b69a34f-99ce-47d5-b563-de70ff86a826","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - addOthersInMenu","$invalid":false,"settings":{"function":"run","source":"\nfunction run(accountVerifyJs) {\n    const accountVerify = JSON.parse(accountVerifyJs)\n\n    if (!accountVerify.accountCpfCnpj.includes(\"outros\")) {\n        accountVerify.accountCpfCnpj.push(\"Outra\");\n         accountVerify.accountId.push(\"Outra\");\n        accountVerify.totalSize = accountVerify.accountCpfCnpj.length;\n    }\n    return accountVerify\n}","inputVariables":["accountVerifyJs"],"outputVariable":"accountVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"06080c79-f5b0-4d99-9c88-fad088584388","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal, accountVerifyJs) {\n    try {\n        if (!accountVerifyJs) {\n            throw new Error(\"Dados inválidos fornecidos\");\n        }\n\n        const parsedData = JSON.parse(accountVerifyJs);\n\n        if (!parsedData.accountCpfCnpj || !Array.isArray(parsedData.accountCpfCnpj)) {\n            throw new Error(\"Formato de dados inválido\");\n        }\n\n        const arrayOptions = parsedData;\n        const textHeader = \"\";\n        const textBody = `Encontramos mais de um estabelecimento atrelado ao seu nome. Sobre qual gostaria de falar?`;\n        const textFooter = ``;\n\n        if (canal === \"whatsapp\") {\n            return {\n                type: \"application/json\",\n                content: {\n                    \"recipient_type\": \"individual\",\n                    \"type\": \"interactive\",\n                    interactive: {\n                        \"type\": \"list\",\n                        header: {\n                            \"type\": \"text\",\n                            text: textHeader,\n                        },\n                        body: {\n                            text: textBody,\n                        },\n                        footer: {\n                            text: textFooter,\n                        },\n                        action: {\n                            \"button\": \"Clique aqui\",\n                            \"sections\": [\n                                {\n                                    \"title\": \"Contas\",\n                                    \"rows\": mountMenuWhatsApp(arrayOptions)\n                                }\n                            ]\n                        },\n                    },\n                }\n            };\n        }\n\n        if (canal === \"BlipChat\") {\n            return {\n                type: \"application/vnd.lime.select+json\",\n                content: {\n                    text: textBody,\n                    options: mountMenuBlipChat(arrayOptions),\n                },\n            };\n        }\n\n        return {\n            type: \"text/plain\",\n            content: mountMenuText(textBody, arrayOptions),\n        };\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction mountMenuWhatsApp(arrayOptions) {\n    return arrayOptions.accountCpfCnpj.map((accountCpfCnpj, index) => ({\n        id: arrayOptions.accountId[index],\n        title: accountCpfCnpj .substring(0,24),\n        description: arrayOptions.accountNames[index]\n    }));\n}\n\nfunction mountMenuBlipChat(arrayOptions) {\n    return arrayOptions.map((accountCpfCnpj, index) => ({\n        id: `option-${index + 1}`,\n        text: accountCpfCnpj\n    }));\n}\n\nfunction mountMenuText(textBody, arrayOptions) {\n    const textOptions = arrayOptions.map((accountCpfCnpj, index) => `${index + 1} - ${accountCpfCnpj}`);\n    return `${textBody}\\n\\n${textOptions.join(\"\\n\")}`;\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs","accountVerifyJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT0-4d99-9c88-fad088584388","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"05dc4f8a-f665-4b1a-b318-bec88ff83eeb","$typeOfContent":"","type":"SetVariable","$title":"Set variable - inputSelectedOrder","$invalid":false,"settings":{"variable":"inputSelectedOrder","value":"{{input.message}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"5c455d78-4371-4878-a9be-8ee60d7c0a4e","$typeOfContent":"","type":"SetVariable","$title":"Set variable - inputContentCpf","$invalid":false,"settings":{"variable":"inputContentCpf","value":"{{input.content}}"},"conditions":[]},{"$id":"7ac8e084-b5f5-4628-9293-f0d80dad36be","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getIdOfInputMessageJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(inputData) {\n    const data = JSON.parse(inputData)\n    return data.metadata[\"#wa.interactive.list.id\"];\n }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - getIdOfInputMessageJs] \"+String(err);}}","inputVariables":["inputSelectedOrder"],"outputVariable":"getIdOfInputMessageJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT5-4628-9293-f0d80dad36be","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{getIdOfInputMessageJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"getIdOfInputMessageJs"}],"$invalid":false},{"$id":"2544d87b-becd-4830-a429-bf4eaab8c3ff","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - returnNameCliente","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    try {\n        const data = JSON.parse(input);\n\n        if (data.metadata && data.metadata['#replyContent']) {\n\n            const replyContent = data.metadata['#replyContent'];\n\n            const parsedReplyContent = JSON.parse(replyContent);\n\n            return parsedReplyContent;\n        } else {\n            return \"O campo #replyContent não foi encontrado.\";\n        }\n    } catch (error) {\n        return `Erro ao processar o JSON: ${error.message}`;\n    }\n}","inputVariables":["input.message"],"outputVariable":"returnNameCliente","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"d696b617-99ca-4022-ac8f-da304ae0c81e","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getNameCliente","$invalid":false,"settings":{"function":"run","source":"function run(response, searchTitle) {\n    try {\n        const data = JSON.parse(response);\n\n        const sections = data.inReplyTo.value.interactive.action.sections;\n\n        for (let i = 0; i < sections.length; i++) {\n            let section = sections[i];\n            for (let j = 0; j < section.rows.length; j++) {\n                let row = section.rows[j];\n                if (row.title === searchTitle) {\n                    return row.description || \"Descrição não disponível\"; \n                }\n            }\n        }\n        return \"Título não encontrado\";\n    } catch (error) {\n        return `Erro ao processar o JSON: ${error.message}`;\n    }\n}","inputVariables":["returnNameCliente","input.content"],"outputVariable":"getNameCliente","LocalTimeZoneEnabled":false},"conditions":[],"continueOnError":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"5fb682bf-92f2-4ed6-aaca-e211732f8e1f","root":false,"$title":"Menu - Selecionar conta por telefone","$position":{"top":"1319px","left":"1428px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"9c1d9a1f-54e9-476c-b476-bd5e4e747a8a":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"0b987da5-7c41-4d24-a38b-c06a3603ad2f","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1159"}],"$conditionOutputs":[{"stateId":"000b38f3-fbab-47b7-a63b-3b6422119178","typeOfStateId":"state","$connId":"con_748","$id":"7bc380c1-7937-450d-8d84-2ed6337da096","conditions":[{"source":"context","comparison":"notEquals","values":["false"],"variable":"responseDataVerifyJs","$$hashKey":"object:1179"},{"values":["200"],"source":"context","comparison":"equals","variable":"statusGetAccountByName","$$hashKey":"object:1180"}],"$invalid":false,"$$hashKey":"object:1161"},{"stateId":"3576589e-820d-48f2-ac6a-8874940c42ed","typeOfStateId":"state","$connId":"con_753","$id":"9e19081d-f7fe-472c-ab79-4959124a7a6c","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:1206"}],"$invalid":false,"$$hashKey":"object:1162"}],"$enteringCustomActions":[{"$id":"f15d76a3-5a46-49bc-97b1-3611cb9481f8","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - query","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"SELECT id, name, CA_CPFCNPJ__c, CA_CodigoERP__c FROM ACCOUNT where Name= \"\n}","inputVariables":[],"outputVariable":"query","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"c35071dd-919e-4197-9455-05ad9bc7ee10","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - get account","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Authorization":"Bearer {{getAccessToken}}"},"method":"GET","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q={{query}}'{{clientName}}'","responseStatusVariable":"statusGetAccountByName","responseBodyVariable":"responseGetAccountByName"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[],"$$hashKey":"object:1376"}]},{"$id":"d86f656d-2261-4f59-8717-b0358a4855d9","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - responseDataVerifyJs","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize === 0) {\n            return false;\n        }\n        return true;\n    } catch (error) {\n        return false;\n    }\n}\n\n","inputVariables":["responseGetAccountByName"],"outputVariable":"responseDataVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"fe46554e-f8c4-48eb-9bb1-386fc27d25d0","$typeOfContent":"","type":"SetVariable","$title":"Set variable - getAccountByName","$invalid":false,"settings":{"value":"{{responseDataVerifyJs}}","variable":"getAccountByName"},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"9c1d9a1f-54e9-476c-b476-bd5e4e747a8a","root":false,"$title":"API - Get account by name","$position":{"top":"930px","left":"1232px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"8d99e7da-790c-4245-bfc8-46605bb39245":{"$contentActions":[{"action":{"$id":"2b977898-3a62-4a2c-b593-546d75b01765","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"c664c4ee-b679-4b9b-a479-9f70aa3346d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"c664c4ee-b679-4b9b-a479-9f70aa3346d7","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"47efb6a9-b5b3-4af2-b349-0df434ad250b","$typeOfContent":"raw-content","type":"SendRawMessage","settings":{"metadata":{},"type":"{{buildMenuJs@type}}","rawContent":"{{buildMenuJs@content}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false},{"input":{"bypass":false,"$cardContent":{"document":{"id":"0db20332-21bc-4e69-876e-e80ee4a64e78","type":"text/plain","textContent":"User input","content":"inputMenuDinamico"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false,"variable":"inputMenuDinamico","expiration":"01:00","conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},"$invalid":false}],"$conditionOutputs":[{"stateId":"610c7d39-e1fe-4a73-b639-9f6aef4310a2","typeOfStateId":"state","$connId":"con_758","$id":"395dc0d0-a73f-4600-bfdf-6257294a6786","conditions":[{"source":"input","comparison":"notEquals","values":["Outra"]}],"$invalid":false},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_763","$id":"0b761a91-3ad6-4fa0-91b5-5660f11ae715","conditions":[{"source":"input","comparison":"equals","values":["Outra"]}],"$invalid":false}],"$enteringCustomActions":[{"$id":"772c1714-b682-4859-bd52-f0e4d87a29a3","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - accountVerifyJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(data) {\n    try {\n        const parsedData = JSON.parse(data);\n        const records = parsedData.records;\n\n        if (!Array.isArray(records)) {\n            return \"Records is not an array\";\n        }\n\n        // const totalSize = parsedData.totalSize;\n\n        const accountNames = records.map(record => record.Name);\n        const accountCpfCnpj = records.map(record => record.CA_CPFCNPJ__c);\n        const totalSize = parsedData.totalSize;\n\n        return {\n            accountNames:accountNames,\n            accountCpfCnpj: accountCpfCnpj,\n            totalSize: totalSize\n        };\n    } catch (error) {\n        return error.message;\n    }\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - orderVerifyJs] \"+String(err);}}","inputVariables":["responseGetAccountByName"],"outputVariable":"accountVerifyJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT2-4859-bd52-f0e4d87a29a3","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{orderVerifyJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"orderVerifyJs"}],"$invalid":false},{"$id":"dd4ed878-10a5-45bd-9931-f26aea75b734","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - channelJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(contactSource, tunnelOriginator) {\n    const channels = {\n        \"messenger\": \"messenger\",\n        \"instagram\": \"instagram\",\n        \"telegram\": \"telegram\",\n        \"WhatsApp\": \"whatsapp\",\n        \"wa.gw\": \"whatsapp\",\n        \"whatsapp\": \"whatsapp\",\n        \"beagle.com.withub.ai\": \"whatsapp\"\n    }\n    \n    try {\n        const tunnelOriginatorJs = tunnelOriginator || ''\n        const channelJs = Object.keys(channels).find(channel => {\n            return contactSource == channel || tunnelOriginatorJs.indexOf(channel) !== -1\n        })\n\n        return channelJs ? channels[channelJs] : 'BlipChat'\n    } catch (e) {\n        return 'BlipChat'\n    }\n}\n\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - channelJs] \"+String(err);}}","inputVariables":["contact.source","tunnel.originator"],"outputVariable":"channelJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT5-45bd-9931-f26aea75b734","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{channelJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"channelJs"}],"$invalid":false},{"$id":"DWNT-USRSCPTe-485b-bf7e-d19cab16b499","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{getOrderIdAndNumberJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"getOrderIdAndNumberJs"}],"$invalid":false},{"$id":"3b69a34f-99ce-47d5-b563-de70ff86a826","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - addOthersInMenu","$invalid":false,"settings":{"function":"run","source":"\nfunction run(accountVerifyJs) {\n    const accountVerify = JSON.parse(accountVerifyJs)\n\n    if (!accountVerify.accountCpfCnpj.includes(\"outros\")) {\n        accountVerify.accountCpfCnpj.push(\"Outra\");\n        accountVerify.totalSize = accountVerify.accountCpfCnpj.length;\n    }\n    return accountVerify\n}","inputVariables":["accountVerifyJs"],"outputVariable":"accountVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"06080c79-f5b0-4d99-9c88-fad088584388","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildMenuJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(canal, accountVerifyJs) {\n    try {\n        if (!accountVerifyJs) {\n            throw new Error(\"Dados inválidos fornecidos\");\n        }\n\n        const parsedData = JSON.parse(accountVerifyJs);\n\n        if (!parsedData.accountCpfCnpj || !Array.isArray(parsedData.accountCpfCnpj)) {\n            throw new Error(\"Formato de dados inválido\");\n        }\n\n        const arrayOptions = parsedData;\n        const textHeader = \"\";\n        const textBody = `Encontramos mais de um estabelecimento atrelado ao seu nome. Sobre qual gostaria de falar?`;\n        const textFooter = ``;\n\n        if (canal === \"whatsapp\") {\n            return {\n                type: \"application/json\",\n                content: {\n                    \"recipient_type\": \"individual\",\n                    \"type\": \"interactive\",\n                    interactive: {\n                        \"type\": \"list\",\n                        header: {\n                            \"type\": \"text\",\n                            text: textHeader,\n                        },\n                        body: {\n                            text: textBody,\n                        },\n                        footer: {\n                            text: textFooter,\n                        },\n                        action: {\n                            \"button\": \"Clique aqui\",\n                            \"sections\": [\n                                {\n                                    \"title\": \"Contas\",\n                                    \"rows\": mountMenuWhatsApp(arrayOptions)\n                                }\n                            ]\n                        },\n                    },\n                }\n            };\n        }\n\n        if (canal === \"BlipChat\") {\n            return {\n                type: \"application/vnd.lime.select+json\",\n                content: {\n                    text: textBody,\n                    options: mountMenuBlipChat(arrayOptions),\n                },\n            };\n        }\n\n        return {\n            type: \"text/plain\",\n            content: mountMenuText(textBody, arrayOptions),\n        };\n    } catch (error) {\n        return error.message;\n    }\n}\n\nfunction mountMenuWhatsApp(arrayOptions) {\n    return arrayOptions.accountCpfCnpj.map((accountCpfCnpj, index) => ({\n        id: index + 1,\n        title: accountCpfCnpj .substring(0,24),\n        description: arrayOptions.accountNames[index]\n    }));\n}\n\nfunction mountMenuBlipChat(arrayOptions) {\n    return arrayOptions.map((accountCpfCnpj, index) => ({\n        id: `option-${index + 1}`,\n        text: accountCpfCnpj\n    }));\n}\n\nfunction mountMenuText(textBody, arrayOptions) {\n    const textOptions = arrayOptions.map((accountCpfCnpj, index) => `${index + 1} - ${accountCpfCnpj}`);\n    return `${textBody}\\n\\n${textOptions.join(\"\\n\")}`;\n}\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - buildMenuJs] \"+String(err);}}","inputVariables":["channelJs","accountVerifyJs"],"outputVariable":"buildMenuJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT0-4d99-9c88-fad088584388","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{buildMenuJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"buildMenuJs"}],"$invalid":false}],"$leavingCustomActions":[{"$id":"05dc4f8a-f665-4b1a-b318-bec88ff83eeb","$typeOfContent":"","type":"SetVariable","$title":"Set variable - inputSelectedOrder","$invalid":false,"settings":{"variable":"inputSelectedOrder","value":"{{input.message}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"7ac8e084-b5f5-4628-9293-f0d80dad36be","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getIdOfInputMessageJs","$invalid":false,"settings":{"function":"dwnt_run","source":"function run(inputData) {\n    const data = JSON.parse(inputData)\n    return data.metadata[\"#wa.interactive.list.id\"];\n }\nfunction dwnt_run(){try{return run.apply(null, arguments);}catch(err){return \"SCRIPT_ERROR [Execute script - getIdOfInputMessageJs] \"+String(err);}}","inputVariables":["inputSelectedOrder"],"outputVariable":"getIdOfInputMessageJs","LocalTimeZoneEnabled":false},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"DWNT-USRSCPT5-4628-9293-f0d80dad36be","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] 'errorType' SCRIPT_ERROR","settings":{"variable":"errorType","value":"{{getIdOfInputMessageJs}}"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]},{"values":["SCRIPT_ERROR"],"source":"context","comparison":"startsWith","variable":"getIdOfInputMessageJs"}],"$invalid":false},{"$id":"1900e121-87b7-4d28-a54c-3f5c8f3ae492","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - returnNameCliente","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    try {\n        const data = JSON.parse(input);\n\n        if (data.metadata && data.metadata['#replyContent']) {\n\n            const replyContent = data.metadata['#replyContent'];\n\n            const parsedReplyContent = JSON.parse(replyContent);\n\n            return parsedReplyContent;\n        } else {\n            return \"O campo #replyContent não foi encontrado.\";\n        }\n    } catch (error) {\n        return `Erro ao processar o JSON: ${error.message}`;\n    }\n}","inputVariables":["input.message"],"outputVariable":"returnNameCliente","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"401bc0b4-6f00-4798-a049-c3836a484525","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getNameCliente","$invalid":false,"settings":{"function":"run","source":"function run(response, searchTitle) {\n    try {\n        const data = JSON.parse(response);\n\n        const sections = data.inReplyTo.value.interactive.action.sections;\n\n        for (let i = 0; i < sections.length; i++) {\n            let section = sections[i];\n            for (let j = 0; j < section.rows.length; j++) {\n                let row = section.rows[j];\n                if (row.title === searchTitle) {\n                    return row.description || \"Descrição não disponível\"; \n                }\n            }\n        }\n        return \"Título não encontrado\";\n    } catch (error) {\n        return `Erro ao processar o JSON: ${error.message}`;\n    }\n}","inputVariables":["returnNameCliente","input.content"],"outputVariable":"getNameCliente","LocalTimeZoneEnabled":false},"conditions":[],"continueOnError":false}],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[{"background":"#fde74c","label":"Input","id":"DWNT60bd-871d-474b-b62a-18cdeac03f7d","canChangeBackground":false}],"id":"8d99e7da-790c-4245-bfc8-46605bb39245","root":false,"$title":"Menu - Selecionar conta por nome","$position":{"top":"1321px","left":"1645px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"000b38f3-fbab-47b7-a63b-3b6422119178":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"68b17212-8206-4383-9d8e-018928e21f56","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:7037"}],"$conditionOutputs":[{"stateId":"8d99e7da-790c-4245-bfc8-46605bb39245","typeOfStateId":"state","$connId":"con_768","$id":"22e41adb-4e97-4d14-8995-42c880072ab6","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"nameDataVerify","$$hashKey":"object:7059"},{"values":["true"],"source":"context","comparison":"equals","variable":"dataSizeVerify","$$hashKey":"object:7060"}],"$invalid":false,"$$hashKey":"object:7039"},{"stateId":"a2a65e61-eb8c-48f9-a7cc-bad98deef6d6","typeOfStateId":"state","$connId":"con_773","$id":"84dff6a1-5f3c-47b9-9a8b-3ef89876d6e8","conditions":[{"source":"context","comparison":"equals","values":["true"],"variable":"nameDataVerify","$$hashKey":"object:7088"},{"values":["false"],"source":"context","variable":"dataSizeVerify","comparison":"equals","$$hashKey":"object:7089"}],"$invalid":false,"$$hashKey":"object:7040"},{"stateId":"89d0d98f-ec83-4311-83e8-9213d89bb652","typeOfStateId":"state","$connId":"con_778","$id":"977151c0-cc99-4599-9864-f63f60d7c0ca","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:7115"}],"$invalid":false,"$$hashKey":"object:7041"}],"$enteringCustomActions":[{"$id":"62a290ca-985a-4b91-96f5-5752f2df9245","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - nameDataVerify","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.records && Array.isArray(data.records) && data.records.length > 0) {\n            return true;\n        } else {\n            return false; \n        }\n    } catch (error) {\n        return false;\n    }\n}","inputVariables":["responseGetAccountByName"],"outputVariable":"nameDataVerify","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"4727ac19-bbf3-4472-b60e-dff51f434481","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - dataSizeVerify","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize > 1) {\n            return true;\n        } else if (data.totalSize <= 1) {\n            return false;\n        }\n    } catch (error) {\n        return error.message;\n    }\n}","inputVariables":["responseGetAccountByName"],"outputVariable":"dataSizeVerify","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"000b38f3-fbab-47b7-a63b-3b6422119178","root":false,"$title":"Verificar conta vinculada name","$position":{"top":"951px","left":"1535px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"d91bc1b0-b46e-4152-a263-4f4cebda17f2":{"$contentActions":[{"action":{"$id":"6d9869a4-5f66-41a5-8b5f-679f583539d9","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"bd5c898f-e937-4941-b3d9-6adb10810948","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"bd5c898f-e937-4941-b3d9-6adb10810948","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"action":{"$id":"96a7b2a5-fcff-40a0-84cf-90b76cc9eed7","$typeOfContent":"text","type":"SendMessage","settings":{"id":"594f171d-d61c-4107-a44a-35dc518fa754","type":"text/plain","content":"Obrigado por nos contatar! 😊 Se precisar de mais ajuda, não hesite em nos procurar novamente.","metadata":{}},"$cardContent":{"document":{"id":"594f171d-d61c-4107-a44a-35dc518fa754","type":"text/plain","content":"Obrigado por nos contatar! 😊 Se precisar de mais ajuda, não hesite em nos procurar novamente."},"editable":true,"deletable":true,"position":"left"}},"$invalid":false},{"input":{"bypass":true,"$cardContent":{"document":{"id":"83ebdb04-c116-4fdc-8f89-c59f65ed1a2e","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false}],"$conditionOutputs":[{"stateId":"onboarding","typeOfStateId":"state","$connId":"con_783","$id":"d5a636c8-18d0-4fde-a911-c452df6a793d","conditions":[{"source":"input","comparison":"exists","values":[]}],"$invalid":false}],"$enteringCustomActions":[],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"d91bc1b0-b46e-4152-a263-4f4cebda17f2","root":false,"$title":"Mensagem encerramento 2","$position":{"top":"1631px","left":"4541px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"544d6bf4-2d0a-4e77-a1e5-f22612045cc8":{"$contentActions":[{"action":{"$id":"fe2ae835-88e3-42e0-b90b-c6674b90c541","$typeOfContent":"chat-state","type":"SendMessage","settings":{"id":"3c06cf46-118f-40b1-8b75-c277e634dfa4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"$cardContent":{"document":{"id":"3c06cf46-118f-40b1-8b75-c277e634dfa4","type":"application/vnd.lime.chatstate+json","content":{"state":"composing","interval":1000}},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:5964"},{"action":{"$id":"c75593c8-ae52-4ad8-b8a8-f77d71731e74","$typeOfContent":"text","type":"SendMessage","settings":{"id":"a0c6f4bb-d6f5-42de-9287-c42d692347f4","type":"text/plain","content":"{{titles}}","metadata":{}},"$cardContent":{"document":{"id":"a0c6f4bb-d6f5-42de-9287-c42d692347f4","type":"text/plain","content":"{{titles}}"},"editable":true,"deletable":true,"position":"left"}},"$invalid":false,"$$hashKey":"object:5965"},{"input":{"bypass":true,"$cardContent":{"document":{"id":"e14cb4b9-f05a-4685-8fdd-8ddfc6acf083","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:5966"}],"$conditionOutputs":[{"stateId":"80275161-3ef5-4cad-bd90-409f48e679c7","typeOfStateId":"state","$connId":"con_788","$id":"9a4bc8b1-b990-4069-8f3e-f8e9c5f99364","conditions":[{"source":"context","comparison":"equals","values":["Comprar Produtos"],"variable":"inputMenuAjuda","$$hashKey":"object:5990"}],"$invalid":false,"$$hashKey":"object:5972"},{"stateId":"onboarding","typeOfStateId":"state","$connId":"con_793","$id":"eb7c051e-968a-4709-9aa7-54abb7efea4c","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:6006"}],"$invalid":false,"$$hashKey":"object:5973"}],"$enteringCustomActions":[{"$id":"9a91b86b-e3d8-43a0-8e00-0e2b45e104b8","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getClientCode","$invalid":false,"settings":{"function":"run","source":"function run(input) {\n    const data = JSON.parse(input)\n    try {\n        if (data && data.metadata && data.metadata[\"#wa.interactive.list.id\"]) {\n            return data.metadata[\"#wa.interactive.list.id\"];\n        } else {\n            return \"A chave '#wa.interactive.list.id' não foi encontrada.\";\n        }\n    } catch (error) {\n        \"Erro ao acessar o valor:\", error.message;\n        return null;\n    }\n}","inputVariables":["inputSelectedOrder"],"outputVariable":"getClientCode","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"ab658c88-4fd1-4628-a052-e1d439d8fc58","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - query","$invalid":false,"settings":{"function":"run","source":"function run() {\n\treturn \"SELECT ca_nome_do_cliente__c, CA_Data_de_Emissao__c, CA_Vencimento_Real__c, CA_Saldo__c FROM CA_Titulo__c where CA_Codigo_Cliente__c=\"\n}","inputVariables":[],"outputVariable":"query","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"44143259-4864-44dd-9b2b-721aca0cbe97","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - get titles","$invalid":false,"settings":{"headers":{"Content-Type":"application/x-www-form-urlencoded","Authorization":"Bearer {{getAccessToken}}"},"method":"GET","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/query/?q={{query}}'{{getClientCode}}'","responseStatusVariable":"statusGetTitlesByName","responseBodyVariable":"responseGetTitlesByName"},"conditions":[{"comparison":"notExists","source":"context","variable":"errorType","values":[]}]},{"$id":"b966613e-fade-4f56-87bf-960bd0734051","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - responseDataVerifyJs","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const data = JSON.parse(response);\n\n        if (data.totalSize === 0) {\n            return false;\n        }\n        return true;\n    } catch (error) {\n        return false;\n    }\n}\n\n","inputVariables":["responseGetAccountByName"],"outputVariable":"responseDataVerifyJs","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"baf946b8-4a1a-49e8-a2a8-4183ff64c96a","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - processTitles","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const titles = JSON.parse(response)\n        // Verifica se o parâmetro tem a propriedade 'records' que é um array\n        if (!titles || !Array.isArray(titles.records)) {\n           console.log(\"Estrutura de 'titles':\", JSON.stringify(titles, null, 2));  // Log para verificar a estrutura\n           return \"O parâmetro 'titles' deve conter uma propriedade 'records' que seja um array.\";\n        }\n\n        const titulosComSaldo = titles.records\n        .filter(titulo => titulo.CA_Saldo__c > 0)  // Filtra títulos com saldo maior que 0\n        .map(titulo => `Título:\\nVencimento: ${titulo.CA_Vencimento_real__c}\\nValor: R$ ${titulo.CA_Saldo__c}`)  // Formata cada item como uma string\n        .join('\\n\\n');\n\n        return titulosComSaldo;\n    } catch (error) {\n        console.error(\"Erro ao filtrar títulos:\", error.message);  // Corrigido para exibir o erro corretamente\n        return [];  // Retorna um array vazio em caso de erro\n    }\n}","inputVariables":["responseGetTitlesByName"],"outputVariable":"titles","LocalTimeZoneEnabled":false},"conditions":[]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"544d6bf4-2d0a-4e77-a1e5-f22612045cc8","root":false,"$title":"2ª via de boleto","$position":{"top":"903px","left":"4628px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false},"80275161-3ef5-4cad-bd90-409f48e679c7":{"$contentActions":[{"input":{"bypass":true,"$cardContent":{"document":{"id":"ca946575-2df4-4eb1-ae6b-52a93bd49818","type":"text/plain","textContent":"User input","content":"User Input"},"editable":false,"deletable":true,"position":"right","editing":false},"$invalid":false},"$invalid":false,"$$hashKey":"object:1614"}],"$conditionOutputs":[{"stateId":"3535615c-cafd-48a3-b810-8e30e9693aab","typeOfStateId":"state","$connId":"con_798","$id":"b6d49add-17d2-40b7-aee1-f394435395a7","conditions":[{"source":"input","comparison":"exists","values":[],"$$hashKey":"object:1630"}],"$invalid":false,"$$hashKey":"object:1616"}],"$enteringCustomActions":[{"$id":"25e4fde7-6476-42c3-bb5e-415be62c78f5","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getCurrentDate","$invalid":false,"settings":{"function":"run","source":"function run(date) {\n\tconst dataAtual = date\n\treturn dataAtual\n}","inputVariables":["calendar.date"],"outputVariable":"getCurrentDate","LocalTimeZoneEnabled":false},"conditions":[]},{"$id":"f5963f98-1242-4c9e-b050-f703d6b0fe43","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getNameAndIdByPhoneNumber","$invalid":false,"settings":{"function":"run","source":"function run(response, cpfCnpj) {\n\n    try {\n        const jsonData = JSON.parse(response);\n        if (!jsonData || !jsonData.records || jsonData.records.length === 0) {\n           return \"Error\";\n        }\n\n        const record = jsonData.records.find(record => record.CA_CPFCNPJ__c === cpfCnpj);\n\n        if (record) {\n            return { Id: record.Id, Name: record.Name };\n        } else {\n            return `Nenhum registro encontrado para o CPF/CNPJ ${cpfCnpj}`;\n        }\n\n    } catch (error) {\n        return \"Error: \" ;\n    }\n}","inputVariables":["responseGetAccountByPhone","inputContentCpf"],"outputVariable":"getNameAndIdByPhoneNumber","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:2754","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByPhone"}],"continueOnError":true},{"$id":"0544d568-20ed-49b0-8503-b62cce78755b","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildingBodyForHttp","$invalid":false,"settings":{"function":"run","source":"function run(nameAndId, getCurrentDate) {\r\n    try{\r\n     const name = JSON.parse(nameAndId).Name;\r\n     const id = JSON.parse(nameAndId).Id\r\n     return {\r\n        \"Name\": name,\r\n        \"stageName\": \"negociação\",\r\n        \"CloseDate\": getCurrentDate,\r\n        \"accountId\": id,\r\n        \"recordType\": {\r\n            \"name\": \"Acordo Comercial\"\r\n        }\r\n    }\r\n    }catch(e){\r\n        return error.message\r\n    }\r\n}","inputVariables":["getNameAndIdByPhoneNumber","getCurrentDate"],"outputVariable":"buildingBodyForHttp","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:5344","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByPhone"}]},{"$id":"714adca7-d284-4cb9-9069-50ef3cc4c508","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - criar opt. acordo comercial by phone","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"Bearer {{getAccessToken}}"},"method":"POST","body":"{{buildingBodyForHttp}}","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/sobjects/Opportunity","responseStatusVariable":"statusCreateOportunityTradeAgreement","responseBodyVariable":"responseCreateOportunityTradeAgreement"},"conditions":[{"values":["Error"],"source":"context","comparison":"notEquals","variable":"getNameAndIdByPhoneNumber","$$hashKey":"object:1946"}]},{"$id":"097c63db-428b-4b4c-8518-f8e3893cd3e6","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getNameAndIdByName","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const jsonData = JSON.parse(response);\n        // Verifica se o JSON possui registros válidos\n        if (!jsonData || !jsonData.records || jsonData.records.length === 0) {\n            return \"JSON inválido ou sem registros.\";\n        }\n\n        // Usa o primeiro registro, ignorando qualquer verificação de CPF/CNPJ\n        const record = jsonData.records[0];\n\n        if (record) {\n            // Retorna o ID e o Nome do primeiro registro encontrado\n            return { Id: record.Id, Name: record.Name };\n        } else {\n            return \"Nenhum registro encontrado.\";\n        }\n\n    } catch (error) {\n        return \"Erro ao processar os dados:\", error.message;\n    }\n}","inputVariables":["responseGetAccountByName","inputContentCpf"],"outputVariable":"getNameAndIdByName","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:8183","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByName"}]},{"$id":"2dac2dc0-0bf0-4da6-9cfb-5a5693c6b8a1","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildingBodyForHttp","$invalid":false,"settings":{"function":"run","source":"function run(nameAndId, getCurrentDate) {\r\n    try{\r\n     const name = JSON.parse(nameAndId).Name;\r\n     const id = JSON.parse(nameAndId).Id\r\n     return {\r\n        \"Name\": name,\r\n        \"stageName\": \"negociação\",\r\n        \"CloseDate\": getCurrentDate,\r\n        \"accountId\": id,\r\n        \"recordType\": {\r\n            \"name\": \"Acordo Comercial\"\r\n        }\r\n    }\r\n    }catch(e){\r\n        return error.message\r\n    }\r\n}","inputVariables":["getNameAndIdByName","getCurrentDate"],"outputVariable":"buildingBodyForHttp","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:8786","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByName"}]},{"$id":"c8879381-5cc9-4919-af73-2e17f12e0d48","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - criar opt. acordo comercial by name","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"Bearer {{getAccessToken}}"},"method":"POST","body":"{{buildingBodyForHttp}}","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/sobjects/Opportunity","responseStatusVariable":"statusCreateOportunityTradeAgreement","responseBodyVariable":"responseCreateOportunityTradeAgreement"},"conditions":[{"values":["Error"],"source":"context","comparison":"notEquals","variable":"getNameAndIdByName","$$hashKey":"object:2008"}]},{"$id":"de2e549c-4ce0-403d-85f9-a1493a0cd231","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - getNameAndIdByCpfCnpj","$invalid":false,"settings":{"function":"run","source":"function run(response) {\n    try {\n        const jsonData = JSON.parse(response);\n        // Verifica se o JSON possui registros válidos\n        if (!jsonData || !jsonData.records || jsonData.records.length === 0) {\n            return \"JSON inválido ou sem registros.\";\n        }\n\n        // Usa o primeiro registro, ignorando qualquer verificação de CPF/CNPJ\n        const record = jsonData.records[0];\n\n        if (record) {\n            // Retorna o ID e o Nome do primeiro registro encontrado\n            return { Id: record.Id, Name: record.Name };\n        } else {\n            return \"Nenhum registro encontrado.\";\n        }\n\n    } catch (error) {\n        return \"Erro ao processar os dados:\", error.message;\n    }\n}","inputVariables":["responseGetAccountByCpfCnpj"],"outputVariable":"getNameAndIdByCpfCnpj","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:10799","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByCpfCnpj"}]},{"$id":"decb15cc-33ec-4067-97ad-6ce5a586d468","$typeOfContent":"","type":"ExecuteScript","$title":"Execute script - buildingBodyForHttp","$invalid":false,"settings":{"function":"run","source":"function run(nameAndId, getCurrentDate) {\r\n    try{\r\n     const name = JSON.parse(nameAndId).Name;\r\n     const id = JSON.parse(nameAndId).Id\r\n     return {\r\n        \"Name\": name,\r\n        \"stageName\": \"negociação\",\r\n        \"CloseDate\": getCurrentDate,\r\n        \"accountId\": id,\r\n        \"recordType\": {\r\n            \"name\": \"Acordo Comercial\"\r\n        }\r\n    }\r\n    }catch(e){\r\n        return error.message\r\n    }\r\n}","inputVariables":["getNameAndIdByCpfCnpj","getCurrentDate"],"outputVariable":"buildingBodyForHttp","LocalTimeZoneEnabled":false},"conditions":[{"$$hashKey":"object:11371","values":["true"],"source":"context","comparison":"equals","variable":"getAccountByCpfCnpj"}]},{"$id":"6e51d984-1908-4b3c-9fc7-4d9f02b5d52e","$typeOfContent":"","type":"ProcessHttp","$title":"Process HTTP - criar opt. acordo comercial by cpf/cnpj","$invalid":false,"settings":{"headers":{"Content-Type":"application/json","Authorization":"Bearer {{getAccessToken}}"},"method":"POST","body":"{{buildingBodyForHttp}}","uri":"https://astoriamaquinas.my.salesforce.com/services/data/v59.0/sobjects/Opportunity","responseStatusVariable":"statusCreateOportunityTradeAgreement","responseBodyVariable":"responseCreateOportunityTradeAgreement"},"conditions":[{"values":["Error"],"source":"context","comparison":"notEquals","variable":"getNameAndIdByCpfCnpj","$$hashKey":"object:2070"}]}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"onboarding","$invalid":false,"typeOfStateId":"state"},"isAiGenerated":false,"$tags":[],"id":"80275161-3ef5-4cad-bd90-409f48e679c7","root":false,"$title":"Criar oportunidade de acordo comercial","$position":{"top":"884px","left":"4961.25px"},"$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}},"globalActions":{"$contentActions":[],"$conditionOutputs":[],"$enteringCustomActions":[{"$id":"DWNT769c-4843-41e3-91f8-a61a2bb19edf","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] Salva voltar","settings":{"variable":"errorType","value":"GO_BACK"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":["^([vV]+[oO]+[lL]+[tT]+[aA]+[rR]*)$"],"source":"input","comparison":"matches"},{"values":[],"source":"context","comparison":"exists","variable":"DWNT@hasCheckpoints"},{"values":[],"source":"context","comparison":"notExists","variable":"DWNT@disableCheckpoints"}],"$invalid":false},{"$id":"DWNT0f84-3722-47eb-8250-3845d1af6d86","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] Salva inatividade","settings":{"variable":"errorType","value":"INACTIVITY"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":[],"variable":"errorType","source":"context","comparison":"notExists"},{"values":[],"source":"input","comparison":"notExists"},{"values":[],"source":"context","variable":"DWNT@disableInactivity","comparison":"notExists"}],"$invalid":false},{"$id":"DWNTd4e8-c9fd-4b5c-b907-7c85bcb05e15","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] Salva sair","settings":{"variable":"errorType","value":"CLOSE"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":[],"variable":"errorType","source":"context","comparison":"notExists"},{"values":["^([sS]+[aA]+[iI]+[rR]*|[fF]+[eE]+[cC]+[hH]+[aA]+[rR]*?)$"],"source":"input","comparison":"matches"},{"values":[],"source":"context","variable":"DWNT@disableClose","comparison":"notExists"}],"$invalid":false},{"$id":"DWNTafd7-ecc8-4b3f-9fba-54cddaf9bf30","$typeOfContent":"","type":"ExecuteScript","$title":"[DWNT] Atualiza SDK (global)","settings":{"function":"run","source":"function run(DWNT, application_identifier, input_content, input_type, intents, random_guid) {\n    try {\n        DWNT = JSON.parse(DWNT|| \"{}\");\n        \n        const now = new Date();\n        DWNT.datetime = datetime__to_string(now, -3);\n        DWNT.date = String(DWNT.datetime).split(\" \")[0];\n        DWNT.time = String(DWNT.datetime).split(\" \")[1];\n\n        DWNT.states = {\n            \"fallback\": \"fallback\"\n        };\n\n        if (DWNT.journey == undefined) DWNT.journey = random_guid;\n\n        DWNT.mainService = \"Main\";\n        DWNT.application = {\n            \"bot\": application_identifier, \n            \"service\": \"Main\"\n        };\n        DWNT.application[\"isMain\"] = DWNT.mainService == DWNT.application[\"service\"];\n\n        DWNT.input = {};\n        DWNT.input.content = input_content;\n        DWNT.input.type = input_type;\n        DWNT.input.group = input__group(input_type, input_content);\n        DWNT.input.intent = input__intent(input_content, intents);\n        DWNT.input.event = input__event(DWNT.input.intent, intents);\n\n        DWNT.hasCheckpoints = Array.from(DWNT.checkpoints || []).length > 0 || undefined;\n        DWNT.disableCheckpoints = undefined;\n        DWNT.disableInactivity = undefined;\n        DWNT.disableClose = undefined;\n\n        DWNT.fromError = false;\n        \n    } catch(err) {\n        DWNT = { err: String(err) };\n    }\n    return JSON.stringify(DWNT);\n}\n\nfunction datetime__to_string(date, tzOffset){\n    tzOffset = tzOffset || -3;\n    const dateTz = new Date(new Date(date).getTime() + tzOffset * 60 * 60 * 1000) ;\n    return dateTz.toISOString().replace(\"T\", \" \").split(\".\")[0];\n}\n\nfunction input__event(intent, intents) {\n    if (!intents || typeof intent !== 'string') return null;\n    return intent ? intent : \"Inesperado\";\n}\n\nfunction input__intent(inputContent, intents) {\n    if (!intents) return null;\n    try {\n        intents = JSON.parse(intents);\n    } catch(err) {\n        return \"FAILED_TO_PARSE_INTENTS\";\n    }\n    if (Array.isArray(intents)) {\n        return input__intent_array(inputContent, intents);\n    } {\n        return input__intent_obj(inputContent, intents);\n    }\n}\n\nfunction input__intent_obj(inputContent, intents) {\n    try {\n        for (let intent in intents) {\n            if (intents.hasOwnProperty(intent)) {\n                let matches = intents[intent];\n                if (!Array.isArray(matches)) {\n                    matches = [matches];\n                }\n                const matched = matches.some(regexp => new RegExp(\"^\" + regexp + \"$\", \"i\").test(inputContent));\n                if (matched) return intent;\n            }\n        }\n    } catch(err) {\n        return \"FAILED_TO_PROCESS_OBJ_INTENT: \" + String(err);\n    }\n    return null;\n}\n\nfunction input__intent_array(inputContent, intents) {\n    try{\n        for (let i = 0; i < intents.length; i ++) {\n            let matches = intents[i]['matches'];\n            let intent = intents[i]['intent'];\n            if (!Array.isArray(matches)) {\n                matches = [matches];\n            }\n            const matched = matches.some(regexp => new RegExp(\"^\" + regexp + \"$\", \"i\").test(inputContent));\n            if (matched) return intent;\n        }\n    } catch(err) {\n        return \"FAILED_TO_PROCESS_ARRAY_INTENT: \" + String(err);\n    }\n    return null;\n}\n\nfunction input__group(inputType, inputContent) {\n    let _type = String(inputType || \"\");\n    if (_type == \"text/plain\") {\n        return \"text\";\n    }\n    try {\n        const content = JSON.parse(inputContent);\n        _type = String(content.type || \"\");\n    } catch(err) {\n        _type = \"\";\n    }\n    if (_type.includes(\"image\") || _type.includes(\"sticker\")) {\n        return \"image\";\n    }\n    if (_type.includes(\"video\")) {\n        return \"video\";\n    }\n    if (_type.includes(\"audio\")) {\n        return \"audio\";\n    }\n    if (_type.includes(\"pdf\")) {\n        return \"document\";\n    }\n    if (_type.includes(\"location\")) {\n        return \"location\";\n    }\n    return null;\n}\n","inputVariables":["DWNT","application.identifier","input.content","input.type","intents","random.guid"],"outputVariable":"DWNT"},"conditions":[],"$invalid":false},{"$id":"DWNT26e9-d35d-44d2-835a-bd767c857683","$typeOfContent":"","type":"ProcessCommand","$title":"[DWNT] Deleta Intents se existe","settings":{"to":"postmaster@msging.net","method":"delete","uri":"/contexts/{{contact.identity}}/intents","variable":"deleteIntentsCmdResp"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":[],"source":"context","comparison":"exists","variable":"intents"}],"$invalid":false},{"$id":"DWNTa0db-d908-451b-a45d-e5dcaa589484","$typeOfContent":"","type":"TrackEvent","$title":"[DWNT] Registra Intents","settings":{"extras":{},"action":"{{DWNT@input.event}}","category":"[DWNT-INTENTS] {{state.name}}"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":["null"],"source":"context","comparison":"notEquals","variable":"DWNT@input.event"}],"$invalid":false},{"$id":"DWNT44f3-bae5-4bcd-9c4c-544c32ea10b8","$typeOfContent":"","type":"TrackEvent","$title":"[DWNT] Registra Unexpected","settings":{"extras":{},"category":"[DWNT-UNEXPECTED] {{state.name}}","action":"{{input.content}}"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":["Inesperado"],"source":"context","comparison":"equals","variable":"DWNT@input.event"}],"$invalid":false},{"$id":"c0777610-7374-459c-98c2-c1830b2278fb","$typeOfContent":"","type":"SetVariable","$title":"[DWNT] reseta fromError","settings":{"variable":"fromError","value":"false"},"conditions":[{"values":["^(?!desk).*$"],"source":"context","comparison":"matches","variable":"state.id"},{"values":["false"],"comparison":"notEquals","source":"context","variable":"fromError"}],"$invalid":false}],"$leavingCustomActions":[],"$inputSuggestions":[],"$defaultOutput":{"stateId":"fallback","$invalid":false},"isAiGenerated":false,"$tags":[],"id":"global-actions","$invalidContentActions":false,"$invalidOutputs":false,"$invalidCustomActions":false,"$invalid":false}}